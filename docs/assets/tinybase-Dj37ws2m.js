var Yu=Object.defineProperty;var qu=(s,t,e)=>t in s?Yu(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var Fr=(s,t,e)=>qu(s,typeof t!="symbol"?t+"":t,e);import{R as dr,j as L}from"./react-D4UEBxRr.js";const go=s=>typeof s,Ku="tinybase",Se="",Xu=go(Se),Zu=go(go),Ou="Listener",wc="Result",Iu="get",s1="set",t1="add",e1="Has",n1="has",mt="Ids",Sr="Table",o1=Sr+mt,Ec="Row",ja=Ec+"Count",xa=Ec+mt,Pa="Sorted"+Ec+mt,Vc="Cell",Da=Vc+mt,bc="Value",c1=bc+"s",i1=bc+mt,ma="Metric",r1="Index",Na="Slice",a1="Relationship",l1="Remote"+Ec+"Id",u1="Query",Di=globalThis,en=s=>s==null,tc=(s,t,e)=>en(s)?e==null?void 0:e():t(s),va=s=>go(s)==Xu,Aa=s=>go(s)==Zu,d1=s=>Array.isArray(s),ec=s=>s.length,S1=()=>{},$1=(s,t)=>$r(new Array(s).fill(0),(e,o)=>t(o)),pa=(s,t)=>s.every(t),mi=(s,t)=>ec(s)===ec(t)&&pa(s,(e,o)=>t[o]===e),$r=(s,t)=>s.map(t),f1=(s,t)=>s.filter(t),kr=(s,t,e)=>s.with(t,e),jc=Object,zr=s=>jc.getPrototypeOf(s),T1=jc.entries,Gi=s=>!en(s)&&tc(zr(s),t=>t==jc.prototype||en(zr(t)),()=>!0),Ma=jc.keys,_a=(s,t)=>tc(s,e=>e[t]),C1=(s,t)=>t in s,L1=(s,t)=>(delete s[t],s),h1=s=>ec(Ma(s)),Fa=(s,t)=>{const e=T1(s);return ec(e)===h1(t)&&pa(e,([o,c])=>Gi(c)?Gi(t[o])?Fa(t[o],c):!1:t[o]===c)},{PureComponent:PT,createContext:R1,useCallback:wo,useContext:fr,useEffect:Ur,useLayoutEffect:DT,useMemo:ka,useRef:y1,useState:Ji,useSyncExternalStore:g1}=dr;var Gs=(s=>(s[s.Store=0]="Store",s[s.Metrics=1]="Metrics",s[s.Indexes=2]="Indexes",s[s.Relationships=3]="Relationships",s[s.Queries=4]="Queries",s[s.Checkpoints=5]="Checkpoints",s[s.Persister=6]="Persister",s[s.Synchronizer=7]="Synchronizer",s))(Gs||{});const Ni=Ku+"_uirc",nc=Di[Ni]?Di[Ni]:Di[Ni]=R1([]),dn=(s,t)=>{const e=fr(nc);return en(s)?e[t*2]:va(s)?_a(e[t*2+1],s):s},Do=(s,t)=>{const e=dn(s,t);return en(s)||va(s)?e:s},mo=s=>Ma(fr(nc)[s*2+1]??{}),Ot=[],Hr=[{},[],[Ot,void 0,Ot],void 0,!1,0],w1=[Fa,mi,([s,t,e],[o,c,a])=>t===c&&mi(s,o)&&mi(e,a)],E1=(s,t)=>s===t,V1=(s,t,...e)=>{var c;const o=(c=s==null?void 0:s[t1+t+Ou])==null?void 0:c.call(s,...e);return()=>{var a;return(a=s==null?void 0:s.delListener)==null?void 0:a.call(s,o)}},As=(s,t,e,o=Ot)=>{const c=y1(Hr[e]),a=wo(()=>{var C;const f=((C=t==null?void 0:t[(e==4?n1:Iu)+s])==null?void 0:C.call(t,...o))??Hr[e];return(w1[e]??E1)(f,c.current)?c.current:c.current=f},[t,e,s,...o]),u=wo(f=>V1(t,(e==4?e1:Se)+s,...o,f),[t,e,s,...o]);return g1(u,a,a)},za=(s,t,e,o=Ot,c=S1,a=Ot,...u)=>{const f=at(s);return wo(C=>tc(f,S=>tc(e(C,S),T=>c(S[s1+t](...b1(u,S,C),T),T))),[f,t,...o,...a,...j1(u)])},b1=(s,t,e)=>$r(s,o=>Aa(o)?o(e,t):o),j1=s=>f1(s,t=>!Aa(t)),x1=(s,t,e,o,c,a)=>As(Pa,at(a),1,[s,t,e,o,c]),P1=(s,t=Ot)=>ka(s,t),D1=()=>mo(Gs.Store),Ua=s=>dn(s,Gs.Store),at=s=>Do(s,Gs.Store),m1=s=>As(o1,at(s),1),Tr=(s,t)=>As(Sr+Da,at(t),1,[s]),N1=(s,t)=>As(ja,at(t),5,[s]),v1=(s,t)=>As(xa,at(t),1,[s]),A1=(s,t,e,o,c,a)=>x1(...Gi(s)?[s.tableId,s.cellId,s.descending??!1,s.offset??0,s.limit,t]:[s,t,e,o,c,a]),Sn=(s,t,e,o)=>As(Vc,at(o),3,[s,t,e]),p1=s=>As(c1,at(s),0),Ha=s=>As(i1,at(s),1),We=(s,t)=>As(bc,at(t),3,[s]),xc=(s,t,e,o,c,a,u,f)=>za(a,Vc,o,c,u,f,s,t,e),oc=(s,t,e,o,c,a)=>za(o,bc,t,e,c,a,s),M1=()=>mo(Gs.Metrics),Wa=s=>dn(s,Gs.Metrics),Qa=s=>Do(s,Gs.Metrics),_1=s=>As(ma+mt,Qa(s),1),F1=(s,t)=>As(ma,Qa(t),3,[s]),k1=()=>mo(Gs.Indexes),Ba=s=>dn(s,Gs.Indexes),Pc=s=>Do(s,Gs.Indexes),z1=(s,t)=>As(Na+mt,Pc(t),1,[s]),U1=s=>As(r1+mt,Pc(s),1),H1=(s,t,e)=>As(Na+xa,Pc(e),1,[s,t]),W1=()=>mo(Gs.Relationships),Ga=s=>dn(s,Gs.Relationships),Cr=s=>Do(s,Gs.Relationships),Q1=s=>As(a1+mt,Cr(s),1),B1=(s,t,e)=>As(l1,Cr(e),3,[s,t]),G1=()=>mo(Gs.Queries),Ja=s=>dn(s,Gs.Queries),No=s=>Do(s,Gs.Queries),J1=s=>As(u1+mt,No(s),1),Y1=(s,t)=>As(wc+Sr+Da,No(t),1,[s]),q1=(s,t)=>As(wc+ja,No(t),5,[s]),K1=(s,t,e,o=0,c,a)=>As(wc+Pa,No(a),1,[s,t,e,o,c]),X1=(s,t,e,o)=>As(wc+Vc,No(o),3,[s,t,e]),Z1=(s,t,e=Ot,o,c=Ot,a,u=Ot)=>{const[,f]=Ji(),[C,S]=Ji();return Ur(()=>{(async()=>{const T=s?await t(s):void 0;S(T),T&&o&&(async()=>(await o(T),f([])))()})()},[s,...e,...c]),Ur(()=>()=>{C&&C.destroy()},[C,...u]),C},ne=(s,t,e,o,c)=>[e??t[s*2],{...t[s*2+1],...o,...c[s]}],mT=({store:s,storesById:t,metrics:e,metricsById:o,indexes:c,indexesById:a,relationships:u,relationshipsById:f,queries:C,queriesById:S,checkpoints:T,checkpointsById:h,persister:y,persistersById:w,synchronizer:E,synchronizersById:V,children:m})=>{const P=fr(nc),[b,ls]=Ji(()=>$1(8,()=>({}))),Rs=wo((O,j,M)=>ls(K=>_a(K[O],j)==M?K:kr(K,O,{...K[O],[j]:M})),[]),Ss=wo((O,j)=>ls(M=>C1(M[O],j)?kr(M,O,L1(M[O],j)):M),[]);return L.jsx(nc.Provider,{value:ka(()=>[...ne(0,P,s,t,b),...ne(1,P,e,o,b),...ne(2,P,c,a,b),...ne(3,P,u,f,b),...ne(4,P,C,S,b),...ne(5,P,T,h,b),...ne(6,P,y,w,b),...ne(7,P,E,V,b),Rs,Ss],[b,s,t,e,o,c,a,u,f,C,S,T,h,y,w,E,V,P,Rs,Ss]),children:m})},Lr=(s,t,e,o)=>{const c=en(t)||!d1(s)?s:$r(s,(a,u)=>u>0?[t,a]:a);return e?[o,":{",c,"}"]:c},hr=({tableId:s,rowId:t,cellId:e,store:o,debugIds:c})=>Lr(Se+(Sn(s,t,e,o)??Se),void 0,c,e),O1=({valueId:s,store:t,debugIds:e})=>Lr(Se+(We(s,t)??Se),void 0,e,s),I1=({queryId:s,rowId:t,cellId:e,queries:o,debugIds:c})=>Lr(Se+(X1(s,t,e,o)??Se),void 0,c,e),$e=s=>typeof s,se="",Ya=".",Dc=$e(se),qa=$e(!0),mc=$e(0),s0=$e($e),ko="type",ct="default",t0="Listener",e0="add",Ae="Has",Nc="Ids",Ue="Table",Wr=Ue+"s",n0=Ue+Nc,cc="Row",o0=cc+"Count",c0=cc+Nc,ho="Cell",Qr=ho+Nc,nn="Value",Yi=nn+"s",i0=nn+Nc,tn="currentTarget",Br="value",Ka="￼",Ls=s=>se+s,r0=(s,t=se,e)=>s.split(t,e),a0=globalThis,Gr=a0.window,Xa=Math,l0=Xa.min,Jr=Xa.floor,u0=isFinite,d0=(s,t)=>s instanceof t,ts=s=>s==null,_s=(s,t,e)=>ts(s)?e==null?void 0:e():t(s),Za=s=>s==Dc||s==qa,S0=s=>$e(s)==Dc,vi=s=>$e(s)==s0,Eo=s=>Array.isArray(s),Yr=(s,t,e)=>s.slice(t,e),xt=s=>s.length,$0=(s,t)=>s.test(t),Oa=s=>{throw new Error(s)},Zt=async(s,t,e)=>{try{return await s()}catch(o){t==null||t(o)}},f0=(s,t)=>s.includes(t),T0=(s,t)=>s.every(t),C0=(s,t)=>xt(s)===xt(t)&&T0(s,(e,o)=>t[o]===e),Ia=(s,t)=>s.sort(t),Vo=(s,t)=>s.forEach(t),L0=(s,t=se)=>s.join(t),vs=(s,t)=>s.map(t),Et=s=>xt(s)==0,h0=(s,t,e)=>s.reduce(t,e),R0=(s,t)=>s.splice(0,t),bo=(s,...t)=>s.push(...t),sl=s=>s.shift(),Le=Object,qr=s=>Le.getPrototypeOf(s),tl=Le.entries,y0=Le.isFrozen,ic=s=>!ts(s)&&_s(qr(s),t=>t==Le.prototype||ts(qr(t)),()=>!0),g0=Le.keys,el=Le.freeze,Ro=(s=[])=>Le.fromEntries(s),$o=(s,t)=>t in s,nl=(s,t)=>(delete s[t],s),w0=(s,t)=>Vo(tl(s),([e,o])=>t(o,e)),on=(s,t)=>vs(tl(s),([e,o])=>t(o,e)),Kt=(s,t)=>Ro(on(s,(e,o)=>[o,t(e,o)])),E0=s=>xt(g0(s)),Os=s=>ic(s)&&E0(s)==0,oe=(s,t,e,o=0)=>ts(s)||!ic(s)||!o&&Os(s)||y0(s)?(e==null||e(),!1):(w0(s,(c,a)=>{t(c,a)||nl(s,a)}),o?!0:!Os(s)),ol=JSON.stringify,He=JSON.parse,Xt=s=>ol(s,(t,e)=>d0(e,Map)?Le.fromEntries([...e]):e),V0=s=>ol(s,(t,e)=>e===void 0?Ka:e),b0=s=>He(s,(t,e)=>e===Ka?void 0:e),Rr=s=>t=>h0(j0(t),(e,o)=>e+s(o),0),yr=s=>(s==null?void 0:s.size)??0,gr=Rr(yr),fo=Rr(gr),Ai=Rr(fo),Ks=(s,t)=>(s==null?void 0:s.has(t))??!1,X=s=>ts(s)||yr(s)==0,j0=s=>[...(s==null?void 0:s.values())??[]],pi=s=>s.clear(),as=(s,t)=>s==null?void 0:s.forEach(t),rc=(s,t)=>s==null?void 0:s.delete(t),Z=s=>new Map(s),io=s=>[...(s==null?void 0:s.keys())??[]],v=(s,t)=>s==null?void 0:s.get(t),re=(s,t)=>as(s,(e,o)=>t(o,e)),x0=(s,t)=>vs([...(s==null?void 0:s.entries())??[]],([e,o])=>t(o,e)),$s=(s,t,e)=>ts(e)?(rc(s,t),s):s==null?void 0:s.set(t,e),Ms=(s,t,e,o)=>(Ks(s,t)?o==null||o(v(s,t)):$s(s,t,e()),v(s,t)),pe=(s,t,e,o=$s)=>(Kt(t,(c,a)=>e(s,a,c)),re(s,c=>$o(t,c)?0:o(s,c)),s),Xs=(s,t,e,o)=>{const c={};return as(s,(a,u)=>{if(!(e!=null&&e(a,u))){const f=t?t(a,u):a;o!=null&&o(f)||(c[u]=f)}}),c},qi=(s,t,e)=>Xs(s,o=>Xs(o,t,e),X,Os),zo=(s,t,e)=>Xs(s,o=>qi(o,t,e),X,Os),le=(s,t)=>{const e=Z();return as(s,(o,c)=>e.set(c,(t==null?void 0:t(o))??o)),e},Ki=s=>le(s,le),Mi=s=>le(s,Ki),Xi=(s,t,e,o,c=0)=>_s((e?Ms:v)(s,t[c],c>xt(t)-2?e:Z),a=>{if(c>xt(t)-2)return o!=null&&o(a)&&$s(s,t[c]),a;const u=Xi(a,t,e,o,c+1);return X(a)&&$s(s,t[c]),u}),P0=/^\d+$/,cl=()=>{const s=[];let t=0;return[e=>(e?sl(s):null)??se+t++,e=>{$0(P0,e)&&xt(s)<1e3&&bo(s,e)}]},To=s=>new Set(Eo(s)||ts(s)?s:[s]),Co=(s,t)=>s==null?void 0:s.add(t),D0=(s,t=[se])=>{const e=[],o=(c,a)=>a==xt(t)?bo(e,c):t[a]===null?as(c,u=>o(u,a+1)):Vo([t[a],null],u=>o(v(c,u),a+1));return o(s,0),e},il=s=>{let t;const[e,o]=cl(),c=Z();return[(S,T,h,y=[],w=()=>[])=>{t??(t=s());const E=e(1);return $s(c,E,[S,T,h,y,w]),Co(Xi(T,h??[se],To),E),E},(S,T,...h)=>Vo(D0(S,T),y=>as(y,w=>v(c,w)[0](t,...T??[],...h))),S=>_s(v(c,S),([,T,h])=>(Xi(T,h??[se],void 0,y=>(rc(y,S),X(y)?1:0)),$s(c,S),o(S),h)),S=>_s(v(c,S),([T,,h=[],y,w])=>{const E=(...V)=>{var P;const m=xt(V);m==xt(h)?T(t,...V,...w(V)):ts(h[m])?Vo(((P=y[m])==null?void 0:P.call(y,...V))??[],b=>E(...V,b)):E(...V,h[m])};E()})]},Uo=Z(),Ho=Z(),m0=(s=1,t,e)=>s!=1&&t.isMergeable()?[1,t.getMergeableContent,()=>t.getTransactionMergeableChanges(!e),([[o],[c]])=>!Os(o)||!Os(c),t.setDefaultContent]:s!=2?[0,t.getContent,t.getTransactionChanges,([o,c])=>!Os(o)||!Os(c),t.setContent]:Oa("Store type not supported by this Persister"),N0=(s,t,e,o,c,a,u,f={},C=0,S=[])=>{let T=0,h=0,y=0,w,E,V;Ms(Uo,S,()=>0),Ms(Ho,S,()=>[]);const m=Z(),[P,b,ls,Rs,Ss]=m0(u,s,C),[O,j,M]=il(()=>k),K=R=>{R!=T&&(T=R,j(m,void 0,T))},_=async()=>{if(!v(Uo,S)){for($s(Uo,S,1);!ts(w=sl(v(Ho,S)));)await Zt(w,a);$s(Uo,S,0)}},I=R=>{(P&&Eo(R==null?void 0:R[0])?(R==null?void 0:R[2])===1?s.applyMergeableChanges:s.setMergeableContent:(R==null?void 0:R[2])===1?s.applyChanges:s.setContent)(R)},us=async R=>(T!=2&&(K(1),h++,await Ts(async()=>{await Zt(async()=>{const p=await t();Eo(p)?I(p):R?Ss(R):Oa(`Content is not an array: ${p}`)},()=>{R&&Ss(R)}),K(0)})),k),ns=async R=>(N(),await us(R),await Zt(async()=>E=await o(async(p,Y)=>{Y||p?T!=2&&(K(1),h++,I(Y??p),K(0)):await us()}),a),k),N=async()=>(E&&(await Zt(()=>c(E),a),E=void 0),k),ss=()=>!ts(E),os=async R=>(T!=1&&(K(2),y++,await Ts(async()=>{await Zt(()=>e(b,R),a),K(0)})),k),cs=async()=>(es(),await os(),V=s.addDidFinishTransactionListener(()=>{const R=ls();Rs(R)&&os(R)}),k),es=async()=>(V&&(s.delListener(V),V=void 0),k),bs=()=>!ts(V),Es=async(R,p=!1)=>{const[Y,ys]=p?[cs,ns]:[ns,cs];return await Y(R),await ys(R),k},J=async(R=!1)=>{const[p,Y]=R?[es,N]:[N,es];return await p(),await Y(),k},fs=()=>T,hs=R=>O(R,m),Ns=R=>(M(R),s),Ts=async(...R)=>(bo(v(Ho,S),...R),await _(),k),k={load:us,startAutoLoad:ns,stopAutoLoad:N,isAutoLoading:ss,save:os,startAutoSave:cs,stopAutoSave:es,isAutoSaving:bs,startAutoPersisting:Es,stopAutoPersisting:J,getStatus:fs,addStatusListener:hs,delListener:Ns,schedule:Ts,getStore:()=>s,destroy:()=>(R0(v(Ho,S)),J()),getStats:()=>({loads:h,saves:y}),...f};return el(k)},Kr="storage",v0=(s,t,e,o)=>N0(s,async()=>b0(e.getItem(t)),async C=>e.setItem(t,V0(C())),C=>{const S=T=>{T.storageArea===e&&T.key===t&&Zt(()=>C(He(T.newValue)),C)};return Gr.addEventListener(Kr,S),S},C=>Gr.removeEventListener(Kr,C),o,3,{getStorageName:()=>t}),A0=(s,t,e)=>v0(s,t,sessionStorage,e),Ze=s=>{const t=$e(s);return Za(t)||t==mc&&u0(s)?t:void 0},Xr=(s,t,e,o,c)=>ts(c)?s.delCell(t,e,o,!0):s.setCell(t,e,o,c),Zr=(s,t,e)=>ts(e)?s.delValue(t):s.setValue(t,e),_i=(s,t,e,o)=>s==Dc?t:s==mc?e:o,p0=(s,t)=>(s??0)<(t??0)?-1:1,Wo=s=>[s,s],js=(s,t=gr)=>t(s[0])+t(s[1]),xs=()=>[Z(),Z()],Or=s=>[...s],Qo=([s,t])=>s===t,ro=(s,t,e)=>$s(s,t,v(s,t)==-e?void 0:e),rl=()=>{let s,t,e=!1,o=!1,c=0,a=[];const u=Z(),f=Z(),C=Z(),S=Z(),T=Z(),h=Z(),y=Z(),w=Z(),E=Z(),V=Z(),m=Z(),P=Z(),b=Z(),ls=Z(),Rs=To(),Ss=Z(),O=Z(),j=Z(),M=Z(),K=xs(),_=xs(),I=xs(),us=xs(),ns=xs(),N=xs(),ss=xs(),os=xs(),cs=xs(),es=xs(),bs=xs(),Es=xs(),J=xs(),fs=xs(),hs=xs(),Ns=xs(),Ts=xs(),Qs=xs(),Fs=xs(),Us=xs(),k=xs(),R=xs(),p=Z(),Y=xs(),[ys,H,ee,Bs]=il(()=>rs),Ke=n=>oe(n,i=>oe(i,Tn)),Xc=n=>oe(n,Tn),Tn=n=>{if(!oe(n,(r,l)=>f0([ko,ct],l)))return!1;const i=n[ko];return!Za(i)&&i!=mc?!1:(Ze(n[ct])!=i&&nl(n,ct),!0)},Zc=Eo,Oc=n=>oe(n,Cn,Hs),Cn=(n,i)=>(!s||Ks(m,i)||Hs(i))&&oe(n,(r,l)=>At(i,l,r),()=>Hs(i)),At=(n,i,r,l)=>oe(l?r:yn(r,n,i),(d,$)=>_s(Ln(n,i,$,d),g=>(r[$]=g,!0),()=>!1),()=>Hs(n,i)),Ln=(n,i,r,l)=>s?_s(v(v(m,n),r),d=>Ze(l)!=d[ko]?Hs(n,i,r,l,d[ct]):l,()=>Hs(n,i,r,l)):ts(Ze(l))?Hs(n,i,r,l):l,hn=(n,i)=>oe(i?n:Ic(n),(r,l)=>_s(Rn(l,r),d=>(n[l]=d,!0),()=>!1),()=>ut()),Rn=(n,i)=>t?_s(v(b,n),r=>Ze(i)!=r[ko]?ut(n,i,r[ct]):i,()=>ut(n,i)):ts(Ze(i))?ut(n,i):i,yn=(n,i,r)=>(_s(v(P,i),([l,d])=>{as(l,($,g)=>{$o(n,g)||(n[g]=$)}),as(d,$=>{$o(n,$)||Hs(i,r,$)})}),n),Ic=n=>(t&&(as(ls,(i,r)=>{$o(n,r)||(n[r]=i)}),as(Rs,i=>{$o(n,i)||ut(i)})),n),gn=n=>pe(m,n,(i,r,l)=>{const d=Z(),$=To();pe(Ms(m,r,Z),l,(g,D,A)=>{$s(g,D,A),_s(A[ct],Cs=>$s(d,D,Cs),()=>Co($,D))}),$s(P,r,[d,$])},(i,r)=>{$s(m,r),$s(P,r)}),wn=n=>pe(b,n,(i,r,l)=>{$s(b,r,l),_s(l[ct],d=>$s(ls,r,d),()=>Co(Rs,r))},(i,r)=>{$s(b,r),$s(ls,r),rc(Rs,r)}),En=n=>Os(n)?Gt():Qt(n),si=([n,i])=>{(Os(n)?Gt:Qt)(n),(Os(i)?Jt:Bt)(i)},Vn=n=>pe(j,n,(i,r,l)=>pt(r,l),(i,r)=>Pn(r)),pt=(n,i)=>pe(Ms(j,n,()=>(vn(n,1),$s(Ss,n,cl()),$s(O,n,Z()),Z())),i,(r,l,d)=>lt(n,r,l,d),(r,l)=>Dn(n,r,l)),lt=(n,i,r,l,d)=>pe(Ms(i,r,()=>(An(n,r,1),Z())),l,($,g,D)=>je(n,r,$,g,D),($,g)=>mn(n,i,r,$,g,d)),je=(n,i,r,l,d)=>{Ks(r,l)||pn(n,i,l,1);const $=v(r,l);d!==$&&(Mn(n,i,l,$,d),$s(r,l,d))},bn=(n,i,r,l,d)=>_s(v(i,r),$=>je(n,r,$,l,d),()=>lt(n,i,r,yn({[l]:d},n,r))),jn=n=>Os(n)?Jt():Bt(n),xn=n=>pe(M,n,(i,r,l)=>Mt(r,l),(i,r)=>Nn(r)),Mt=(n,i)=>{Ks(M,n)||_n(n,1);const r=v(M,n);i!==r&&(Fn(n,r,i),$s(M,n,i))},ti=(n,i)=>{const[r]=v(Ss,n);let l;do l=r(i);while(Ks(v(j,n),l));return l},_t=n=>v(j,n)??pt(n,{}),Pn=n=>pt(n,{}),Dn=(n,i,r)=>{const[,l]=v(Ss,n);l(r),lt(n,i,r,{},!0)},mn=(n,i,r,l,d,$)=>{var A;const g=v((A=v(P,n))==null?void 0:A[0],d);if(!ts(g)&&!$)return je(n,r,l,d,g);const D=Cs=>{Mn(n,r,Cs,v(l,Cs)),pn(n,r,Cs,-1),$s(l,Cs)};ts(g)?D(d):re(l,D),X(l)&&(An(n,r,-1),X($s(i,r))&&(vn(n,-1),$s(j,n),$s(Ss,n),$s(O,n)))},Nn=n=>{const i=v(ls,n);if(!ts(i))return Mt(n,i);Fn(n,v(M,n)),_n(n,-1),$s(M,n)},vn=(n,i)=>ro(u,n,i),An=(n,i,r)=>ro(Ms(S,n,Z),i,r)&&$s(C,n,Ms(C,n,()=>0)+r),pn=(n,i,r,l)=>{const d=v(O,n),$=v(d,r)??0;($==0&&l==1||$==1&&l==-1)&&ro(Ms(f,n,Z),r,l),$s(d,r,$!=-l?$+l:null),ro(Ms(Ms(T,n,Z),i,Z),r,l)},Mn=(n,i,r,l,d)=>{var $;Ms(Ms(Ms(h,n,Z),i,Z),r,()=>[l,0])[1]=d,($=a[3])==null||$.call(a,n,i,r,d)},_n=(n,i)=>ro(y,n,i),Fn=(n,i,r)=>{var l;Ms(w,n,()=>[i,0])[1]=r,(l=a[4])==null||l.call(a,n,r)},Hs=(n,i,r,l,d)=>(bo(Ms(Ms(Ms(E,n,Z),i,Z),r,()=>[]),l),d),ut=(n,i,r)=>(bo(Ms(V,n,()=>[]),i),r),Ft=(n,i,r)=>_s(v(v(v(h,n),i),r),([l,d])=>[!0,l,d],()=>[!1,...Wo(zt(n,i,r))]),kn=n=>_s(v(w,n),([i,r])=>[!0,i,r],()=>[!1,...Wo(Ut(n))]),zn=n=>!X(E)&&!X(Ns[n])?as(n?Mi(E):E,(i,r)=>as(i,(l,d)=>as(l,($,g)=>H(Ns[n],[r,d,g],$)))):0,Un=n=>!X(V)&&!X(Ts[n])?as(n?le(V):V,(i,r)=>H(Ts[n],[r],i)):0,dt=(n,i,r,l)=>{if(!X(n))return H(i,l,()=>Xs(n)),re(n,(d,$)=>H(r,[...l??[],d],$==1)),1},Hn=n=>{const i=Ht();i!=e&&H(K[n],void 0,i);const r=X(es[n]),l=X(J[n])&&X(fs[n])&&X(cs[n])&&X(bs[n])&&X(N[n])&&X(ss[n])&&X(os[n])&&r&&X(I[n])&&X(us[n]),d=X(hs[n])&&X(Es[n])&&X(ns[n])&&X(_[n]);if(!l||!d){const $=n?[le(u),Ki(f),le(C),Ki(S),Mi(T),Mi(h)]:[u,f,C,S,T,h];if(!l){dt($[0],I[n],us[n]),as($[1],(D,A)=>dt(D,N[n],ss[n],[A])),as($[2],(D,A)=>{D!=0&&H(os[n],[A],Gn(A))});const g=To();as($[3],(D,A)=>{dt(D,cs[n],bs[n],[A])&&!r&&(H(es[n],[A,null]),Co(g,A))}),r||as($[5],(D,A)=>{if(!Ks(g,A)){const Cs=To();as(D,Ws=>as(Ws,([Yt,qt],St)=>qt!==Yt?Co(Cs,St):rc(Ws,St))),as(Cs,Ws=>H(es[n],[A,Ws]))}}),as($[4],(D,A)=>as(D,(Cs,Ws)=>dt(Cs,J[n],fs[n],[A,Ws])))}if(!d){let g;as($[5],(D,A)=>{let Cs;as(D,(Ws,Yt)=>{let qt;as(Ws,([St,co],Pi)=>{co!==St&&(H(hs[n],[A,Yt,Pi],co,St,Ft),g=Cs=qt=1)}),qt&&H(Es[n],[A,Yt],Ft)}),Cs&&H(ns[n],[A],Ft)}),g&&H(_[n],void 0,Ft)}}},Wn=n=>{const i=Wt();i!=o&&H(Qs[n],void 0,i);const r=X(Us[n])&&X(k[n]),l=X(R[n])&&X(Fs[n]);if(!r||!l){const d=n?[le(y),le(w)]:[y,w];if(r||dt(d[0],Us[n],k[n]),!l){let $;as(d[1],([g,D],A)=>{D!==g&&(H(R[n],[A],D,g,kn),$=1)}),$&&H(Fs[n],void 0,kn)}}},z=(n,...i)=>(ve(()=>n(...vs(i,Ls))),rs),Qn=(n,i,r,l,d)=>{let $=kt(n,i,...r);return ys(()=>{const g=kt(n,i,...r);C0(g,$)||($=g,l(rs,n,i,...r,$))},es[d?1:0],[n,i],[gs])},ei=()=>[xe(),De()],xe=()=>zo(j),gs=()=>io(j),ni=n=>qi(v(j,Ls(n))),Bn=n=>io(v(O,Ls(n))),Gn=n=>yr(v(j,Ls(n))),Is=n=>io(v(j,Ls(n))),kt=(n,i,r,l=0,d)=>ic(n)?kt(n.tableId,n.cellId,n.descending,n.offset,n.limit):vs(Yr(Ia(x0(v(j,Ls(n)),($,g)=>[ts(i)?g:v($,Ls(i)),g]),([$],[g])=>p0($,g)*(r?-1:1)),l,ts(d)?d:l+d),([,$])=>$),oi=(n,i)=>Xs(v(v(j,Ls(n)),Ls(i))),Pe=(n,i)=>io(v(v(j,Ls(n)),Ls(i))),zt=(n,i,r)=>v(v(v(j,Ls(n)),Ls(i)),Ls(r)),De=()=>Xs(M),me=()=>io(M),Ut=n=>v(M,Ls(n)),Ht=()=>!X(j),Jn=n=>Ks(j,Ls(n)),Yn=(n,i)=>Ks(v(O,Ls(n)),Ls(i)),qn=(n,i)=>Ks(v(j,Ls(n)),Ls(i)),Kn=(n,i,r)=>Ks(v(v(j,Ls(n)),Ls(i)),Ls(r)),Wt=()=>!X(M),Xn=n=>Ks(M,Ls(n)),ci=()=>Xt(j),ii=()=>Xt(M),ri=()=>Xt([j,M]),ai=()=>Xt(m),li=()=>Xt(b),ui=()=>Xt([m,b]),di=n=>z(()=>{const i=vi(n)?n():n;Zc(i)&&si(i)}),Qt=n=>z(()=>Oc(n)?Vn(n):0),Si=(n,i)=>z(r=>Cn(i,r)?pt(r,i):0,n),$i=(n,i,r)=>z((l,d)=>At(l,d,r)?lt(l,_t(l),d,r):0,n,i),fi=(n,i,r=!0)=>ve(()=>{let l;return At(n,l,i)&&(n=Ls(n),lt(n,_t(n),l=ti(n,r?1:0),i)),l}),Ti=(n,i,r)=>z((l,d)=>{if(At(l,d,r,1)){const $=_t(l);Kt(r,(g,D)=>bn(l,$,d,D,g))}},n,i),Ci=(n,i,r,l)=>z((d,$,g)=>_s(Ln(d,$,g,vi(l)?l(zt(d,$,g)):l),D=>bn(d,_t(d),$,g,D)),n,i,r),Bt=n=>z(()=>hn(n)?xn(n):0),Li=n=>z(()=>hn(n,1)?Kt(n,(i,r)=>Mt(r,i)):0),hi=(n,i)=>z(r=>_s(Rn(r,vi(i)?i(Ut(r)):i),l=>Mt(r,l)),n),Ri=n=>z(()=>{Kt(n[0],(i,r)=>ts(i)?so(r):Kt(i,(l,d)=>ts(l)?to(r,d):Kt(l,($,g)=>Xr(rs,r,d,g,$)))),Kt(n[1],(i,r)=>Zr(rs,r,i))}),Zn=n=>(Zt(()=>En(He(n))),rs),yi=n=>(Zt(()=>jn(He(n))),rs),gi=n=>z(()=>Zt(()=>{const[i,r]=He(n);En(i),jn(r)},()=>Zn(n))),On=n=>z(()=>{if((s=Ke(n))&&(gn(n),!X(j))){const i=xe();Gt(),Qt(i)}}),In=n=>z(()=>{if(t=Xc(n)){const i=De();Ne(),Jt(),t=!0,wn(n),Bt(i)}}),wi=(n,i)=>z(()=>{On(n),In(i)}),Gt=()=>z(()=>Vn({})),so=n=>z(i=>Ks(j,i)?Pn(i):0,n),to=(n,i)=>z((r,l)=>_s(v(j,r),d=>Ks(d,l)?Dn(r,d,l):0),n,i),Ei=(n,i,r,l)=>z((d,$,g)=>_s(v(j,d),D=>_s(v(D,$),A=>Ks(A,g)?mn(d,D,$,A,g,l):0)),n,i,r),Jt=()=>z(()=>xn({})),Vi=n=>z(i=>Ks(M,i)?Nn(i):0,n),eo=()=>z(()=>{gn({}),s=!1}),Ne=()=>z(()=>{wn({}),t=!1}),bi=()=>z(()=>{eo(),Ne()}),ve=(n,i)=>{if(c!=-1){no();const r=n();return oo(i),r}},no=()=>{var n;return c!=-1&&c++,c==1&&((n=a[0])==null||n.call(a),H(p)),rs},ji=()=>[Xs(h,(n,i)=>v(u,i)===-1?void 0:Xs(n,(r,l)=>v(v(S,i),l)===-1?void 0:Xs(r,([,d])=>d,d=>Qo(d)),X,Os),X,Os),Xs(w,([,n])=>n,n=>Qo(n)),1],xi=()=>[!X(h),!X(w),zo(h,Or,Qo),zo(E),Xs(w,Or,Qo),Xs(V),Xs(u),qi(S),zo(T),Xs(y)],oo=n=>{var i,r;return c>0&&(c--,c==0&&(c=1,zn(1),X(h)||Hn(1),Un(1),X(w)||Wn(1),n!=null&&n(rs)&&(as(h,(l,d)=>as(l,($,g)=>as($,([D],A)=>Xr(rs,d,g,A,D)))),pi(h),as(w,([l],d)=>Zr(rs,d,l)),pi(w)),H(Y[0],void 0),c=-1,zn(0),X(h)||Hn(0),Un(0),X(w)||Wn(0),(i=a[1])==null||i.call(a),H(Y[1],void 0),(r=a[2])==null||r.call(a),c=0,e=Ht(),o=Wt(),Vo([u,f,C,S,T,h,E,y,w,V],pi))),rs},rs={getContent:ei,getTables:xe,getTableIds:gs,getTable:ni,getTableCellIds:Bn,getRowCount:Gn,getRowIds:Is,getSortedRowIds:kt,getRow:oi,getCellIds:Pe,getCell:zt,getValues:De,getValueIds:me,getValue:Ut,hasTables:Ht,hasTable:Jn,hasTableCell:Yn,hasRow:qn,hasCell:Kn,hasValues:Wt,hasValue:Xn,getTablesJson:ci,getValuesJson:ii,getJson:ri,getTablesSchemaJson:ai,getValuesSchemaJson:li,getSchemaJson:ui,hasTablesSchema:()=>s,hasValuesSchema:()=>t,setContent:di,setTables:Qt,setTable:Si,setRow:$i,addRow:fi,setPartialRow:Ti,setCell:Ci,setValues:Bt,setPartialValues:Li,setValue:hi,applyChanges:Ri,setTablesJson:Zn,setValuesJson:yi,setJson:gi,setTablesSchema:On,setValuesSchema:In,setSchema:wi,delTables:Gt,delTable:so,delRow:to,delCell:Ei,delValues:Jt,delValue:Vi,delTablesSchema:eo,delValuesSchema:Ne,delSchema:bi,transaction:ve,startTransaction:no,getTransactionChanges:ji,getTransactionLog:xi,finishTransaction:oo,forEachTable:n=>as(j,(i,r)=>n(r,l=>as(i,(d,$)=>l($,g=>re(d,g))))),forEachTableCell:(n,i)=>re(v(O,Ls(n)),i),forEachRow:(n,i)=>as(v(j,Ls(n)),(r,l)=>i(l,d=>re(r,d))),forEachCell:(n,i,r)=>re(v(v(j,Ls(n)),Ls(i)),r),forEachValue:n=>re(M,n),addSortedRowIdsListener:(n,i,r,l,d,$,g)=>ic(n)?Qn(n.tableId,n.cellId,[n.descending??!1,n.offset??0,n.limit],i,r):Qn(n,i,[r,l,d],$,g),addStartTransactionListener:n=>ys(n,p),addWillFinishTransactionListener:n=>ys(n,Y[0]),addDidFinishTransactionListener:n=>ys(n,Y[1]),callListener:n=>(Bs(n),rs),delListener:n=>(ee(n),rs),getListenerStats:()=>({hasTables:js(K),tables:js(_),tableIds:js(I),hasTable:js(us),table:js(ns),tableCellIds:js(N),hasTableCell:js(ss,fo),rowCount:js(os),rowIds:js(cs),sortedRowIds:js(es),hasRow:js(bs,fo),row:js(Es,fo),cellIds:js(J,fo),hasCell:js(fs,Ai),cell:js(hs,Ai),invalidCell:js(Ns,Ai),hasValues:js(Qs),values:js(Fs),valueIds:js(Us),hasValue:js(k),value:js(R),invalidValue:js(Ts),transaction:gr(p)+js(Y)}),isMergeable:()=>!1,createStore:rl,addListener:ys,callListeners:H,setInternalListeners:(n,i,r,l,d)=>a=[n,i,r,l,d]};return Kt({[Ae+Wr]:[0,K,[],()=>[Ht()]],[Wr]:[0,_],[n0]:[0,I],[Ae+Ue]:[1,us,[gs],n=>[Jn(...n)]],[Ue]:[1,ns,[gs]],[Ue+Qr]:[1,N,[gs]],[Ae+Ue+ho]:[2,ss,[gs,Bn],n=>[Yn(...n)]],[o0]:[1,os,[gs]],[c0]:[1,cs,[gs]],[Ae+cc]:[2,bs,[gs,Is],n=>[qn(...n)]],[cc]:[2,Es,[gs,Is]],[Qr]:[2,J,[gs,Is]],[Ae+ho]:[3,fs,[gs,Is,Pe],n=>[Kn(...n)]],[ho]:[3,hs,[gs,Is,Pe],n=>Wo(zt(...n))],InvalidCell:[3,Ns],[Ae+Yi]:[0,Qs,[],()=>[Wt()]],[Yi]:[0,Fs],[i0]:[0,Us],[Ae+nn]:[1,k,[me],n=>[Xn(...n)]],[nn]:[1,R,[me],n=>Wo(Ut(n[0]))],InvalidValue:[1,Ts]},([n,i,r,l],d)=>{rs[e0+d+t0]=(...$)=>ys($[n],i[$[n+1]?1:0],n>0?Yr($,0,n):void 0,r,l)}),el(rs)},{PureComponent:M0,createContext:NT,useCallback:Vt,useContext:vT,useEffect:AT,useLayoutEffect:_0,useMemo:vo,useRef:Ir,useState:ke,useSyncExternalStore:pT}=dr,wr=(s,...t)=>ts(s)?{}:s(...t),F0=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getLocalTableId(t),s==null?void 0:s.getRemoteTableId(t)],k0=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getTableId(t)],ac="tinybaseInspector",Zi="TinyBase Inspector",al=["left","top","bottom","right","full"],fe="state",lc="sort",Oi="open",uc="position",dc=Oi,sa="editable",Lt=(...s)=>Xt(s),vc=(s,t)=>vs(Ia([...s]),t),Ac=(s,t)=>[!!Sn(fe,s,sa,t),Vt(e=>{t.setCell(fe,s,sa,o=>!o),e.preventDefault()},[t,s])],z0=({s})=>{const t=We(uc,s)??1,e=oc(dc,()=>!0,[],s);return We(dc,s)?null:L.jsx("img",{onClick:e,title:Zi,"data-position":t})},ll="editable",U0="←",H0="↑",W0="→",Q0="↓",ta=(s,t)=>vs(Tr(s,t),e=>s+Ya+e),Sc=(s,t,e)=>{const o=Vt(s,t);return e?o:void 0},pc=(...s)=>vo(()=>s,s),ul=(s,t)=>vo(()=>({store:s,tableId:t}),[s,t]),B0=(s,t)=>vo(()=>({queries:s,queryId:t}),[s,t]),dl=(s,t=!1,e,o=0,c,a,u,f)=>{const[[C,S,T],h]=ke([s,t,o]),y=Vt(m=>{h(m),f==null||f(m)},[f]),w=Sc(m=>y([m,m==C?!S:!1,T]),[y,C,S,T],e),E=Vt(m=>y([C,S,m]),[y,C,S]),V=u===!0?O0:u;return[[C,S,T],w,vo(()=>u===!1?null:L.jsx(V,{offset:T,limit:c,total:a,onChange:E}),[u,V,T,c,a,E])]},Mc=(s,t,e)=>vo(()=>{const o=t??s;return Kt(Eo(o)?Ro(vs(o,c=>[c,c])):o,(c,a)=>({label:a,component:e,...S0(c)?{label:c}:c}))},[t,e,s]),Er=({className:s,headerRow:t,idColumn:e,params:[o,c,a,u,f,C]})=>L.jsxs("table",{className:s,children:[C?L.jsx("caption",{children:C}):null,t===!1?null:L.jsx("thead",{children:L.jsxs("tr",{children:[e===!1?null:L.jsx(ea,{sort:u??[],label:"Id",onClick:f}),on(o,({label:S},T)=>L.jsx(ea,{cellId:T,label:S,sort:u??[],onClick:f},T))]})}),L.jsx("tbody",{children:vs(a,S=>L.jsxs("tr",{children:[e===!1?null:L.jsx("th",{children:S}),on(o,({component:T,getComponentProps:h},y)=>L.jsx("td",{children:L.jsx(T,{...wr(h,S,y),...c,rowId:S,cellId:y})},y))]},S))})]}),ea=({cellId:s,sort:[t,e],label:o=s??se,onClick:c})=>L.jsxs("th",{onClick:Sc(()=>c==null?void 0:c(s),[c,s],c),className:ts(e)||t!=s?void 0:`sorted ${e?"de":"a"}scending`,children:[ts(e)||t!=s?null:(e?Q0:H0)+" ",o]}),G0=({localRowId:s,params:[t,e,o,c,a,u,f]})=>{const C=B1(a,s,u);return L.jsxs("tr",{children:[t===!1?null:L.jsxs(L.Fragment,{children:[L.jsx("th",{children:s}),L.jsx("th",{children:C})]}),on(e,({component:S,getComponentProps:T},h)=>{const[y,w]=r0(h,Ya,2),E=y===o?s:y===c?C:null;return ts(E)?null:L.jsx("td",{children:L.jsx(S,{...wr(T,E,w),store:f,tableId:y,rowId:E,cellId:w})},h)})]})},Sl=({thing:s,onThingChange:t,className:e,hasSchema:o,showType:c=!0})=>{const[a,u]=ke(),[f,C]=ke(),[S,T]=ke(),[h,y]=ke(),[w,E]=ke();f!==s&&(u(Ze(s)),C(s),T(String(s)),y(Number(s)||0),E(!!s));const V=Vt((P,b)=>{b(P),C(P),t(P)},[t]),m=Vt(()=>{if(!(o!=null&&o())){const P=_i(a,mc,qa,Dc),b=_i(P,S,h,w);u(P),C(b),t(b)}},[o,t,S,h,w,a]);return L.jsxs("div",{className:e,children:[c?L.jsx("button",{className:a,onClick:m,children:a}):null,_i(a,L.jsx("input",{value:S,onChange:Vt(P=>V(String(P[tn][Br]),T),[V])},a),L.jsx("input",{type:"number",value:h,onChange:Vt(P=>V(Number(P[tn][Br]||0),y),[V])},a),L.jsx("input",{type:"checkbox",checked:w,onChange:Vt(P=>V(!!P[tn].checked,E),[V])},a))]})},J0=({tableId:s,cellId:t,descending:e,offset:o,limit:c,store:a,editable:u,sortOnClick:f,paginator:C=!1,onChange:S,customCells:T,...h})=>{const[y,w,E]=dl(t,e,f,o,c,N1(s,a),C,S);return L.jsx(Er,{...h,params:pc(Mc(Tr(s,a),T,u?Vr:hr),ul(a,s),A1(s,...y,c,a),y,w,E)})},Y0=({store:s,editable:t=!1,valueComponent:e=t?Z0:O1,getValueComponentProps:o,className:c,headerRow:a,idColumn:u})=>L.jsxs("table",{className:c,children:[a===!1?null:L.jsx("thead",{children:L.jsxs("tr",{children:[u===!1?null:L.jsx("th",{children:"Id"}),L.jsx("th",{children:nn})]})}),L.jsx("tbody",{children:vs(Ha(s),f=>L.jsxs("tr",{children:[u===!1?null:L.jsx("th",{children:f}),L.jsx("td",{children:L.jsx(e,{...wr(o,f),valueId:f,store:s})})]},f))})]}),q0=({indexId:s,sliceId:t,indexes:e,editable:o,customCells:c,...a})=>{const[u,f,C]=k0(Pc(e),s);return L.jsx(Er,{...a,params:pc(Mc(Tr(C,f),c,o?Vr:hr),ul(f,C),H1(s,t,u))})},K0=({relationshipId:s,relationships:t,editable:e,customCells:o,className:c,headerRow:a,idColumn:u=!0})=>{const[f,C,S,T]=F0(Cr(t),s),h=Mc([...ta(S,C),...ta(T,C)],o,e?Vr:hr),y=pc(u,h,S,T,s,f,C);return L.jsxs("table",{className:c,children:[a===!1?null:L.jsx("thead",{children:L.jsxs("tr",{children:[u===!1?null:L.jsxs(L.Fragment,{children:[L.jsxs("th",{children:[S,".Id"]}),L.jsxs("th",{children:[T,".Id"]})]}),on(h,({label:w},E)=>L.jsx("th",{children:w},E))]})}),L.jsx("tbody",{children:vs(v1(S,C),w=>L.jsx(G0,{localRowId:w,params:y},w))})]})},X0=({queryId:s,cellId:t,descending:e,offset:o,limit:c,queries:a,sortOnClick:u,paginator:f=!1,customCells:C,onChange:S,...T})=>{const[h,y,w]=dl(t,e,u,o,c,q1(s,a),f,S);return L.jsx(Er,{...T,params:pc(Mc(Y1(s,a),C,I1),B0(a,s),K1(s,...h,c,a),h,y,w)})},Vr=({tableId:s,rowId:t,cellId:e,store:o,className:c,showType:a})=>{var u;return L.jsx(Sl,{thing:Sn(s,t,e,o),onThingChange:xc(s,t,e,f=>f,[],o),className:c??ll+ho,showType:a,hasSchema:(u=at(o))==null?void 0:u.hasTablesSchema})},Z0=({valueId:s,store:t,className:e,showType:o})=>{var c;return L.jsx(Sl,{thing:We(s,t),onThingChange:oc(s,a=>a,[],t),className:e??ll+nn,showType:o,hasSchema:(c=at(t))==null?void 0:c.hasValuesSchema})},O0=({onChange:s,total:t,offset:e=0,limit:o=t,singular:c="row",plural:a=c+"s"})=>{(e>t||e<0)&&(e=0,s(0));const u=Sc(()=>s(e-o),[s,e,o],e>0),f=Sc(()=>s(e+o),[s,e,o],e+o<t);return L.jsxs(L.Fragment,{children:[t>o&&L.jsxs(L.Fragment,{children:[L.jsx("button",{className:"previous",disabled:e==0,onClick:u,children:U0}),L.jsx("button",{className:"next",disabled:e+o>=t,onClick:f,children:W0}),e+1," to ",l0(t,e+o)," of "]}),t," ",t!=1?a:c]})},ht=({uniqueId:s,summary:t,editable:e,handleEditable:o,children:c,s:a})=>{const u=!!Sn(fe,s,Oi,a),f=xc(fe,s,Oi,C=>C[tn].open,[],a);return L.jsxs("details",{open:u,onToggle:f,children:[L.jsxs("summary",{children:[t,o?L.jsx("img",{onClick:o,className:e?"done":"edit"}):null]}),c]})},I0=({indexes:s,indexesId:t,indexId:e,s:o})=>L.jsx(ht,{uniqueId:Lt("i",t,e),summary:"Index: "+e,s:o,children:vs(z1(e,s),c=>L.jsx(sd,{indexes:s,indexesId:t,indexId:e,sliceId:c,s:o},c))}),sd=({indexes:s,indexesId:t,indexId:e,sliceId:o,s:c})=>{const a=Lt("i",t,e,o),[u,f]=Ac(a,c);return L.jsx(ht,{uniqueId:a,summary:"Slice: "+o,editable:u,handleEditable:f,s:c,children:L.jsx(q0,{sliceId:o,indexId:e,indexes:s,editable:u})})},na=({indexesId:s,s:t})=>{const e=Ba(s),o=U1(e);return ts(e)?null:L.jsx(ht,{uniqueId:Lt("i",s),summary:"Indexes: "+(s??ct),s:t,children:Et(o)?"No indexes defined":vc(o,c=>L.jsx(I0,{indexes:e,indexesId:s,indexId:c,s:t},c))})},td=({metrics:s,metricId:t})=>L.jsxs("tr",{children:[L.jsx("th",{children:t}),L.jsx("td",{children:s==null?void 0:s.getTableId(t)}),L.jsx("td",{children:F1(t,s)})]}),oa=({metricsId:s,s:t})=>{const e=Wa(s),o=_1(e);return ts(e)?null:L.jsx(ht,{uniqueId:Lt("m",s),summary:"Metrics: "+(s??ct),s:t,children:Et(o)?"No metrics defined":L.jsxs("table",{children:[L.jsxs("thead",{children:[L.jsx("th",{children:"Metric Id"}),L.jsx("th",{children:"Table Id"}),L.jsx("th",{children:"Metric"})]}),L.jsx("tbody",{children:vs(o,c=>L.jsx(td,{metrics:e,metricId:c},c))})]})})},ed=({queries:s,queriesId:t,queryId:e,s:o})=>{const c=Lt("q",t,e),[a,u,f]=He(Sn(fe,c,lc,o)??"[]"),C=xc(fe,c,lc,Xt,[],o);return L.jsx(ht,{uniqueId:c,summary:"Query: "+e,s:o,children:L.jsx(X0,{queryId:e,queries:s,cellId:a,descending:u,offset:f,limit:10,paginator:!0,sortOnClick:!0,onChange:C})})},ca=({queriesId:s,s:t})=>{const e=Ja(s),o=J1(e);return ts(e)?null:L.jsx(ht,{uniqueId:Lt("q",s),summary:"Queries: "+(s??ct),s:t,children:Et(o)?"No queries defined":vc(o,c=>L.jsx(ed,{queries:e,queriesId:s,queryId:c,s:t},c))})},nd=({relationships:s,relationshipsId:t,relationshipId:e,s:o})=>{const c=Lt("r",t,e),[a,u]=Ac(c,o);return L.jsx(ht,{uniqueId:c,summary:"Relationship: "+e,editable:a,handleEditable:u,s:o,children:L.jsx(K0,{relationshipId:e,relationships:s,editable:a})})},ia=({relationshipsId:s,s:t})=>{const e=Ga(s),o=Q1(e);return ts(e)?null:L.jsx(ht,{uniqueId:Lt("r",s),summary:"Relationships: "+(s??ct),s:t,children:Et(o)?"No relationships defined":vc(o,c=>L.jsx(nd,{relationships:e,relationshipsId:s,relationshipId:c,s:t},c))})},od=({tableId:s,store:t,storeId:e,s:o})=>{const c=Lt("t",e,s),[a,u,f]=He(Sn(fe,c,lc,o)??"[]"),C=xc(fe,c,lc,Xt,[],o),[S,T]=Ac(c,o);return L.jsx(ht,{uniqueId:c,summary:Ue+": "+s,editable:S,handleEditable:T,s:o,children:L.jsx(J0,{tableId:s,store:t,cellId:a,descending:u,offset:f,limit:10,paginator:!0,sortOnClick:!0,onChange:C,editable:S})})},cd=({store:s,storeId:t,s:e})=>{const o=Lt("v",t),[c,a]=Ac(o,e);return Et(Ha(s))?null:L.jsx(ht,{uniqueId:o,summary:Yi,editable:c,handleEditable:a,s:e,children:L.jsx(Y0,{store:s,editable:c})})},ra=({storeId:s,s:t})=>{const e=Ua(s),o=m1(e);return ts(e)?null:L.jsxs(ht,{uniqueId:Lt("s",s),summary:(e.isMergeable()?"Mergeable":"")+"Store: "+(s??ct),s:t,children:[L.jsx(cd,{storeId:s,store:e,s:t}),vc(o,c=>L.jsx(od,{store:e,storeId:s,tableId:c,s:t},c))]})},id=({s})=>{const t=Ir(null),e=Ir(0),[o,c]=ke(!1),{scrollLeft:a,scrollTop:u}=p1(s);_0(()=>{const b=t.current;if(b&&!o){const ls=new MutationObserver(()=>{b.scrollWidth>=Jr(a)+b.clientWidth&&b.scrollHeight>=Jr(u)+b.clientHeight&&b.scrollTo(a,u)});return ls.observe(b,{childList:!0,subtree:!0}),()=>ls.disconnect()}},[o,a,u]);const f=Vt(b=>{const{scrollLeft:ls,scrollTop:Rs}=b[tn];cancelIdleCallback(e.current),e.current=requestIdleCallback(()=>{c(!0),s.setPartialValues({scrollLeft:ls,scrollTop:Rs})})},[s]),C=Ua(),S=D1(),T=Wa(),h=M1(),y=Ba(),w=k1(),E=Ga(),V=W1(),m=Ja(),P=G1();return ts(C)&&Et(S)&&ts(T)&&Et(h)&&ts(y)&&Et(w)&&ts(E)&&Et(V)&&ts(m)&&Et(P)?L.jsx("span",{className:"warn",children:"There are no Stores or other objects to inspect. Make sure you placed the Inspector inside a Provider component."}):L.jsxs("article",{ref:t,onScroll:f,children:[L.jsx(ra,{s}),vs(S,b=>L.jsx(ra,{storeId:b,s},b)),L.jsx(oa,{s}),vs(h,b=>L.jsx(oa,{metricsId:b,s},b)),L.jsx(na,{s}),vs(w,b=>L.jsx(na,{indexesId:b,s},b)),L.jsx(ia,{s}),vs(V,b=>L.jsx(ia,{relationshipsId:b,s},b)),L.jsx(ca,{s}),vs(P,b=>L.jsx(ca,{queriesId:b,s},b))]})};class rd extends M0{constructor(e){super(e);Fr(this,"componentDidCatch",(e,o)=>console.error(e,o.componentStack));this.state={e:0}}static getDerivedStateFromError(){return{e:1}}render(){return this.state.e?L.jsx("span",{className:"warn",children:"Inspector error: please see console for details."}):this.props.children}}const ad=({s})=>{const t=We(uc,s)??1,e=oc(dc,()=>!1,[],s),o=oc(uc,c=>Number(c[tn].dataset.id),[],s);return L.jsxs("header",{children:[L.jsx("img",{title:Zi}),L.jsx("span",{children:Zi}),vs(al,(c,a)=>a==t?null:L.jsx("img",{onClick:o,"data-id":a,title:"Dock to "+c},a)),L.jsx("img",{onClick:e,title:"Close"})]})},ld=({s})=>{const t=We(uc,s)??1;return We(dc,s)?L.jsxs("main",{"data-position":t,children:[L.jsx(ad,{s}),L.jsx(rd,{children:L.jsx(id,{s})})]}):null};var ud="data:image/svg+xml,%3csvg viewBox='0 0 680 680' xmlns='http://www.w3.org/2000/svg' style='width:680px%3bheight:680px'%3e %3cpath stroke='white' stroke-width='80' fill='none' d='M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z' /%3e %3cpath fill='%23d81b60' d='M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z' /%3e %3cpath d='M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z' /%3e%3c/svg%3e";const $l="M20 80l5-15l40-40l10 10l-40 40l-15 5m5-15l10 10",fl='content:url("',Tl='")',_c=fl+"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' stroke-width='4' stroke='white' fill='none'>",Fc="</svg>"+Tl,aa=fl+ud+Tl,dd=vs([[20,20,20,60],[20,20,60,20],[20,60,60,20],[60,20,20,60],[30,30,40,40]],([s,t,e,o])=>_c+`<rect x='20' y='20' width='60' height='60' fill='grey'/><rect x='${s}' y='${t}' width='${e}' height='${o}' fill='white'/>`+Fc),Sd=_c+"<path d='M20 20l60 60M20 80l60-60' />"+Fc,$d=_c+`<path d='${$l}' />`+Fc,fd=_c+`<path d='${$l}M20 20l60 60' />`+Fc,ao="*::-webkit-scrollbar",Td=L0(on({"":"all:initial;font-family:sans-serif;font-size:0.75rem;position:fixed;z-index:999999","*":"all:revert","*::before":"all:revert","*::after":"all:revert",[ao]:"width:0.5rem;height:0.5rem;",[ao+"-track"]:"background:#111",[ao+"-thumb"]:"background:#999;border:1px solid #111",[ao+"-thumb:hover"]:"background:#fff",[ao+"-corner"]:"background:#111",img:"width:1rem;height:1rem;background:#111;border:0;vertical-align:text-bottom",">img":"padding:0.25rem;bottom:0;right:0;position:fixed;"+aa,...Ro(vs(["bottom:0;left:0","top:0;right:0"],(s,t)=>[`>img[data-position='${t}']`,s])),main:"display:flex;flex-direction:column;background:#111d;color:#fff;position:fixed;",...Ro(vs(["bottom:0;left:0;width:35vw;height:100vh","top:0;right:0;width:100vw;height:30vh","bottom:0;left:0;width:100vw;height:30vh","top:0;right:0;width:35vw;height:100vh","top:0;right:0;width:100vw;height:100vh"],(s,t)=>[`main[data-position='${t}']`,s])),header:"display:flex;padding:0.25rem;background:#000;align-items:center","header>img:nth-of-type(1)":aa,"header>img:nth-of-type(6)":Sd,...Ro(vs(dd,(s,t)=>[`header>img[data-id='${t}']`,s])),"header>span":"flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-left:0.25rem",article:"padding:0.25rem 0.25rem 0.25rem 0.5rem;overflow:auto;flex:1",details:"margin-left:0.75rem;width:fit-content;","details img":"display:none","details[open]>summary img":"display:unset;background:none;margin-left:0.25rem","details[open]>summary img.edit":$d,"details[open]>summary img.done":fd,summary:"margin-left:-0.75rem;line-height:1.25rem;user-select:none;width:fit-content",table:"border-collapse:collapse;table-layout:fixed;margin-bottom:0.5rem","table input":"background:#111;color:unset;padding:0 0.25rem;border:0;font-size:unset;vertical-align:top;margin:0",'table input[type="number"]':"width:4rem","table tbody button":"font-size:0;background:#fff;border-radius:50%;margin:0 0.125rem 0 0;width:0.85rem;color:#111","table button:first-letter":"font-size:0.75rem",thead:"background:#222","th:nth-of-type(1)":"min-width:2rem;","th.sorted":"background:#000","table caption":"text-align:left;white-space:nowrap;line-height:1.25rem",button:"width:1.5rem;border:none;background:none;color:#fff;padding:0","button[disabled]":"color:#777","button.next":"margin-right:0.5rem",[`th,#${ac} td`]:"overflow:hidden;text-overflow:ellipsis;padding:0.25rem 0.5rem;max-width:12rem;white-space:nowrap;border-width:1px 0;border-style:solid;border-color:#777;text-align:left","span.warn":"margin:0.25rem;color:#d81b60"},(s,t)=>s?`#${ac} ${t}{${s}}`:"")),MT=({position:s="right",open:t=!1})=>{const e=P1(rl),o=al.indexOf(s);return Z1(e,c=>A0(c,ac),void 0,async c=>{await c.load([{},{position:o==-1?1:o,open:!!t}]),await c.startAutoSave()}),L.jsxs(L.Fragment,{children:[L.jsxs("aside",{id:ac,children:[L.jsx(z0,{s:e}),L.jsx(ld,{s:e})]}),L.jsx("style",{children:Td})]})},jo=s=>typeof s,Cd="tinybase",rt="",Ld=jo(rt),hd=jo(jo),Rd="Listener",Js="Result",yd="get",gd="set",wd="add",Ed="del",he="Has",Vd="has",et="Ids",Ys="Table",$n=Ys+"s",Cl=Ys+et,nt="Row",kc=nt+"Count",Nt=nt+et,zc="Sorted"+nt+et,Rt="Cell",Re=Rt+et,ye="Value",Ye=ye+"s",Ll=ye+et,br="Transaction",hl="Partial",Rl="Finish",Uc="Status",jr="Metric",bd="Index",Hc="Slice",jd="Relationship",yl="Remote"+nt+"Id",gl="Local",wl="Linked",xd="Query",Wc="Checkpoint",Fi=globalThis,Tt=s=>s==null,Ct=(s,t,e)=>Tt(s)?e==null?void 0:e():t(s),El=s=>jo(s)==Ld,xr=s=>jo(s)==hd,Pd=s=>Array.isArray(s),xo=s=>s.length,cn=()=>{},Dd=(s,t)=>ot(new Array(s).fill(0),(e,o)=>t(o)),Vl=(s,t)=>s.every(t),ki=(s,t)=>xo(s)===xo(t)&&Vl(s,(e,o)=>t[o]===e),ot=(s,t)=>s.map(t),md=s=>xo(s)==0,Nd=(s,t)=>s.filter(t),la=(s,t,e)=>s.with(t,e),Qc=Object,ua=s=>Qc.getPrototypeOf(s),vd=Qc.entries,$c=s=>!Tt(s)&&Ct(ua(s),t=>t==Qc.prototype||Tt(ua(t)),()=>!0),bl=Qc.keys,jl=(s,t)=>Ct(s,e=>e[t]),Ad=(s,t)=>t in s,pd=(s,t)=>(delete s[t],s),Md=s=>xo(bl(s)),xl=(s,t)=>{const e=vd(s);return xo(e)===Md(t)&&Vl(e,([o,c])=>$c(c)?$c(t[o])?xl(t[o],c):!1:t[o]===c)},{PureComponent:_T,createContext:_d,useCallback:Pt,useContext:Ao,useEffect:rn,useLayoutEffect:Fd,useMemo:Pr,useRef:kd,useState:an,useSyncExternalStore:zd}=dr,yt=(s,...t)=>Tt(s)?{}:s(...t),Pl=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getLocalTableId(t),s==null?void 0:s.getRemoteTableId(t)],Ud=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getTableId(t)];var is=(s=>(s[s.Store=0]="Store",s[s.Metrics=1]="Metrics",s[s.Indexes=2]="Indexes",s[s.Relationships=3]="Relationships",s[s.Queries=4]="Queries",s[s.Checkpoints=5]="Checkpoints",s[s.Persister=6]="Persister",s[s.Synchronizer=7]="Synchronizer",s))(is||{});const zi=Cd+"_uirc",ln=Fi[zi]?Fi[zi]:Fi[zi]=_d([]),te=(s,t)=>{const e=Ao(ln);return Tt(s)?e[t*2]:El(s)?jl(e[t*2+1],s):s},Hd=s=>({...Ao(ln)[s*2+1]}),ge=(s,t)=>{const e=te(s,t);return Tt(s)||El(s)?e:s},we=(s,t,e)=>{const{16:o,17:c}=Ao(ln);rn(()=>(o==null||o(e,s,t),()=>c==null?void 0:c(e,s)),[o,s,t,e,c])},Ee=s=>bl(Ao(ln)[s*2+1]??{}),ws=[],da=[{},[],[ws,void 0,ws],void 0,!1,0],Wd=[xl,ki,([s,t,e],[o,c,a])=>t===c&&ki(s,o)&&ki(e,a)],Qd=(s,t)=>s===t,po=(s,t,e=ws)=>{const[,o]=an(),[c,a]=an();return rn(()=>{const u=s?t(s):void 0;return a(u),o([]),u==null?void 0:u.destroy},[s,...e]),c},Dl=(s,t,...e)=>{var c;const o=(c=s==null?void 0:s[wd+t+Rd])==null?void 0:c.call(s,...e);return()=>{var a;return(a=s==null?void 0:s.delListener)==null?void 0:a.call(s,o)}},G=(s,t,e,o=ws)=>{const c=kd(da[e]),a=Pt(()=>{var C;const f=((C=t==null?void 0:t[(e==4?Vd:yd)+s])==null?void 0:C.call(t,...o))??da[e];return(Wd[e]??Qd)(f,c.current)?c.current:c.current=f},[t,e,s,...o]),u=Pt(f=>Dl(t,(e==4?he:rt)+s,...o,f),[t,e,s,...o]);return zd(u,a,a)},q=(s,t,e,o=ws,c=ws,...a)=>Fd(()=>Dl(t,s,...c,e,...a),[t,s,...c,...o,...a]),Ve=(s,t,e,o=ws,c=cn,a=ws,...u)=>{const f=U(s);return Pt(C=>Ct(f,S=>Ct(e(C,S),T=>c(S[gd+t](...ml(u,S,C),T),T))),[f,t,...o,...a,...Nl(u)])},ml=(s,t,e)=>ot(s,o=>xr(o)?o(e,t):o),Nl=s=>Nd(s,t=>!xr(t)),fn=(s,t,e=cn,o=ws,...c)=>{const a=U(s);return Pt(u=>e(a==null?void 0:a[Ed+t](...ml(c,a,u))),[a,t,...o,...Nl(c)])},vl=(s,t,e)=>{const o=gt(s);return Pt(()=>o==null?void 0:o[t](e),[o,t,e])},Bd=(s,t,e,o,c,a)=>G(zc,U(a),1,[s,t,e,o,c]),Al=(s,t,e,o,c,a,u,f,C)=>q(zc,U(C),a,u,[s,t,e,o,c],f),Gd=(s,t=ws)=>Pr(s,t),Jd=()=>Ee(is.Store),Yd=s=>te(s,is.Store),qd=()=>Hd(is.Store),U=s=>ge(s,is.Store),Kd=(s,t)=>we(s,t,is.Store),Xd=(s,t=ws)=>Pr(s,t),Zd=s=>G($n,U(s),4,[]),Od=s=>G($n,U(s),0),pl=s=>G(Cl,U(s),1),Id=(s,t)=>G(Ys,U(t),4,[s]),sS=(s,t)=>G(Ys,U(t),0,[s]),tS=(s,t)=>G(Ys+Re,U(t),1,[s]),eS=(s,t,e)=>G(Ys+Rt,U(e),4,[s,t]),nS=(s,t)=>G(kc,U(t),5,[s]),Ml=(s,t)=>G(Nt,U(t),1,[s]),_l=(s,t,e,o,c,a)=>Bd(...$c(s)?[s.tableId,s.cellId,s.descending??!1,s.offset??0,s.limit,t]:[s,t,e,o,c,a]),oS=(s,t,e)=>G(nt,U(e),4,[s,t]),cS=(s,t,e)=>G(nt,U(e),0,[s,t]),Fl=(s,t,e)=>G(Re,U(e),1,[s,t]),iS=(s,t,e,o)=>G(Rt,U(o),4,[s,t,e]),kl=(s,t,e,o)=>G(Rt,U(o),3,[s,t,e]),rS=s=>G(Ye,U(s),4,[]),aS=s=>G(Ye,U(s),0),zl=s=>G(Ll,U(s),1),lS=(s,t)=>G(ye,U(t),4,[s]),Ul=(s,t)=>G(ye,U(t),3,[s]),uS=(s,t,e,o,c)=>Ve(e,$n,s,t,o,c),dS=(s,t,e,o,c,a)=>Ve(o,Ys,t,e,c,a,s),SS=(s,t,e,o,c,a,u)=>Ve(c,nt,e,o,a,u,s,t),$S=(s,t,e=ws,o,c=cn,a=ws,u=!0)=>{const f=U(o);return Pt(C=>Ct(f,S=>Ct(t(C,S),T=>c(S.addRow(xr(s)?s(C,S):s,T,u),S,T))),[f,s,...e,...a,u])},fS=(s,t,e,o,c,a,u)=>Ve(c,hl+nt,e,o,a,u,s,t),TS=(s,t,e,o,c,a,u,f)=>Ve(a,Rt,o,c,u,f,s,t,e),CS=(s,t,e,o,c)=>Ve(e,Ye,s,t,o,c),LS=(s,t,e,o,c)=>Ve(e,hl+Ye,s,t,o,c),hS=(s,t,e,o,c,a)=>Ve(o,ye,t,e,c,a,s),RS=(s,t,e)=>fn(s,$n,t,e),yS=(s,t,e,o)=>fn(t,Ys,e,o,s),gS=(s,t,e,o,c)=>fn(e,nt,o,c,s,t),wS=(s,t,e,o,c,a,u)=>fn(c,Rt,a,u,s,t,e,o),ES=(s,t,e)=>fn(s,Ye,t,e),VS=(s,t,e,o)=>fn(t,ye,e,o,s),bS=(s,t,e,o)=>q(he+$n,U(o),s,t,[],e),jS=(s,t,e,o)=>q($n,U(o),s,t,ws,e),xS=(s,t,e,o)=>q(Cl,U(o),s,t,ws,e),PS=(s,t,e,o,c)=>q(he+Ys,U(c),t,e,[s],o),DS=(s,t,e,o,c)=>q(Ys,U(c),t,e,[s],o),mS=(s,t,e,o,c)=>q(Ys+Re,U(c),t,e,[s],o),NS=(s,t,e,o,c,a)=>q(he+Ys+Rt,U(a),e,o,[s,t],c),vS=(s,t,e,o,c)=>q(kc,U(c),t,e,[s],o),AS=(s,t,e,o,c)=>q(Nt,U(c),t,e,[s],o),pS=(s,t,e,o,c,a,u,f,C)=>Al(...$c(s)?[s.tableId,s.cellId,s.descending??!1,s.offset??0,s.limit,t,e,o,c]:[s,t,e,o,c,a,u,f,C]),MS=(s,t,e,o,c,a)=>q(he+nt,U(a),e,o,[s,t],c),_S=(s,t,e,o,c,a)=>q(nt,U(a),e,o,[s,t],c),FS=(s,t,e,o,c,a)=>q(Re,U(a),e,o,[s,t],c),kS=(s,t,e,o,c,a,u)=>q(he+Rt,U(u),o,c,[s,t,e],a),zS=(s,t,e,o,c,a,u)=>q(Rt,U(u),o,c,[s,t,e],a),US=(s,t,e,o)=>q(he+Ye,U(o),s,t,[],e),HS=(s,t,e,o)=>q(Ye,U(o),s,t,ws,e),WS=(s,t,e,o)=>q(Ll,U(o),s,t,ws,e),QS=(s,t,e,o,c)=>q(he+ye,U(c),t,e,[s],o),BS=(s,t,e,o,c)=>q(ye,U(c),t,e,[s],o),GS=(s,t,e)=>q("Start"+br,U(e),s,t),JS=(s,t,e)=>q("Will"+Rl+br,U(e),s,t),YS=(s,t,e)=>q("Did"+Rl+br,U(e),s,t),qS=(s,t,e)=>po(s,t,e),KS=()=>Ee(is.Metrics),XS=s=>te(s,is.Metrics),Bc=s=>ge(s,is.Metrics),ZS=(s,t)=>we(s,t,is.Metrics),OS=s=>G(jr+et,Bc(s),1),Hl=(s,t)=>G(jr,Bc(t),3,[s]),IS=(s,t,e,o)=>q(jr,Bc(o),t,e,[s]),s$=(s,t,e)=>po(s,t,e),t$=()=>Ee(is.Indexes),e$=s=>te(s,is.Indexes),qe=s=>ge(s,is.Indexes),n$=(s,t)=>we(s,t,is.Indexes),Wl=(s,t)=>G(Hc+et,qe(t),1,[s]),o$=s=>G(bd+et,qe(s),1),Ql=(s,t,e)=>G(Hc+Nt,qe(e),1,[s,t]),c$=(s,t,e,o)=>q(Hc+et,qe(o),t,e,[s]),i$=(s,t,e,o,c)=>q(Hc+Nt,qe(c),e,o,[s,t]),r$=(s,t,e)=>po(s,t,e),a$=()=>Ee(is.Relationships),l$=s=>te(s,is.Relationships),vt=s=>ge(s,is.Relationships),u$=(s,t)=>we(s,t,is.Relationships),d$=s=>G(jd+et,vt(s),1),Bl=(s,t,e)=>G(yl,vt(e),3,[s,t]),Gl=(s,t,e)=>G(gl+Nt,vt(e),1,[s,t]),Jl=(s,t,e)=>G(wl+Nt,vt(e),1,[s,t]),S$=(s,t,e,o,c)=>q(yl,vt(c),e,o,[s,t]),$$=(s,t,e,o,c)=>q(gl+Nt,vt(c),e,o,[s,t]),f$=(s,t,e,o,c)=>q(wl+Nt,vt(c),e,o,[s,t]),T$=(s,t,e)=>po(s,t,e),C$=()=>Ee(is.Queries),L$=s=>te(s,is.Queries),zs=s=>ge(s,is.Queries),h$=(s,t)=>we(s,t,is.Queries),R$=s=>G(xd+et,zs(s),1),y$=(s,t)=>G(Js+Ys,zs(t),0,[s]),g$=(s,t)=>G(Js+Ys+Re,zs(t),1,[s]),w$=(s,t)=>G(Js+kc,zs(t),5,[s]),Yl=(s,t)=>G(Js+Nt,zs(t),1,[s]),ql=(s,t,e,o=0,c,a)=>G(Js+zc,zs(a),1,[s,t,e,o,c]),E$=(s,t,e)=>G(Js+nt,zs(e),0,[s,t]),Kl=(s,t,e)=>G(Js+Re,zs(e),1,[s,t]),Xl=(s,t,e,o)=>G(Js+Rt,zs(o),3,[s,t,e]),V$=(s,t,e,o)=>q(Js+Ys,zs(o),t,e,[s]),b$=(s,t,e,o)=>q(Js+Ys+Re,zs(o),t,e,[s]),j$=(s,t,e,o)=>q(Js+kc,zs(o),t,e,[s]),x$=(s,t,e,o)=>q(Js+Nt,zs(o),t,e,[s]),P$=(s,t,e,o,c,a,u,f)=>q(Js+zc,zs(f),a,u,[s,t,e,o,c]),D$=(s,t,e,o,c)=>q(Js+nt,zs(c),e,o,[s,t]),m$=(s,t,e,o,c)=>q(Js+Re,zs(c),e,o,[s,t]),N$=(s,t,e,o,c,a)=>q(Js+Rt,zs(a),o,c,[s,t,e]),v$=(s,t,e)=>po(s,t,e),A$=()=>Ee(is.Checkpoints),p$=s=>te(s,is.Checkpoints),gt=s=>ge(s,is.Checkpoints),M$=(s,t)=>we(s,t,is.Checkpoints),Gc=s=>G(Wc+et,gt(s),2),Zl=(s,t)=>G(Wc,gt(t),3,[s]),_$=(s=cn,t=ws,e,o=cn,c=ws)=>{const a=gt(e);return Pt(u=>Ct(a,f=>{const C=s(u);o(f.addCheckpoint(C),f,C)}),[a,...t,...c])},Ol=s=>vl(s,"goBackward"),Il=s=>vl(s,"goForward"),F$=(s,t=ws,e,o=cn,c=ws)=>{const a=gt(e);return Pt(u=>Ct(a,f=>Ct(s(u),C=>o(f.goTo(C),C))),[a,...t,...c])},k$=s=>{const t=gt(s),[e,o]=Gc(t);return[!md(e),Ol(t),o,Ct(o,c=>t==null?void 0:t.getCheckpoint(c))??rt]},z$=s=>{const t=gt(s),[,,[e]]=Gc(t);return[!Tt(e),Il(t),e,Ct(e,o=>t==null?void 0:t.getCheckpoint(o))??rt]},U$=(s,t,e)=>q(Wc+et,gt(e),s,t),H$=(s,t,e,o)=>q(Wc,gt(o),t,e,[s]),W$=(s,t,e=ws,o,c=ws,a,u=ws)=>{const[,f]=an(),[C,S]=an();return rn(()=>{(async()=>{const T=s?await t(s):void 0;S(T),T&&o&&(async()=>(await o(T),f([])))()})()},[s,...e,...c]),rn(()=>()=>{C&&(C.destroy(),a==null||a(C))},[C,...u]),C},Q$=()=>Ee(is.Persister),B$=s=>te(s,is.Persister),Dr=s=>ge(s,is.Persister),G$=(s,t)=>we(s,t,is.Persister),J$=s=>G(Uc,Dr(s),5,[]),Y$=(s,t,e)=>q(Uc,Dr(e),s,t,[]),q$=(s,t,e=ws,o,c=ws)=>{const[a,u]=an();return rn(()=>{(async()=>{const f=s?await t(s):void 0;u(f)})()},[s,...e]),rn(()=>()=>{a&&(a.destroy(),o==null||o(a))},[a,...c]),a},K$=()=>Ee(is.Synchronizer),X$=s=>te(s,is.Synchronizer),mr=s=>ge(s,is.Synchronizer),Z$=(s,t)=>we(s,t,is.Synchronizer),O$=s=>G(Uc,mr(s),5,[]),I$=(s,t,e)=>q(Uc,mr(e),s,t,[]),ce=(s,t,e,o,c)=>[e??t[s*2],{...t[s*2+1],...o,...c[s]}],su=({tableId:s,store:t,rowComponent:e=Mo,getRowComponentProps:o,customCellIds:c,separator:a,debugIds:u},f)=>qs(ot(f,C=>L.jsx(e,{...yt(o,C),tableId:s,rowId:C,customCellIds:c,store:t,debugIds:u},C)),a,u,s),tu=({queryId:s,queries:t,resultRowComponent:e=au,getResultRowComponentProps:o,separator:c,debugIds:a},u)=>qs(ot(u,f=>L.jsx(e,{...yt(o,f),queryId:s,rowId:f,queries:t,debugIds:a},f)),c,a,s),eu=({relationshipId:s,relationships:t,rowComponent:e=Mo,getRowComponentProps:o,separator:c,debugIds:a},u,f)=>{const[C,S,T]=Pl(vt(t),s),h=u(s,f,C);return qs(ot(h,y=>L.jsx(e,{...yt(o,y),tableId:T,rowId:y,store:S,debugIds:a},y)),c,a,f)},Nr=s=>({checkpoints:t,checkpointComponent:e=lu,getCheckpointComponentProps:o,separator:c,debugIds:a})=>{const u=gt(t);return qs(ot(s(Gc(u)),f=>L.jsx(e,{...yt(o,f),checkpoints:u,checkpointId:f,debugIds:a},f)),c)},sf=({store:s,storesById:t,metrics:e,metricsById:o,indexes:c,indexesById:a,relationships:u,relationshipsById:f,queries:C,queriesById:S,checkpoints:T,checkpointsById:h,persister:y,persistersById:w,synchronizer:E,synchronizersById:V,children:m})=>{const P=Ao(ln),[b,ls]=an(()=>Dd(8,()=>({}))),Rs=Pt((O,j,M)=>ls(K=>jl(K[O],j)==M?K:la(K,O,{...K[O],[j]:M})),[]),Ss=Pt((O,j)=>ls(M=>Ad(M[O],j)?la(M,O,pd(M[O],j)):M),[]);return L.jsx(ln.Provider,{value:Pr(()=>[...ce(0,P,s,t,b),...ce(1,P,e,o,b),...ce(2,P,c,a,b),...ce(3,P,u,f,b),...ce(4,P,C,S,b),...ce(5,P,T,h,b),...ce(6,P,y,w,b),...ce(7,P,E,V,b),Rs,Ss],[b,s,t,e,o,c,a,u,f,C,S,T,h,y,w,E,V,P,Rs,Ss]),children:m})},qs=(s,t,e,o)=>{const c=Tt(t)||!Pd(s)?s:ot(s,(a,u)=>u>0?[t,a]:a);return e?[o,":{",c,"}"]:c},tf=(s,t,e,o)=>{const c=Fl(t,e,o);return s??c},nu=({tableId:s,rowId:t,cellId:e,store:o,debugIds:c})=>qs(rt+(kl(s,t,e,o)??rt),void 0,c,e),Mo=({tableId:s,rowId:t,store:e,cellComponent:o=nu,getCellComponentProps:c,customCellIds:a,separator:u,debugIds:f})=>qs(ot(tf(a,s,t,e),C=>L.jsx(o,{...yt(c,C),tableId:s,rowId:t,cellId:C,store:e,debugIds:f},C)),u,f,t),ou=s=>su(s,Ml(s.tableId,s.store)),ef=({cellId:s,descending:t,offset:e,limit:o,...c})=>su(c,_l(c.tableId,s,t,e,o,c.store)),nf=({store:s,tableComponent:t=ou,getTableComponentProps:e,separator:o,debugIds:c})=>qs(ot(pl(s),a=>L.jsx(t,{...yt(e,a),tableId:a,store:s,debugIds:c},a)),o),cu=({valueId:s,store:t,debugIds:e})=>qs(rt+(Ul(s,t)??rt),void 0,e,s),of=({store:s,valueComponent:t=cu,getValueComponentProps:e,separator:o,debugIds:c})=>qs(ot(zl(s),a=>L.jsx(t,{...yt(e,a),valueId:a,store:s,debugIds:c},a)),o),cf=({metricId:s,metrics:t,debugIds:e})=>qs(Hl(s,t)??rt,void 0,e,s),iu=({indexId:s,sliceId:t,indexes:e,rowComponent:o=Mo,getRowComponentProps:c,separator:a,debugIds:u})=>{const[f,C,S]=Ud(qe(e),s),T=Ql(s,t,f);return qs(ot(T,h=>L.jsx(o,{...yt(c,h),tableId:S,rowId:h,store:C,debugIds:u},h)),a,u,t)},rf=({indexId:s,indexes:t,sliceComponent:e=iu,getSliceComponentProps:o,separator:c,debugIds:a})=>qs(ot(Wl(s,t),u=>L.jsx(e,{...yt(o,u),indexId:s,sliceId:u,indexes:t,debugIds:a},u)),c,a,s),af=({relationshipId:s,localRowId:t,relationships:e,rowComponent:o=Mo,getRowComponentProps:c,debugIds:a})=>{const[u,f,,C]=Pl(vt(e),s),S=Bl(s,t,u);return qs(Tt(C)||Tt(S)?null:L.jsx(o,{...yt(c,S),tableId:C,rowId:S,store:f,debugIds:a},S),void 0,a,t)},lf=s=>eu(s,Gl,s.remoteRowId),uf=s=>eu(s,Jl,s.firstRowId),ru=({queryId:s,rowId:t,cellId:e,queries:o,debugIds:c})=>qs(rt+(Xl(s,t,e,o)??rt),void 0,c,e),au=({queryId:s,rowId:t,queries:e,resultCellComponent:o=ru,getResultCellComponentProps:c,separator:a,debugIds:u})=>qs(ot(Kl(s,t,e),f=>L.jsx(o,{...yt(c,f),queryId:s,rowId:t,cellId:f,queries:e,debugIds:u},f)),a,u,t),df=s=>tu(s,Yl(s.queryId,s.queries)),Sf=({cellId:s,descending:t,offset:e,limit:o,...c})=>tu(c,ql(c.queryId,s,t,e,o,c.queries)),lu=({checkpoints:s,checkpointId:t,debugIds:e})=>qs(Zl(t,s)??rt,void 0,e,t),$f=Nr(s=>s[0]),ff=Nr(s=>Tt(s[1])?[]:[s[1]]),Tf=Nr(s=>s[2]),FT=Object.freeze(Object.defineProperty({__proto__:null,BackwardCheckpointsView:$f,CellView:nu,CheckpointView:lu,CurrentCheckpointView:ff,ForwardCheckpointsView:Tf,IndexView:rf,LinkedRowsView:uf,LocalRowsView:lf,MetricView:cf,Provider:sf,RemoteRowView:af,ResultCellView:ru,ResultRowView:au,ResultSortedTableView:Sf,ResultTableView:df,RowView:Mo,SliceView:iu,SortedTableView:ef,TableView:ou,TablesView:nf,ValueView:cu,ValuesView:of,useAddRowCallback:$S,useCell:kl,useCellIds:Fl,useCellIdsListener:FS,useCellListener:zS,useCheckpoint:Zl,useCheckpointIds:Gc,useCheckpointIdsListener:U$,useCheckpointListener:H$,useCheckpoints:p$,useCheckpointsIds:A$,useCheckpointsOrCheckpointsById:gt,useCreateCheckpoints:v$,useCreateIndexes:s$,useCreateMergeableStore:Xd,useCreateMetrics:qS,useCreatePersister:W$,useCreateQueries:T$,useCreateRelationships:r$,useCreateStore:Gd,useCreateSynchronizer:q$,useDelCellCallback:wS,useDelRowCallback:gS,useDelTableCallback:yS,useDelTablesCallback:RS,useDelValueCallback:VS,useDelValuesCallback:ES,useDidFinishTransactionListener:YS,useGoBackwardCallback:Ol,useGoForwardCallback:Il,useGoToCallback:F$,useHasCell:iS,useHasCellListener:kS,useHasRow:oS,useHasRowListener:MS,useHasTable:Id,useHasTableCell:eS,useHasTableCellListener:NS,useHasTableListener:PS,useHasTables:Zd,useHasTablesListener:bS,useHasValue:lS,useHasValueListener:QS,useHasValues:rS,useHasValuesListener:US,useIndexIds:o$,useIndexes:e$,useIndexesIds:t$,useIndexesOrIndexesById:qe,useLinkedRowIds:Jl,useLinkedRowIdsListener:f$,useLocalRowIds:Gl,useLocalRowIdsListener:$$,useMetric:Hl,useMetricIds:OS,useMetricListener:IS,useMetrics:XS,useMetricsIds:KS,useMetricsOrMetricsById:Bc,usePersister:B$,usePersisterIds:Q$,usePersisterOrPersisterById:Dr,usePersisterStatus:J$,usePersisterStatusListener:Y$,useProvideCheckpoints:M$,useProvideIndexes:n$,useProvideMetrics:ZS,useProvidePersister:G$,useProvideQueries:h$,useProvideRelationships:u$,useProvideStore:Kd,useProvideSynchronizer:Z$,useQueries:L$,useQueriesIds:C$,useQueriesOrQueriesById:zs,useQueryIds:R$,useRedoInformation:z$,useRelationshipIds:d$,useRelationships:l$,useRelationshipsIds:a$,useRelationshipsOrRelationshipsById:vt,useRemoteRowId:Bl,useRemoteRowIdListener:S$,useResultCell:Xl,useResultCellIds:Kl,useResultCellIdsListener:m$,useResultCellListener:N$,useResultRow:E$,useResultRowCount:w$,useResultRowCountListener:j$,useResultRowIds:Yl,useResultRowIdsListener:x$,useResultRowListener:D$,useResultSortedRowIds:ql,useResultSortedRowIdsListener:P$,useResultTable:y$,useResultTableCellIds:g$,useResultTableCellIdsListener:b$,useResultTableListener:V$,useRow:cS,useRowCount:nS,useRowCountListener:vS,useRowIds:Ml,useRowIdsListener:AS,useRowListener:_S,useSetCellCallback:TS,useSetCheckpointCallback:_$,useSetPartialRowCallback:fS,useSetPartialValuesCallback:LS,useSetRowCallback:SS,useSetTableCallback:dS,useSetTablesCallback:uS,useSetValueCallback:hS,useSetValuesCallback:CS,useSliceIds:Wl,useSliceIdsListener:c$,useSliceRowIds:Ql,useSliceRowIdsListener:i$,useSortedRowIds:_l,useSortedRowIdsListener:pS,useSortedRowIdsListenerImpl:Al,useStartTransactionListener:GS,useStore:Yd,useStoreIds:Jd,useStoreOrStoreById:U,useStores:qd,useSynchronizer:X$,useSynchronizerIds:K$,useSynchronizerOrSynchronizerById:mr,useSynchronizerStatus:O$,useSynchronizerStatusListener:I$,useTable:sS,useTableCellIds:tS,useTableCellIdsListener:mS,useTableIds:pl,useTableIdsListener:xS,useTableListener:DS,useTables:Od,useTablesListener:jS,useUndoInformation:k$,useValue:Ul,useValueIds:zl,useValueIdsListener:WS,useValueListener:BS,useValues:aS,useValuesListener:HS,useWillFinishTransactionListener:JS},Symbol.toStringTag,{value:"Module"})),fc="",uu="￼",Cf=globalThis,Sa=Cf.window,bt=s=>s==null,Tc=(s,t,e)=>bt(s)?e==null?void 0:e():t(s),Ii=s=>Array.isArray(s),Qe=s=>s.length,Lf=(s,t)=>s.test(t),du=s=>{throw new Error(s)},Oe=async(s,t,e)=>{try{return await s()}catch(o){t==null||t(o)}},sr=(s,t)=>s.forEach(t),hf=(s,t)=>s.splice(0,t),vr=(s,...t)=>s.push(...t),Su=s=>s.shift(),Jc=Object,$a=s=>Jc.getPrototypeOf(s),Rf=s=>!bt(s)&&Tc($a(s),t=>t==Jc.prototype||bt($a(t)),()=>!0),yf=Jc.keys,gf=Jc.freeze,wf=s=>Qe(yf(s)),Bo=s=>Rf(s)&&wf(s)==0,Ef=JSON.stringify,$u=JSON.parse,Vf=s=>Ef(s,(t,e)=>e===void 0?uu:e),bf=s=>$u(s,(t,e)=>e===uu?void 0:e),jf=s=>(s==null?void 0:s.size)??0,xf=(s,t)=>(s==null?void 0:s.has(t))??!1,fu=s=>bt(s)||jf(s)==0,Tu=(s,t)=>s==null?void 0:s.forEach(t),Cu=(s,t)=>s==null?void 0:s.delete(t),_o=s=>new Map(s),$t=(s,t)=>s==null?void 0:s.get(t),Be=(s,t,e)=>bt(e)?(Cu(s,t),s):s==null?void 0:s.set(t,e),tr=(s,t,e,o)=>(xf(s,t)?o==null||o($t(s,t)):Be(s,t,e()),$t(s,t)),er=(s,t,e,o,c=0)=>Tc((e?tr:$t)(s,t[c],c>Qe(t)-2?e:_o),a=>{if(c>Qe(t)-2)return o!=null&&o(a)&&Be(s,t[c]),a;const u=er(a,t,e,o,c+1);return fu(a)&&Be(s,t[c]),u}),Pf=/^\d+$/,Df=()=>{const s=[];let t=0;return[e=>(e?Su(s):null)??fc+t++,e=>{Lf(Pf,e)&&Qe(s)<1e3&&vr(s,e)}]},mf=s=>new Set(Ii(s)||bt(s)?s:[s]),Nf=(s,t)=>s==null?void 0:s.add(t),vf=(s,t=[fc])=>{const e=[],o=(c,a)=>a==Qe(t)?vr(e,c):t[a]===null?Tu(c,u=>o(u,a+1)):sr([t[a],null],u=>o($t(c,u),a+1));return o(s,0),e},Af=s=>{let t;const[e,o]=Df(),c=_o();return[(S,T,h,y=[],w=()=>[])=>{t??(t=s());const E=e(1);return Be(c,E,[S,T,h,y,w]),Nf(er(T,h??[fc],mf),E),E},(S,T,...h)=>sr(vf(S,T),y=>Tu(y,w=>$t(c,w)[0](t,...T??[],...h))),S=>Tc($t(c,S),([,T,h])=>(er(T,h??[fc],void 0,y=>(Cu(y,S),fu(y)?1:0)),Be(c,S),o(S),h)),S=>Tc($t(c,S),([T,,h=[],y,w])=>{const E=(...V)=>{var P;const m=Qe(V);m==Qe(h)?T(t,...V,...w(V)):bt(h[m])?sr(((P=y[m])==null?void 0:P.call(y,...V))??[],b=>E(...V,b)):E(...V,h[m])};E()})]},Go=_o(),Jo=_o(),pf=(s=1,t,e)=>s!=1&&t.isMergeable()?[1,t.getMergeableContent,()=>t.getTransactionMergeableChanges(!e),([[o],[c]])=>!Bo(o)||!Bo(c),t.setDefaultContent]:s!=2?[0,t.getContent,t.getTransactionChanges,([o,c])=>!Bo(o)||!Bo(c),t.setContent]:du("Store type not supported by this Persister"),Mf=(s,t,e,o,c,a,u,f={},C=0,S=[])=>{let T=0,h=0,y=0,w,E,V;tr(Go,S,()=>0),tr(Jo,S,()=>[]);const m=_o(),[P,b,ls,Rs,Ss]=pf(u,s,C),[O,j,M]=Af(()=>k),K=R=>{R!=T&&(T=R,j(m,void 0,T))},_=async()=>{if(!$t(Go,S)){for(Be(Go,S,1);!bt(w=Su($t(Jo,S)));)await Oe(w,a);Be(Go,S,0)}},I=R=>{(P&&Ii(R==null?void 0:R[0])?(R==null?void 0:R[2])===1?s.applyMergeableChanges:s.setMergeableContent:(R==null?void 0:R[2])===1?s.applyChanges:s.setContent)(R)},us=async R=>(T!=2&&(K(1),h++,await Ts(async()=>{await Oe(async()=>{const p=await t();Ii(p)?I(p):R?Ss(R):du(`Content is not an array: ${p}`)},()=>{R&&Ss(R)}),K(0)})),k),ns=async R=>(N(),await us(R),await Oe(async()=>E=await o(async(p,Y)=>{Y||p?T!=2&&(K(1),h++,I(Y??p),K(0)):await us()}),a),k),N=async()=>(E&&(await Oe(()=>c(E),a),E=void 0),k),ss=()=>!bt(E),os=async R=>(T!=1&&(K(2),y++,await Ts(async()=>{await Oe(()=>e(b,R),a),K(0)})),k),cs=async()=>(es(),await os(),V=s.addDidFinishTransactionListener(()=>{const R=ls();Rs(R)&&os(R)}),k),es=async()=>(V&&(s.delListener(V),V=void 0),k),bs=()=>!bt(V),Es=async(R,p=!1)=>{const[Y,ys]=p?[cs,ns]:[ns,cs];return await Y(R),await ys(R),k},J=async(R=!1)=>{const[p,Y]=R?[es,N]:[N,es];return await p(),await Y(),k},fs=()=>T,hs=R=>O(R,m),Ns=R=>(M(R),s),Ts=async(...R)=>(vr($t(Jo,S),...R),await _(),k),k={load:us,startAutoLoad:ns,stopAutoLoad:N,isAutoLoading:ss,save:os,startAutoSave:cs,stopAutoSave:es,isAutoSaving:bs,startAutoPersisting:Es,stopAutoPersisting:J,getStatus:fs,addStatusListener:hs,delListener:Ns,schedule:Ts,getStore:()=>s,destroy:()=>(hf($t(Jo,S)),J()),getStats:()=>({loads:h,saves:y}),...f};return gf(k)},fa="storage",Lu=(s,t,e,o)=>Mf(s,async()=>bf(e.getItem(t)),async C=>e.setItem(t,Vf(C())),C=>{const S=T=>{T.storageArea===e&&T.key===t&&Oe(()=>C($u(T.newValue)),C)};return Sa.addEventListener(fa,S),S},C=>Sa.removeEventListener(fa,C),o,3,{getStorageName:()=>t}),kT=(s,t,e)=>Lu(s,t,localStorage,e),zT=(s,t,e)=>Lu(s,t,sessionStorage,e),Te=s=>typeof s,Ce="",hu=Te(Ce),_f=Te(!0),Ru=Te(0),Ff=Te(Te),Yo="type",Me="default",kf="Listener",zf="add",_e="Has",Yc="Ids",Ie="Table",Ta=Ie+"s",Uf=Ie+Yc,Cc="Row",Hf=Cc+"Count",Wf=Cc+Yc,sc="Cell",Ca=sc+Yc,Lc="Value",La=Lc+"s",Qf=Lc+Yc,ds=s=>Ce+s,Bf=isFinite,Gf=(s,t)=>s instanceof t,Vs=s=>s==null,ms=(s,t,e)=>Vs(s)?e==null?void 0:e():t(s),yu=s=>s==hu||s==_f,Jf=s=>Te(s)==hu,Ui=s=>Te(s)==Ff,un=s=>Array.isArray(s),ha=(s,t,e)=>s.slice(t,e),Dt=s=>s.length,Yf=(s,t)=>s.test(t),Hi=async(s,t,e)=>{try{return await s()}catch(o){t==null||t(o)}},qf=(s,t)=>s.includes(t),gu=(s,t)=>s.every(t),wu=(s,t)=>Dt(s)===Dt(t)&&gu(s,(e,o)=>t[o]===e),Ra=(s,t)=>gu(s,(e,o)=>o==0||t(s[o-1],e)<=0),nr=(s,t)=>s.sort(t),It=(s,t)=>s.forEach(t),Po=(s,t)=>s.map(t),Kf=s=>Dt(s)==0,Xf=(s,t,e)=>s.reduce(t,e),hc=(s,...t)=>s.push(...t),Zf=s=>s.shift(),lo=s=>{const t=Te(s);return yu(t)||t==Ru&&Bf(s)?t:void 0},ya=(s,t,e,o,c)=>Vs(c)?s.delCell(t,e,o,!0):s.setCell(t,e,o,c),ga=(s,t,e)=>Vs(e)?s.delValue(t):s.setValue(t,e),Ar=s=>t=>Xf(Mr(t),(e,o)=>e+s(o),0),pr=s=>(s==null?void 0:s.size)??0,qc=Ar(pr),sn=Ar(qc),Wi=Ar(sn),ps=(s,t)=>(s==null?void 0:s.has(t))??!1,Q=s=>Vs(s)||pr(s)==0,Mr=s=>[...(s==null?void 0:s.values())??[]],yo=s=>s.clear(),B=(s,t)=>s==null?void 0:s.forEach(t),de=(s,t)=>s==null?void 0:s.delete(t),be=Object,wa=s=>be.getPrototypeOf(s),Eu=be.entries,Of=be.isFrozen,Rc=s=>!Vs(s)&&ms(wa(s),t=>t==be.prototype||Vs(wa(t)),()=>!0),If=be.keys,Vu=be.freeze,sT=(s=[])=>be.fromEntries(s),Lo=(s,t)=>t in s,bu=(s,t)=>(delete s[t],s),tT=(s,t)=>It(Eu(s),([e,o])=>t(o,e)),eT=(s,t)=>Po(Eu(s),([e,o])=>t(o,e)),ae=(s,t)=>sT(eT(s,(e,o)=>[o,t(e,o)])),nT=s=>Dt(If(s)),wt=s=>Rc(s)&&nT(s)==0,ie=(s,t,e,o=0)=>Vs(s)||!Rc(s)||!o&&wt(s)||Of(s)?(e==null||e(),!1):(tT(s,(c,a)=>{t(c,a)||bu(s,a)}),o?!0:!wt(s)),F=s=>new Map(s),ze=s=>[...(s==null?void 0:s.keys())??[]],x=(s,t)=>s==null?void 0:s.get(t),st=(s,t)=>B(s,(e,o)=>t(o,e)),oT=(s,t)=>Po([...(s==null?void 0:s.entries())??[]],([e,o])=>t(o,e)),W=(s,t,e)=>Vs(e)?(de(s,t),s):s==null?void 0:s.set(t,e),ks=(s,t,e,o)=>(ps(s,t)?o==null||o(x(s,t)):W(s,t,e()),x(s,t)),Fe=(s,t,e,o=W)=>(ae(t,(c,a)=>e(s,a,c)),st(s,c=>Lo(t,c)?0:o(s,c)),s),Zs=(s,t,e,o)=>{const c={};return B(s,(a,u)=>{if(!(e!=null&&e(a,u))){const f=t?t(a,u):a;o!=null&&o(f)||(c[u]=f)}}),c},or=(s,t,e)=>Zs(s,o=>Zs(o,t,e),Q,wt),qo=(s,t,e)=>Zs(s,o=>or(o,t,e),Q,wt),ue=(s,t)=>{const e=F();return B(s,(o,c)=>e.set(c,(t==null?void 0:t(o))??o)),e},cr=s=>ue(s,ue),Qi=s=>ue(s,cr),ir=(s,t,e,o,c=0)=>ms((e?ks:x)(s,t[c],c>Dt(t)-2?e:F),a=>{if(c>Dt(t)-2)return o!=null&&o(a)&&W(s,t[c]),a;const u=ir(a,t,e,o,c+1);return Q(a)&&W(s,t[c]),u}),it=s=>new Set(un(s)||Vs(s)?s:[s]),tt=(s,t)=>s==null?void 0:s.add(t),cT=(s,t,e,o,c)=>{const a=s.hasRow,u=F(),f=F(),C=F(),S=F(),T=F(),h=F(),y=()=>s,w=()=>ze(u),E=_=>st(f,_),V=_=>ps(f,_),m=_=>x(u,_),P=_=>x(f,_),b=(_,I)=>W(f,_,I),ls=(_,I,...us)=>{const ns=ks(h,_,it);return It(us,N=>tt(ns,N)&&I&&s.callListener(N)),us},Rs=(_,...I)=>ms(x(h,_),us=>{It(Kf(I)?Mr(us):I,ns=>{s.delListener(ns),de(us,ns)}),Q(us)&&W(h,_)}),Ss=(_,I)=>{W(u,_,I),ps(f,_)||(W(f,_,t()),W(S,_,F()),W(T,_,F()),c(C))},O=(_,I,us,ns,N)=>{Ss(_,I);const ss=F(),os=F(),cs=x(S,_),es=x(T,_),bs=J=>{const fs=Ts=>s.getCell(I,J,Ts),hs=x(cs,J),Ns=a(I,J)?e(ns(fs,J)):void 0;if(hs===Ns||un(hs)&&un(Ns)&&wu(hs,Ns)||W(ss,J,[hs,Ns]),!Vs(N)){const Ts=x(es,J),Qs=a(I,J)?N(fs,J):void 0;Ts!=Qs&&W(os,J,Qs)}},Es=J=>{us(()=>{B(ss,([,fs],hs)=>W(cs,hs,fs)),B(os,(fs,hs)=>W(es,hs,fs))},ss,os,cs,es,J),yo(ss),yo(os)};st(cs,bs),s.hasTable(I)&&It(s.getRowIds(I),J=>{ps(cs,J)||bs(J)}),Es(!0),Rs(_),ls(_,0,s.addRowListener(I,null,(J,fs,hs)=>bs(hs)),s.addTableListener(I,()=>Es()))},j=_=>{W(u,_),W(f,_),W(S,_),W(T,_),Rs(_),c(C)};return[y,w,E,V,m,P,b,Ss,O,j,_=>o(_,C),()=>st(h,j),ls,Rs]},Ea=(s,t)=>Jf(s)?e=>e(s):s??(()=>t??Ce),iT=(s,t)=>{const e=new WeakMap;return o=>{e.has(o)||e.set(o,s(o));const c=e.get(o);return t==null||t(c),c}},rT=/^\d+$/,ju=()=>{const s=[];let t=0;return[e=>(e?Zf(s):null)??Ce+t++,e=>{Yf(rT,e)&&Dt(s)<1e3&&hc(s,e)}]},aT=(s,t=[Ce])=>{const e=[],o=(c,a)=>a==Dt(t)?hc(e,c):t[a]===null?B(c,u=>o(u,a+1)):It([t[a],null],u=>o(x(c,u),a+1));return o(s,0),e},xu=s=>{let t;const[e,o]=ju(),c=F();return[(S,T,h,y=[],w=()=>[])=>{t??(t=s());const E=e(1);return W(c,E,[S,T,h,y,w]),tt(ir(T,h??[Ce],it),E),E},(S,T,...h)=>It(aT(S,T),y=>B(y,w=>x(c,w)[0](t,...T??[],...h))),S=>ms(x(c,S),([,T,h])=>(ir(T,h??[Ce],void 0,y=>(de(y,S),Q(y)?1:0)),W(c,S),o(S),h)),S=>ms(x(c,S),([T,,h=[],y,w])=>{const E=(...V)=>{var P;const m=Dt(V);m==Dt(h)?T(t,...V,...w(V)):Vs(h[m])?It(((P=y[m])==null?void 0:P.call(y,...V))??[],b=>E(...V,b)):E(...V,h[m])};E()})]},Pu=(s,t)=>(s??0)<(t??0)?-1:1,UT=iT(s=>{const t=F(),e=F(),[o,c,a]=xu(()=>ns),[u,f,C,S,T,h,y,,w,E,V,m]=cT(s,F,N=>Vs(N)?Ce:un(N)?Po(N,ds):ds(N),o,c),P=(N,ss)=>ps(h(N),ss),b=(N,ss,os,cs,es,bs=Pu)=>{const Es=Vs(es)?void 0:([J],[fs])=>es(J,fs);return w(N,ss,(J,fs,hs,Ns,Ts,Qs)=>{let Fs=0;const Us=it(),k=it(),R=h(N);if(B(fs,([p,Y],ys)=>{const H=it(p),ee=it(Y);B(H,Bs=>de(ee,Bs)?de(H,Bs):0),B(H,Bs=>{tt(Us,Bs),ms(x(R,Bs),Ke=>{de(Ke,ys),Q(Ke)&&(W(R,Bs),Fs=1)})}),B(ee,Bs=>{tt(Us,Bs),ps(R,Bs)||(W(R,Bs,it()),Fs=1),tt(x(R,Bs),ys),Vs(cs)||tt(k,Bs)})}),J(),Q(Ts)||(Qs?st(R,p=>tt(k,p)):st(hs,p=>ms(x(Ns,p),Y=>It(un(Y)?Y:[Y],ys=>tt(k,ys)))),B(k,p=>{const Y=(H,ee)=>bs(x(Ts,H),x(Ts,ee),p),ys=[...x(R,p)];Ra(ys,Y)||(W(R,p,it(nr(ys,Y))),tt(Us,p))})),(Fs||Qs)&&!Vs(Es)){const p=[...R];Ra(p,Es)||(y(N,F(nr(p,Es))),Fs=1)}Fs&&c(t,[N]),B(Us,p=>c(e,[N,p]))},Ea(os),ms(cs,Ea)),ns},ls=N=>C((ss,os)=>N(ss,cs=>Ss(ss,cs,os))),Rs=(N,ss)=>Ss(N,ss,h(N)),Ss=(N,ss,os)=>{const cs=T(N);B(os,(es,bs)=>ss(bs,Es=>B(es,J=>Es(J,fs=>s.forEachCell(cs,J,fs)))))},ns={setIndexDefinition:b,delIndexDefinition:N=>(E(N),ns),getStore:u,getIndexIds:f,forEachIndex:ls,forEachSlice:Rs,hasIndex:S,hasSlice:P,getTableId:T,getSliceIds:N=>ze(h(N)),getSliceRowIds:(N,ss)=>Mr(x(h(N),ss)),addIndexIdsListener:V,addSliceIdsListener:(N,ss)=>o(ss,t,[N]),addSliceRowIdsListener:(N,ss,os)=>o(os,e,[N,ss]),delListener:N=>(a(N),ns),destroy:m,getListenerStats:()=>({sliceIds:qc(t),sliceRowIds:sn(e)})};return Vu(ns)}),lT=JSON.stringify,Bi=JSON.parse,Xe=s=>lT(s,(t,e)=>Gf(e,Map)?be.fromEntries([...e]):e),Ko=s=>[s,s],Ps=(s,t=qc)=>t(s[0])+t(s[1]),Ds=()=>[F(),F()],Va=s=>[...s],Xo=([s,t])=>s===t,uo=(s,t,e)=>W(s,t,x(s,t)==-e?void 0:e),uT=()=>{let s,t,e=!1,o=!1,c=0,a=[];const u=F(),f=F(),C=F(),S=F(),T=F(),h=F(),y=F(),w=F(),E=F(),V=F(),m=F(),P=F(),b=F(),ls=F(),Rs=it(),Ss=F(),O=F(),j=F(),M=F(),K=Ds(),_=Ds(),I=Ds(),us=Ds(),ns=Ds(),N=Ds(),ss=Ds(),os=Ds(),cs=Ds(),es=Ds(),bs=Ds(),Es=Ds(),J=Ds(),fs=Ds(),hs=Ds(),Ns=Ds(),Ts=Ds(),Qs=Ds(),Fs=Ds(),Us=Ds(),k=Ds(),R=Ds(),p=F(),Y=Ds(),[ys,H,ee,Bs]=xu(()=>rs),Ke=n=>ie(n,i=>ie(i,Tn)),Xc=n=>ie(n,Tn),Tn=n=>{if(!ie(n,(r,l)=>qf([Yo,Me],l)))return!1;const i=n[Yo];return!yu(i)&&i!=Ru?!1:(lo(n[Me])!=i&&bu(n,Me),!0)},Zc=un,Oc=n=>ie(n,Cn,Hs),Cn=(n,i)=>(!s||ps(m,i)||Hs(i))&&ie(n,(r,l)=>At(i,l,r),()=>Hs(i)),At=(n,i,r,l)=>ie(l?r:yn(r,n,i),(d,$)=>ms(Ln(n,i,$,d),g=>(r[$]=g,!0),()=>!1),()=>Hs(n,i)),Ln=(n,i,r,l)=>s?ms(x(x(m,n),r),d=>lo(l)!=d[Yo]?Hs(n,i,r,l,d[Me]):l,()=>Hs(n,i,r,l)):Vs(lo(l))?Hs(n,i,r,l):l,hn=(n,i)=>ie(i?n:Ic(n),(r,l)=>ms(Rn(l,r),d=>(n[l]=d,!0),()=>!1),()=>ut()),Rn=(n,i)=>t?ms(x(b,n),r=>lo(i)!=r[Yo]?ut(n,i,r[Me]):i,()=>ut(n,i)):Vs(lo(i))?ut(n,i):i,yn=(n,i,r)=>(ms(x(P,i),([l,d])=>{B(l,($,g)=>{Lo(n,g)||(n[g]=$)}),B(d,$=>{Lo(n,$)||Hs(i,r,$)})}),n),Ic=n=>(t&&(B(ls,(i,r)=>{Lo(n,r)||(n[r]=i)}),B(Rs,i=>{Lo(n,i)||ut(i)})),n),gn=n=>Fe(m,n,(i,r,l)=>{const d=F(),$=it();Fe(ks(m,r,F),l,(g,D,A)=>{W(g,D,A),ms(A[Me],Cs=>W(d,D,Cs),()=>tt($,D))}),W(P,r,[d,$])},(i,r)=>{W(m,r),W(P,r)}),wn=n=>Fe(b,n,(i,r,l)=>{W(b,r,l),ms(l[Me],d=>W(ls,r,d),()=>tt(Rs,r))},(i,r)=>{W(b,r),W(ls,r),de(Rs,r)}),En=n=>wt(n)?Gt():Qt(n),si=([n,i])=>{(wt(n)?Gt:Qt)(n),(wt(i)?Jt:Bt)(i)},Vn=n=>Fe(j,n,(i,r,l)=>pt(r,l),(i,r)=>Pn(r)),pt=(n,i)=>Fe(ks(j,n,()=>(vn(n,1),W(Ss,n,ju()),W(O,n,F()),F())),i,(r,l,d)=>lt(n,r,l,d),(r,l)=>Dn(n,r,l)),lt=(n,i,r,l,d)=>Fe(ks(i,r,()=>(An(n,r,1),F())),l,($,g,D)=>je(n,r,$,g,D),($,g)=>mn(n,i,r,$,g,d)),je=(n,i,r,l,d)=>{ps(r,l)||pn(n,i,l,1);const $=x(r,l);d!==$&&(Mn(n,i,l,$,d),W(r,l,d))},bn=(n,i,r,l,d)=>ms(x(i,r),$=>je(n,r,$,l,d),()=>lt(n,i,r,yn({[l]:d},n,r))),jn=n=>wt(n)?Jt():Bt(n),xn=n=>Fe(M,n,(i,r,l)=>Mt(r,l),(i,r)=>Nn(r)),Mt=(n,i)=>{ps(M,n)||_n(n,1);const r=x(M,n);i!==r&&(Fn(n,r,i),W(M,n,i))},ti=(n,i)=>{const[r]=x(Ss,n);let l;do l=r(i);while(ps(x(j,n),l));return l},_t=n=>x(j,n)??pt(n,{}),Pn=n=>pt(n,{}),Dn=(n,i,r)=>{const[,l]=x(Ss,n);l(r),lt(n,i,r,{},!0)},mn=(n,i,r,l,d,$)=>{var A;const g=x((A=x(P,n))==null?void 0:A[0],d);if(!Vs(g)&&!$)return je(n,r,l,d,g);const D=Cs=>{Mn(n,r,Cs,x(l,Cs)),pn(n,r,Cs,-1),W(l,Cs)};Vs(g)?D(d):st(l,D),Q(l)&&(An(n,r,-1),Q(W(i,r))&&(vn(n,-1),W(j,n),W(Ss,n),W(O,n)))},Nn=n=>{const i=x(ls,n);if(!Vs(i))return Mt(n,i);Fn(n,x(M,n)),_n(n,-1),W(M,n)},vn=(n,i)=>uo(u,n,i),An=(n,i,r)=>uo(ks(S,n,F),i,r)&&W(C,n,ks(C,n,()=>0)+r),pn=(n,i,r,l)=>{const d=x(O,n),$=x(d,r)??0;($==0&&l==1||$==1&&l==-1)&&uo(ks(f,n,F),r,l),W(d,r,$!=-l?$+l:null),uo(ks(ks(T,n,F),i,F),r,l)},Mn=(n,i,r,l,d)=>{var $;ks(ks(ks(h,n,F),i,F),r,()=>[l,0])[1]=d,($=a[3])==null||$.call(a,n,i,r,d)},_n=(n,i)=>uo(y,n,i),Fn=(n,i,r)=>{var l;ks(w,n,()=>[i,0])[1]=r,(l=a[4])==null||l.call(a,n,r)},Hs=(n,i,r,l,d)=>(hc(ks(ks(ks(E,n,F),i,F),r,()=>[]),l),d),ut=(n,i,r)=>(hc(ks(V,n,()=>[]),i),r),Ft=(n,i,r)=>ms(x(x(x(h,n),i),r),([l,d])=>[!0,l,d],()=>[!1,...Ko(zt(n,i,r))]),kn=n=>ms(x(w,n),([i,r])=>[!0,i,r],()=>[!1,...Ko(Ut(n))]),zn=n=>!Q(E)&&!Q(Ns[n])?B(n?Qi(E):E,(i,r)=>B(i,(l,d)=>B(l,($,g)=>H(Ns[n],[r,d,g],$)))):0,Un=n=>!Q(V)&&!Q(Ts[n])?B(n?ue(V):V,(i,r)=>H(Ts[n],[r],i)):0,dt=(n,i,r,l)=>{if(!Q(n))return H(i,l,()=>Zs(n)),st(n,(d,$)=>H(r,[...l??[],d],$==1)),1},Hn=n=>{const i=Ht();i!=e&&H(K[n],void 0,i);const r=Q(es[n]),l=Q(J[n])&&Q(fs[n])&&Q(cs[n])&&Q(bs[n])&&Q(N[n])&&Q(ss[n])&&Q(os[n])&&r&&Q(I[n])&&Q(us[n]),d=Q(hs[n])&&Q(Es[n])&&Q(ns[n])&&Q(_[n]);if(!l||!d){const $=n?[ue(u),cr(f),ue(C),cr(S),Qi(T),Qi(h)]:[u,f,C,S,T,h];if(!l){dt($[0],I[n],us[n]),B($[1],(D,A)=>dt(D,N[n],ss[n],[A])),B($[2],(D,A)=>{D!=0&&H(os[n],[A],Gn(A))});const g=it();B($[3],(D,A)=>{dt(D,cs[n],bs[n],[A])&&!r&&(H(es[n],[A,null]),tt(g,A))}),r||B($[5],(D,A)=>{if(!ps(g,A)){const Cs=it();B(D,Ws=>B(Ws,([Yt,qt],St)=>qt!==Yt?tt(Cs,St):de(Ws,St))),B(Cs,Ws=>H(es[n],[A,Ws]))}}),B($[4],(D,A)=>B(D,(Cs,Ws)=>dt(Cs,J[n],fs[n],[A,Ws])))}if(!d){let g;B($[5],(D,A)=>{let Cs;B(D,(Ws,Yt)=>{let qt;B(Ws,([St,co],Pi)=>{co!==St&&(H(hs[n],[A,Yt,Pi],co,St,Ft),g=Cs=qt=1)}),qt&&H(Es[n],[A,Yt],Ft)}),Cs&&H(ns[n],[A],Ft)}),g&&H(_[n],void 0,Ft)}}},Wn=n=>{const i=Wt();i!=o&&H(Qs[n],void 0,i);const r=Q(Us[n])&&Q(k[n]),l=Q(R[n])&&Q(Fs[n]);if(!r||!l){const d=n?[ue(y),ue(w)]:[y,w];if(r||dt(d[0],Us[n],k[n]),!l){let $;B(d[1],([g,D],A)=>{D!==g&&(H(R[n],[A],D,g,kn),$=1)}),$&&H(Fs[n],void 0,kn)}}},z=(n,...i)=>(ve(()=>n(...Po(i,ds))),rs),Qn=(n,i,r,l,d)=>{let $=kt(n,i,...r);return ys(()=>{const g=kt(n,i,...r);wu(g,$)||($=g,l(rs,n,i,...r,$))},es[d?1:0],[n,i],[gs])},ei=()=>[xe(),De()],xe=()=>qo(j),gs=()=>ze(j),ni=n=>or(x(j,ds(n))),Bn=n=>ze(x(O,ds(n))),Gn=n=>pr(x(j,ds(n))),Is=n=>ze(x(j,ds(n))),kt=(n,i,r,l=0,d)=>Rc(n)?kt(n.tableId,n.cellId,n.descending,n.offset,n.limit):Po(ha(nr(oT(x(j,ds(n)),($,g)=>[Vs(i)?g:x($,ds(i)),g]),([$],[g])=>Pu($,g)*(r?-1:1)),l,Vs(d)?d:l+d),([,$])=>$),oi=(n,i)=>Zs(x(x(j,ds(n)),ds(i))),Pe=(n,i)=>ze(x(x(j,ds(n)),ds(i))),zt=(n,i,r)=>x(x(x(j,ds(n)),ds(i)),ds(r)),De=()=>Zs(M),me=()=>ze(M),Ut=n=>x(M,ds(n)),Ht=()=>!Q(j),Jn=n=>ps(j,ds(n)),Yn=(n,i)=>ps(x(O,ds(n)),ds(i)),qn=(n,i)=>ps(x(j,ds(n)),ds(i)),Kn=(n,i,r)=>ps(x(x(j,ds(n)),ds(i)),ds(r)),Wt=()=>!Q(M),Xn=n=>ps(M,ds(n)),ci=()=>Xe(j),ii=()=>Xe(M),ri=()=>Xe([j,M]),ai=()=>Xe(m),li=()=>Xe(b),ui=()=>Xe([m,b]),di=n=>z(()=>{const i=Ui(n)?n():n;Zc(i)&&si(i)}),Qt=n=>z(()=>Oc(n)?Vn(n):0),Si=(n,i)=>z(r=>Cn(i,r)?pt(r,i):0,n),$i=(n,i,r)=>z((l,d)=>At(l,d,r)?lt(l,_t(l),d,r):0,n,i),fi=(n,i,r=!0)=>ve(()=>{let l;return At(n,l,i)&&(n=ds(n),lt(n,_t(n),l=ti(n,r?1:0),i)),l}),Ti=(n,i,r)=>z((l,d)=>{if(At(l,d,r,1)){const $=_t(l);ae(r,(g,D)=>bn(l,$,d,D,g))}},n,i),Ci=(n,i,r,l)=>z((d,$,g)=>ms(Ln(d,$,g,Ui(l)?l(zt(d,$,g)):l),D=>bn(d,_t(d),$,g,D)),n,i,r),Bt=n=>z(()=>hn(n)?xn(n):0),Li=n=>z(()=>hn(n,1)?ae(n,(i,r)=>Mt(r,i)):0),hi=(n,i)=>z(r=>ms(Rn(r,Ui(i)?i(Ut(r)):i),l=>Mt(r,l)),n),Ri=n=>z(()=>{ae(n[0],(i,r)=>Vs(i)?so(r):ae(i,(l,d)=>Vs(l)?to(r,d):ae(l,($,g)=>ya(rs,r,d,g,$)))),ae(n[1],(i,r)=>ga(rs,r,i))}),Zn=n=>(Hi(()=>En(Bi(n))),rs),yi=n=>(Hi(()=>jn(Bi(n))),rs),gi=n=>z(()=>Hi(()=>{const[i,r]=Bi(n);En(i),jn(r)},()=>Zn(n))),On=n=>z(()=>{if((s=Ke(n))&&(gn(n),!Q(j))){const i=xe();Gt(),Qt(i)}}),In=n=>z(()=>{if(t=Xc(n)){const i=De();Ne(),Jt(),t=!0,wn(n),Bt(i)}}),wi=(n,i)=>z(()=>{On(n),In(i)}),Gt=()=>z(()=>Vn({})),so=n=>z(i=>ps(j,i)?Pn(i):0,n),to=(n,i)=>z((r,l)=>ms(x(j,r),d=>ps(d,l)?Dn(r,d,l):0),n,i),Ei=(n,i,r,l)=>z((d,$,g)=>ms(x(j,d),D=>ms(x(D,$),A=>ps(A,g)?mn(d,D,$,A,g,l):0)),n,i,r),Jt=()=>z(()=>xn({})),Vi=n=>z(i=>ps(M,i)?Nn(i):0,n),eo=()=>z(()=>{gn({}),s=!1}),Ne=()=>z(()=>{wn({}),t=!1}),bi=()=>z(()=>{eo(),Ne()}),ve=(n,i)=>{if(c!=-1){no();const r=n();return oo(i),r}},no=()=>{var n;return c!=-1&&c++,c==1&&((n=a[0])==null||n.call(a),H(p)),rs},ji=()=>[Zs(h,(n,i)=>x(u,i)===-1?void 0:Zs(n,(r,l)=>x(x(S,i),l)===-1?void 0:Zs(r,([,d])=>d,d=>Xo(d)),Q,wt),Q,wt),Zs(w,([,n])=>n,n=>Xo(n)),1],xi=()=>[!Q(h),!Q(w),qo(h,Va,Xo),qo(E),Zs(w,Va,Xo),Zs(V),Zs(u),or(S),qo(T),Zs(y)],oo=n=>{var i,r;return c>0&&(c--,c==0&&(c=1,zn(1),Q(h)||Hn(1),Un(1),Q(w)||Wn(1),n!=null&&n(rs)&&(B(h,(l,d)=>B(l,($,g)=>B($,([D],A)=>ya(rs,d,g,A,D)))),yo(h),B(w,([l],d)=>ga(rs,d,l)),yo(w)),H(Y[0],void 0),c=-1,zn(0),Q(h)||Hn(0),Un(0),Q(w)||Wn(0),(i=a[1])==null||i.call(a),H(Y[1],void 0),(r=a[2])==null||r.call(a),c=0,e=Ht(),o=Wt(),It([u,f,C,S,T,h,E,y,w,V],yo))),rs},rs={getContent:ei,getTables:xe,getTableIds:gs,getTable:ni,getTableCellIds:Bn,getRowCount:Gn,getRowIds:Is,getSortedRowIds:kt,getRow:oi,getCellIds:Pe,getCell:zt,getValues:De,getValueIds:me,getValue:Ut,hasTables:Ht,hasTable:Jn,hasTableCell:Yn,hasRow:qn,hasCell:Kn,hasValues:Wt,hasValue:Xn,getTablesJson:ci,getValuesJson:ii,getJson:ri,getTablesSchemaJson:ai,getValuesSchemaJson:li,getSchemaJson:ui,hasTablesSchema:()=>s,hasValuesSchema:()=>t,setContent:di,setTables:Qt,setTable:Si,setRow:$i,addRow:fi,setPartialRow:Ti,setCell:Ci,setValues:Bt,setPartialValues:Li,setValue:hi,applyChanges:Ri,setTablesJson:Zn,setValuesJson:yi,setJson:gi,setTablesSchema:On,setValuesSchema:In,setSchema:wi,delTables:Gt,delTable:so,delRow:to,delCell:Ei,delValues:Jt,delValue:Vi,delTablesSchema:eo,delValuesSchema:Ne,delSchema:bi,transaction:ve,startTransaction:no,getTransactionChanges:ji,getTransactionLog:xi,finishTransaction:oo,forEachTable:n=>B(j,(i,r)=>n(r,l=>B(i,(d,$)=>l($,g=>st(d,g))))),forEachTableCell:(n,i)=>st(x(O,ds(n)),i),forEachRow:(n,i)=>B(x(j,ds(n)),(r,l)=>i(l,d=>st(r,d))),forEachCell:(n,i,r)=>st(x(x(j,ds(n)),ds(i)),r),forEachValue:n=>st(M,n),addSortedRowIdsListener:(n,i,r,l,d,$,g)=>Rc(n)?Qn(n.tableId,n.cellId,[n.descending??!1,n.offset??0,n.limit],i,r):Qn(n,i,[r,l,d],$,g),addStartTransactionListener:n=>ys(n,p),addWillFinishTransactionListener:n=>ys(n,Y[0]),addDidFinishTransactionListener:n=>ys(n,Y[1]),callListener:n=>(Bs(n),rs),delListener:n=>(ee(n),rs),getListenerStats:()=>({hasTables:Ps(K),tables:Ps(_),tableIds:Ps(I),hasTable:Ps(us),table:Ps(ns),tableCellIds:Ps(N),hasTableCell:Ps(ss,sn),rowCount:Ps(os),rowIds:Ps(cs),sortedRowIds:Ps(es),hasRow:Ps(bs,sn),row:Ps(Es,sn),cellIds:Ps(J,sn),hasCell:Ps(fs,Wi),cell:Ps(hs,Wi),invalidCell:Ps(Ns,Wi),hasValues:Ps(Qs),values:Ps(Fs),valueIds:Ps(Us),hasValue:Ps(k),value:Ps(R),invalidValue:Ps(Ts),transaction:qc(p)+Ps(Y)}),isMergeable:()=>!1,createStore:uT,addListener:ys,callListeners:H,setInternalListeners:(n,i,r,l,d)=>a=[n,i,r,l,d]};return ae({[_e+Ta]:[0,K,[],()=>[Ht()]],[Ta]:[0,_],[Uf]:[0,I],[_e+Ie]:[1,us,[gs],n=>[Jn(...n)]],[Ie]:[1,ns,[gs]],[Ie+Ca]:[1,N,[gs]],[_e+Ie+sc]:[2,ss,[gs,Bn],n=>[Yn(...n)]],[Hf]:[1,os,[gs]],[Wf]:[1,cs,[gs]],[_e+Cc]:[2,bs,[gs,Is],n=>[qn(...n)]],[Cc]:[2,Es,[gs,Is]],[Ca]:[2,J,[gs,Is]],[_e+sc]:[3,fs,[gs,Is,Pe],n=>[Kn(...n)]],[sc]:[3,hs,[gs,Is,Pe],n=>Ko(zt(...n))],InvalidCell:[3,Ns],[_e+La]:[0,Qs,[],()=>[Wt()]],[La]:[0,Fs],[Qf]:[0,Us],[_e+Lc]:[1,k,[me],n=>[Xn(...n)]],[Lc]:[1,R,[me],n=>Ko(Ut(n[0]))],InvalidValue:[1,Ts]},([n,i,r,l],d)=>{rs[zf+d+kf]=(...$)=>ys($[n],i[$[n+1]?1:0],n>0?ha($,0,n):void 0,r,l)}),Vu(rs)},yc="",jt=s=>s==null,gc=(s,t,e)=>jt(s)?e==null?void 0:e():t(s),rr=s=>Array.isArray(s),Ge=s=>s.length,dT=(s,t)=>s.test(t),Du=s=>{throw new Error(s)},So=async(s,t,e)=>{try{return await s()}catch(o){t==null||t(o)}},ar=(s,t)=>s.forEach(t),ST=(s,t)=>s.splice(0,t),_r=(s,...t)=>s.push(...t),mu=s=>s.shift(),$T=s=>(s==null?void 0:s.size)??0,fT=(s,t)=>(s==null?void 0:s.has(t))??!1,Nu=s=>jt(s)||$T(s)==0,vu=(s,t)=>s==null?void 0:s.forEach(t),Au=(s,t)=>s==null?void 0:s.delete(t),Kc=Object,ba=s=>Kc.getPrototypeOf(s),TT=s=>!jt(s)&&gc(ba(s),t=>t==Kc.prototype||jt(ba(t)),()=>!0),CT=Kc.keys,LT=Kc.freeze,hT=s=>Ge(CT(s)),Zo=s=>TT(s)&&hT(s)==0,Fo=s=>new Map(s),ft=(s,t)=>s==null?void 0:s.get(t),Je=(s,t,e)=>jt(e)?(Au(s,t),s):s==null?void 0:s.set(t,e),lr=(s,t,e,o)=>(fT(s,t)?o==null||o(ft(s,t)):Je(s,t,e()),ft(s,t)),ur=(s,t,e,o,c=0)=>gc((e?lr:ft)(s,t[c],c>Ge(t)-2?e:Fo),a=>{if(c>Ge(t)-2)return o!=null&&o(a)&&Je(s,t[c]),a;const u=ur(a,t,e,o,c+1);return Nu(a)&&Je(s,t[c]),u}),RT=/^\d+$/,yT=()=>{const s=[];let t=0;return[e=>(e?mu(s):null)??yc+t++,e=>{dT(RT,e)&&Ge(s)<1e3&&_r(s,e)}]},gT=s=>new Set(rr(s)||jt(s)?s:[s]),wT=(s,t)=>s==null?void 0:s.add(t),ET=(s,t=[yc])=>{const e=[],o=(c,a)=>a==Ge(t)?_r(e,c):t[a]===null?vu(c,u=>o(u,a+1)):ar([t[a],null],u=>o(ft(c,u),a+1));return o(s,0),e},VT=s=>{let t;const[e,o]=yT(),c=Fo();return[(S,T,h,y=[],w=()=>[])=>{t??(t=s());const E=e(1);return Je(c,E,[S,T,h,y,w]),wT(ur(T,h??[yc],gT),E),E},(S,T,...h)=>ar(ET(S,T),y=>vu(y,w=>ft(c,w)[0](t,...T??[],...h))),S=>gc(ft(c,S),([,T,h])=>(ur(T,h??[yc],void 0,y=>(Au(y,S),Nu(y)?1:0)),Je(c,S),o(S),h)),S=>gc(ft(c,S),([T,,h=[],y,w])=>{const E=(...V)=>{var P;const m=Ge(V);m==Ge(h)?T(t,...V,...w(V)):jt(h[m])?ar(((P=y[m])==null?void 0:P.call(y,...V))??[],b=>E(...V,b)):E(...V,h[m])};E()})]},Oo=Fo(),Io=Fo(),bT=(s=1,t,e)=>s!=1&&t.isMergeable()?[1,t.getMergeableContent,()=>t.getTransactionMergeableChanges(!e),([[o],[c]])=>!Zo(o)||!Zo(c),t.setDefaultContent]:s!=2?[0,t.getContent,t.getTransactionChanges,([o,c])=>!Zo(o)||!Zo(c),t.setContent]:Du("Store type not supported by this Persister"),HT=(s,t,e,o,c,a,u,f={},C=0,S=[])=>{let T=0,h=0,y=0,w,E,V;lr(Oo,S,()=>0),lr(Io,S,()=>[]);const m=Fo(),[P,b,ls,Rs,Ss]=bT(u,s,C),[O,j,M]=VT(()=>k),K=R=>{R!=T&&(T=R,j(m,void 0,T))},_=async()=>{if(!ft(Oo,S)){for(Je(Oo,S,1);!jt(w=mu(ft(Io,S)));)await So(w,a);Je(Oo,S,0)}},I=R=>{(P&&rr(R==null?void 0:R[0])?(R==null?void 0:R[2])===1?s.applyMergeableChanges:s.setMergeableContent:(R==null?void 0:R[2])===1?s.applyChanges:s.setContent)(R)},us=async R=>(T!=2&&(K(1),h++,await Ts(async()=>{await So(async()=>{const p=await t();rr(p)?I(p):R?Ss(R):Du(`Content is not an array: ${p}`)},()=>{R&&Ss(R)}),K(0)})),k),ns=async R=>(N(),await us(R),await So(async()=>E=await o(async(p,Y)=>{Y||p?T!=2&&(K(1),h++,I(Y??p),K(0)):await us()}),a),k),N=async()=>(E&&(await So(()=>c(E),a),E=void 0),k),ss=()=>!jt(E),os=async R=>(T!=1&&(K(2),y++,await Ts(async()=>{await So(()=>e(b,R),a),K(0)})),k),cs=async()=>(es(),await os(),V=s.addDidFinishTransactionListener(()=>{const R=ls();Rs(R)&&os(R)}),k),es=async()=>(V&&(s.delListener(V),V=void 0),k),bs=()=>!jt(V),Es=async(R,p=!1)=>{const[Y,ys]=p?[cs,ns]:[ns,cs];return await Y(R),await ys(R),k},J=async(R=!1)=>{const[p,Y]=R?[es,N]:[N,es];return await p(),await Y(),k},fs=()=>T,hs=R=>O(R,m),Ns=R=>(M(R),s),Ts=async(...R)=>(_r(ft(Io,S),...R),await _(),k),k={load:us,startAutoLoad:ns,stopAutoLoad:N,isAutoLoading:ss,save:os,startAutoSave:cs,stopAutoSave:es,isAutoSaving:bs,startAutoPersisting:Es,stopAutoPersisting:J,getStatus:fs,addStatusListener:hs,delListener:Ns,schedule:Ts,getStore:()=>s,destroy:()=>(ST(ft(Io,S)),J()),getStats:()=>({loads:h,saves:y}),...f};return LT(k)};export{MT as I,mT as P,FT as U,kT as a,HT as b,uT as c,zT as d,UT as e};
