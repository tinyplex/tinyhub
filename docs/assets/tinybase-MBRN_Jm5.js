var iu=Object.defineProperty;var ru=(s,t,n)=>t in s?iu(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var $r=(s,t,n)=>ru(s,typeof t!="symbol"?t+"":t,n);import{R as oa,j as T}from"./react-BQ31-a3F.js";const fo=s=>typeof s,au="tinybase",ct="",lu=fo(ct),uu=fo(fo),fu="Listener",Js="Result",du="get",hu="set",Su="add",Tu="del",fe="Has",Lu="has",st="Ids",Qs="Table",nn=Qs+"s",ca=Qs+st,tt="Row",rc=tt+"Count",Pt=tt+st,ac="Sorted"+tt+st,St="Cell",de=St+st,he="Value",Ue=he+"s",ia=he+st,Hi="Transaction",ra="Partial",aa="Finish",lc="Status",Ui="Metric",Cu="Index",uc="Slice",gu="Relationship",la="Remote"+tt+"Id",ua="Local",fa="Linked",$u="Query",fc="Checkpoint",li=globalThis,dt=s=>s==null,ht=(s,t,n)=>dt(s)?n==null?void 0:n():t(s),da=s=>fo(s)==lu,Wi=s=>fo(s)==uu,yu=s=>Array.isArray(s),ho=s=>s.length,Xe=()=>{},wu=(s,t)=>et(new Array(s).fill(0),(n,o)=>t(o)),ha=(s,t)=>s.every(t),ui=(s,t)=>ho(s)===ho(t)&&ha(s,(n,o)=>t[o]===n),et=(s,t)=>s.map(t),Ru=s=>ho(s)==0,Eu=(s,t)=>s.filter(t),yr=(s,t,n)=>s.with(t,n),dc=Object,wr=s=>dc.getPrototypeOf(s),Vu=dc.entries,Jo=s=>!dt(s)&&ht(wr(s),t=>t==dc.prototype||dt(wr(t)),()=>!0),Sa=dc.keys,Ta=(s,t)=>ht(s,n=>n[t]),bu=(s,t)=>t in s,ju=(s,t)=>(delete s[t],s),xu=s=>ho(Sa(s)),La=(s,t)=>{const n=Vu(s);return ho(n)===xu(t)&&ha(n,([o,c])=>Jo(c)?Jo(t[o])?La(t[o],c):!1:t[o]===c)},{PureComponent:hh,createContext:Pu,useCallback:bt,useContext:$o,useEffect:Ze,useLayoutEffect:mu,useMemo:Bi,useRef:Du,useState:Oe,useSyncExternalStore:Nu}=oa,Tt=(s,...t)=>dt(s)?{}:s(...t),Ca=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getLocalTableId(t),s==null?void 0:s.getRemoteTableId(t)],vu=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getTableId(t)];var cs=(s=>(s[s.Store=0]="Store",s[s.Metrics=1]="Metrics",s[s.Indexes=2]="Indexes",s[s.Relationships=3]="Relationships",s[s.Queries=4]="Queries",s[s.Checkpoints=5]="Checkpoints",s[s.Persister=6]="Persister",s[s.Synchronizer=7]="Synchronizer",s))(cs||{});const fi=au+"_uirc",Ie=li[fi]?li[fi]:li[fi]=Pu([]),Xt=(s,t)=>{const n=$o(Ie);return dt(s)?n[t*2]:da(s)?Ta(n[t*2+1],s):s},pu=s=>({...$o(Ie)[s*2+1]}),Se=(s,t)=>{const n=Xt(s,t);return dt(s)||da(s)?n:s},Te=(s,t,n)=>{const{16:o,17:c}=$o(Ie);Ze(()=>(o==null||o(n,s,t),()=>c==null?void 0:c(n,s)),[o,s,t,n,c])},Le=s=>Sa($o(Ie)[s*2+1]??{}),ws=[],Rr=[{},[],[ws,void 0,ws],void 0,!1,0],Au=[La,ui,([s,t,n],[o,c,a])=>t===c&&ui(s,o)&&ui(n,a)],Fu=(s,t)=>s===t,yo=(s,t,n=ws)=>{const[,o]=Oe(),[c,a]=Oe();return Ze(()=>{const f=s?t(s):void 0;return a(f),o([]),f==null?void 0:f.destroy},[s,...n]),c},ga=(s,t,...n)=>{var c;const o=(c=s==null?void 0:s[Su+t+fu])==null?void 0:c.call(s,...n);return()=>{var a;return(a=s==null?void 0:s.delListener)==null?void 0:a.call(s,o)}},Q=(s,t,n,o=ws)=>{const c=Du(Rr[n]),a=bt(()=>{var $;const L=(($=t==null?void 0:t[(n==4?Lu:du)+s])==null?void 0:$.call(t,...o))??Rr[n];return(Au[n]??Fu)(L,c.current)?c.current:c.current=L},[t,n,s,...o]),f=bt(L=>ga(t,(n==4?fe:ct)+s,...o,L),[t,n,s,...o]);return Nu(f,a,a)},q=(s,t,n,o=ws,c=ws,...a)=>mu(()=>ga(t,s,...c,n,...a),[t,s,...c,...o,...a]),Ce=(s,t,n,o=ws,c=Xe,a=ws,...f)=>{const L=M(s);return bt($=>ht(L,d=>ht(n($,d),S=>c(d[hu+t](...$a(f,d,$),S),S))),[L,t,...o,...a,...ya(f)])},$a=(s,t,n)=>et(s,o=>Wi(o)?o(n,t):o),ya=s=>Eu(s,t=>!Wi(t)),on=(s,t,n=Xe,o=ws,...c)=>{const a=M(s);return bt(f=>n(a==null?void 0:a[Tu+t](...$a(c,a,f))),[a,t,...o,...ya(c)])},wa=(s,t,n)=>{const o=Ct(s);return bt(()=>o==null?void 0:o[t](n),[o,t,n])},ku=(s,t,n,o,c,a)=>Q(ac,M(a),1,[s,t,n,o,c]),Ra=(s,t,n,o,c,a,f,L,$)=>q(ac,M($),a,f,[s,t,n,o,c],L),Ea=(s,t=ws)=>Bi(s,t),Va=()=>Le(cs.Store),Ji=s=>Xt(s,cs.Store),_u=()=>pu(cs.Store),M=s=>Se(s,cs.Store),Mu=(s,t)=>Te(s,t,cs.Store),zu=(s,t=ws)=>Bi(s,t),Hu=s=>Q(nn,M(s),4,[]),Uu=s=>Q(nn,M(s),0),Qi=s=>Q(ca,M(s),1),Wu=(s,t)=>Q(Qs,M(t),4,[s]),Bu=(s,t)=>Q(Qs,M(t),0,[s]),hc=(s,t)=>Q(Qs+de,M(t),1,[s]),Ju=(s,t,n)=>Q(Qs+St,M(n),4,[s,t]),ba=(s,t)=>Q(rc,M(t),5,[s]),Gi=(s,t)=>Q(Pt,M(t),1,[s]),Yi=(s,t,n,o,c,a)=>ku(...Jo(s)?[s.tableId,s.cellId,s.descending??!1,s.offset??0,s.limit,t]:[s,t,n,o,c,a]),Qu=(s,t,n)=>Q(tt,M(n),4,[s,t]),Gu=(s,t,n)=>Q(tt,M(n),0,[s,t]),ja=(s,t,n)=>Q(de,M(n),1,[s,t]),Yu=(s,t,n,o)=>Q(St,M(o),4,[s,t,n]),We=(s,t,n,o)=>Q(St,M(o),3,[s,t,n]),qu=s=>Q(Ue,M(s),4,[]),xa=s=>Q(Ue,M(s),0),Sc=s=>Q(ia,M(s),1),Ku=(s,t)=>Q(he,M(t),4,[s]),ie=(s,t)=>Q(he,M(t),3,[s]),Xu=(s,t,n,o,c)=>Ce(n,nn,s,t,o,c),Zu=(s,t,n,o,c,a)=>Ce(o,Qs,t,n,c,a,s),Ou=(s,t,n,o,c,a,f)=>Ce(c,tt,n,o,a,f,s,t),Iu=(s,t,n=ws,o,c=Xe,a=ws,f=!0)=>{const L=M(o);return bt($=>ht(L,d=>ht(t($,d),S=>c(d.addRow(Wi(s)?s($,d):s,S,f),d,S))),[L,s,...n,...a,f])},s0=(s,t,n,o,c,a,f)=>Ce(c,ra+tt,n,o,a,f,s,t),wo=(s,t,n,o,c,a,f,L)=>Ce(a,St,o,c,f,L,s,t,n),t0=(s,t,n,o,c)=>Ce(n,Ue,s,t,o,c),e0=(s,t,n,o,c)=>Ce(n,ra+Ue,s,t,o,c),So=(s,t,n,o,c,a)=>Ce(o,he,t,n,c,a,s),n0=(s,t,n)=>on(s,nn,t,n),o0=(s,t,n,o)=>on(t,Qs,n,o,s),c0=(s,t,n,o,c)=>on(n,tt,o,c,s,t),i0=(s,t,n,o,c,a,f)=>on(c,St,a,f,s,t,n,o),r0=(s,t,n)=>on(s,Ue,t,n),a0=(s,t,n,o)=>on(t,he,n,o,s),l0=(s,t,n,o)=>q(fe+nn,M(o),s,t,[],n),u0=(s,t,n,o)=>q(nn,M(o),s,t,ws,n),f0=(s,t,n,o)=>q(ca,M(o),s,t,ws,n),d0=(s,t,n,o,c)=>q(fe+Qs,M(c),t,n,[s],o),h0=(s,t,n,o,c)=>q(Qs,M(c),t,n,[s],o),S0=(s,t,n,o,c)=>q(Qs+de,M(c),t,n,[s],o),T0=(s,t,n,o,c,a)=>q(fe+Qs+St,M(a),n,o,[s,t],c),L0=(s,t,n,o,c)=>q(rc,M(c),t,n,[s],o),C0=(s,t,n,o,c)=>q(Pt,M(c),t,n,[s],o),g0=(s,t,n,o,c,a,f,L,$)=>Ra(...Jo(s)?[s.tableId,s.cellId,s.descending??!1,s.offset??0,s.limit,t,n,o,c]:[s,t,n,o,c,a,f,L,$]),$0=(s,t,n,o,c,a)=>q(fe+tt,M(a),n,o,[s,t],c),y0=(s,t,n,o,c,a)=>q(tt,M(a),n,o,[s,t],c),w0=(s,t,n,o,c,a)=>q(de,M(a),n,o,[s,t],c),R0=(s,t,n,o,c,a,f)=>q(fe+St,M(f),o,c,[s,t,n],a),E0=(s,t,n,o,c,a,f)=>q(St,M(f),o,c,[s,t,n],a),V0=(s,t,n,o)=>q(fe+Ue,M(o),s,t,[],n),b0=(s,t,n,o)=>q(Ue,M(o),s,t,ws,n),j0=(s,t,n,o)=>q(ia,M(o),s,t,ws,n),x0=(s,t,n,o,c)=>q(fe+he,M(c),t,n,[s],o),P0=(s,t,n,o,c)=>q(he,M(c),t,n,[s],o),m0=(s,t,n)=>q("Start"+Hi,M(n),s,t),D0=(s,t,n)=>q("Will"+aa+Hi,M(n),s,t),N0=(s,t,n)=>q("Did"+aa+Hi,M(n),s,t),v0=(s,t,n)=>yo(s,t,n),Pa=()=>Le(cs.Metrics),qi=s=>Xt(s,cs.Metrics),Tc=s=>Se(s,cs.Metrics),p0=(s,t)=>Te(s,t,cs.Metrics),ma=s=>Q(Ui+st,Tc(s),1),Ki=(s,t)=>Q(Ui,Tc(t),3,[s]),A0=(s,t,n,o)=>q(Ui,Tc(o),t,n,[s]),F0=(s,t,n)=>yo(s,t,n),Da=()=>Le(cs.Indexes),Xi=s=>Xt(s,cs.Indexes),ge=s=>Se(s,cs.Indexes),k0=(s,t)=>Te(s,t,cs.Indexes),Zi=(s,t)=>Q(uc+st,ge(t),1,[s]),Na=s=>Q(Cu+st,ge(s),1),Oi=(s,t,n)=>Q(uc+Pt,ge(n),1,[s,t]),_0=(s,t,n,o)=>q(uc+st,ge(o),t,n,[s]),M0=(s,t,n,o,c)=>q(uc+Pt,ge(c),n,o,[s,t]),z0=(s,t,n)=>yo(s,t,n),va=()=>Le(cs.Relationships),Ii=s=>Xt(s,cs.Relationships),Lt=s=>Se(s,cs.Relationships),H0=(s,t)=>Te(s,t,cs.Relationships),pa=s=>Q(gu+st,Lt(s),1),sr=(s,t,n)=>Q(la,Lt(n),3,[s,t]),Aa=(s,t,n)=>Q(ua+Pt,Lt(n),1,[s,t]),Fa=(s,t,n)=>Q(fa+Pt,Lt(n),1,[s,t]),U0=(s,t,n,o,c)=>q(la,Lt(c),n,o,[s,t]),W0=(s,t,n,o,c)=>q(ua+Pt,Lt(c),n,o,[s,t]),B0=(s,t,n,o,c)=>q(fa+Pt,Lt(c),n,o,[s,t]),J0=(s,t,n)=>yo(s,t,n),ka=()=>Le(cs.Queries),tr=s=>Xt(s,cs.Queries),Ms=s=>Se(s,cs.Queries),Q0=(s,t)=>Te(s,t,cs.Queries),_a=s=>Q($u+st,Ms(s),1),G0=(s,t)=>Q(Js+Qs,Ms(t),0,[s]),Ma=(s,t)=>Q(Js+Qs+de,Ms(t),1,[s]),za=(s,t)=>Q(Js+rc,Ms(t),5,[s]),Ha=(s,t)=>Q(Js+Pt,Ms(t),1,[s]),er=(s,t,n,o=0,c,a)=>Q(Js+ac,Ms(a),1,[s,t,n,o,c]),Y0=(s,t,n)=>Q(Js+tt,Ms(n),0,[s,t]),Ua=(s,t,n)=>Q(Js+de,Ms(n),1,[s,t]),Wa=(s,t,n,o)=>Q(Js+St,Ms(o),3,[s,t,n]),q0=(s,t,n,o)=>q(Js+Qs,Ms(o),t,n,[s]),K0=(s,t,n,o)=>q(Js+Qs+de,Ms(o),t,n,[s]),X0=(s,t,n,o)=>q(Js+rc,Ms(o),t,n,[s]),Z0=(s,t,n,o)=>q(Js+Pt,Ms(o),t,n,[s]),O0=(s,t,n,o,c,a,f,L)=>q(Js+ac,Ms(L),a,f,[s,t,n,o,c]),I0=(s,t,n,o,c)=>q(Js+tt,Ms(c),n,o,[s,t]),s1=(s,t,n,o,c)=>q(Js+de,Ms(c),n,o,[s,t]),t1=(s,t,n,o,c,a)=>q(Js+St,Ms(a),o,c,[s,t,n]),e1=(s,t,n)=>yo(s,t,n),n1=()=>Le(cs.Checkpoints),o1=s=>Xt(s,cs.Checkpoints),Ct=s=>Se(s,cs.Checkpoints),c1=(s,t)=>Te(s,t,cs.Checkpoints),Lc=s=>Q(fc+st,Ct(s),2),Ba=(s,t)=>Q(fc,Ct(t),3,[s]),i1=(s=Xe,t=ws,n,o=Xe,c=ws)=>{const a=Ct(n);return bt(f=>ht(a,L=>{const $=s(f);o(L.addCheckpoint($),L,$)}),[a,...t,...c])},Ja=s=>wa(s,"goBackward"),Qa=s=>wa(s,"goForward"),r1=(s,t=ws,n,o=Xe,c=ws)=>{const a=Ct(n);return bt(f=>ht(a,L=>ht(s(f),$=>o(L.goTo($),$))),[a,...t,...c])},a1=s=>{const t=Ct(s),[n,o]=Lc(t);return[!Ru(n),Ja(t),o,ht(o,c=>t==null?void 0:t.getCheckpoint(c))??ct]},l1=s=>{const t=Ct(s),[,,[n]]=Lc(t);return[!dt(n),Qa(t),n,ht(n,o=>t==null?void 0:t.getCheckpoint(o))??ct]},u1=(s,t,n)=>q(fc+st,Ct(n),s,t),f1=(s,t,n,o)=>q(fc,Ct(o),t,n,[s]),Ga=(s,t,n=ws,o,c=ws,a,f=ws)=>{const[,L]=Oe(),[$,d]=Oe();return Ze(()=>{(async()=>{const S=s?await t(s):void 0;d(S),S&&o&&(async()=>(await o(S),L([])))()})()},[s,...n,...c]),Ze(()=>()=>{$&&($.destroy(),a==null||a($))},[$,...f]),$},d1=()=>Le(cs.Persister),h1=s=>Xt(s,cs.Persister),nr=s=>Se(s,cs.Persister),S1=(s,t)=>Te(s,t,cs.Persister),T1=s=>Q(lc,nr(s),5,[]),L1=(s,t,n)=>q(lc,nr(n),s,t,[]),C1=(s,t,n=ws,o,c=ws)=>{const[a,f]=Oe();return Ze(()=>{(async()=>{const L=s?await t(s):void 0;f(L)})()},[s,...n]),Ze(()=>()=>{a&&(a.destroy(),o==null||o(a))},[a,...c]),a},g1=()=>Le(cs.Synchronizer),$1=s=>Xt(s,cs.Synchronizer),or=s=>Se(s,cs.Synchronizer),y1=(s,t)=>Te(s,t,cs.Synchronizer),w1=s=>Q(lc,or(s),5,[]),R1=(s,t,n)=>q(lc,or(n),s,t,[]),Ot=(s,t,n,o,c)=>[n??t[s*2],{...t[s*2+1],...o,...c[s]}],Ya=({tableId:s,store:t,rowComponent:n=Eo,getRowComponentProps:o,customCellIds:c,separator:a,debugIds:f},L)=>Gs(et(L,$=>T.jsx(n,{...Tt(o,$),tableId:s,rowId:$,customCellIds:c,store:t,debugIds:f},$)),a,f,s),qa=({queryId:s,queries:t,resultRowComponent:n=Oa,getResultRowComponentProps:o,separator:c,debugIds:a},f)=>Gs(et(f,L=>T.jsx(n,{...Tt(o,L),queryId:s,rowId:L,queries:t,debugIds:a},L)),c,a,s),Ka=({relationshipId:s,relationships:t,rowComponent:n=Eo,getRowComponentProps:o,separator:c,debugIds:a},f,L)=>{const[$,d,S]=Ca(Lt(t),s),g=f(s,L,$);return Gs(et(g,w=>T.jsx(n,{...Tt(o,w),tableId:S,rowId:w,store:d,debugIds:a},w)),c,a,L)},cr=s=>({checkpoints:t,checkpointComponent:n=Ia,getCheckpointComponentProps:o,separator:c,debugIds:a})=>{const f=Ct(t);return Gs(et(s(Lc(f)),L=>T.jsx(n,{...Tt(o,L),checkpoints:f,checkpointId:L,debugIds:a},L)),c)},E1=({store:s,storesById:t,metrics:n,metricsById:o,indexes:c,indexesById:a,relationships:f,relationshipsById:L,queries:$,queriesById:d,checkpoints:S,checkpointsById:g,persister:w,persistersById:R,synchronizer:E,synchronizersById:V,children:m})=>{const p=$o(Ie),[j,Ls]=Oe(()=>wu(8,()=>({}))),Rs=bt((us,x,z)=>Ls(ss=>Ta(ss[us],x)==z?ss:yr(ss,us,{...ss[us],[x]:z})),[]),gs=bt((us,x)=>Ls(z=>bu(z[us],x)?yr(z,us,ju(z[us],x)):z),[]);return T.jsx(Ie.Provider,{value:Bi(()=>[...Ot(0,p,s,t,j),...Ot(1,p,n,o,j),...Ot(2,p,c,a,j),...Ot(3,p,f,L,j),...Ot(4,p,$,d,j),...Ot(5,p,S,g,j),...Ot(6,p,w,R,j),...Ot(7,p,E,V,j),Rs,gs],[j,s,t,n,o,c,a,f,L,$,d,S,g,w,R,E,V,p,Rs,gs]),children:m})},Gs=(s,t,n,o)=>{const c=dt(t)||!yu(s)?s:et(s,(a,f)=>f>0?[t,a]:a);return n?[o,":{",c,"}"]:c},V1=(s,t,n,o)=>{const c=ja(t,n,o);return s??c},Ro=({tableId:s,rowId:t,cellId:n,store:o,debugIds:c})=>Gs(ct+(We(s,t,n,o)??ct),void 0,c,n),Eo=({tableId:s,rowId:t,store:n,cellComponent:o=Ro,getCellComponentProps:c,customCellIds:a,separator:f,debugIds:L})=>Gs(et(V1(a,s,t,n),$=>T.jsx(o,{...Tt(c,$),tableId:s,rowId:t,cellId:$,store:n,debugIds:L},$)),f,L,t),Xa=s=>Ya(s,Gi(s.tableId,s.store)),b1=({cellId:s,descending:t,offset:n,limit:o,...c})=>Ya(c,Yi(c.tableId,s,t,n,o,c.store)),j1=({store:s,tableComponent:t=Xa,getTableComponentProps:n,separator:o,debugIds:c})=>Gs(et(Qi(s),a=>T.jsx(t,{...Tt(n,a),tableId:a,store:s,debugIds:c},a)),o),ir=({valueId:s,store:t,debugIds:n})=>Gs(ct+(ie(s,t)??ct),void 0,n,s),x1=({store:s,valueComponent:t=ir,getValueComponentProps:n,separator:o,debugIds:c})=>Gs(et(Sc(s),a=>T.jsx(t,{...Tt(n,a),valueId:a,store:s,debugIds:c},a)),o),P1=({metricId:s,metrics:t,debugIds:n})=>Gs(Ki(s,t)??ct,void 0,n,s),Za=({indexId:s,sliceId:t,indexes:n,rowComponent:o=Eo,getRowComponentProps:c,separator:a,debugIds:f})=>{const[L,$,d]=vu(ge(n),s),S=Oi(s,t,L);return Gs(et(S,g=>T.jsx(o,{...Tt(c,g),tableId:d,rowId:g,store:$,debugIds:f},g)),a,f,t)},m1=({indexId:s,indexes:t,sliceComponent:n=Za,getSliceComponentProps:o,separator:c,debugIds:a})=>Gs(et(Zi(s,t),f=>T.jsx(n,{...Tt(o,f),indexId:s,sliceId:f,indexes:t,debugIds:a},f)),c,a,s),D1=({relationshipId:s,localRowId:t,relationships:n,rowComponent:o=Eo,getRowComponentProps:c,debugIds:a})=>{const[f,L,,$]=Ca(Lt(n),s),d=sr(s,t,f);return Gs(dt($)||dt(d)?null:T.jsx(o,{...Tt(c,d),tableId:$,rowId:d,store:L,debugIds:a},d),void 0,a,t)},N1=s=>Ka(s,Aa,s.remoteRowId),v1=s=>Ka(s,Fa,s.firstRowId),rr=({queryId:s,rowId:t,cellId:n,queries:o,debugIds:c})=>Gs(ct+(Wa(s,t,n,o)??ct),void 0,c,n),Oa=({queryId:s,rowId:t,queries:n,resultCellComponent:o=rr,getResultCellComponentProps:c,separator:a,debugIds:f})=>Gs(et(Ua(s,t,n),L=>T.jsx(o,{...Tt(c,L),queryId:s,rowId:t,cellId:L,queries:n,debugIds:f},L)),a,f,t),p1=s=>qa(s,Ha(s.queryId,s.queries)),A1=({cellId:s,descending:t,offset:n,limit:o,...c})=>qa(c,er(c.queryId,s,t,n,o,c.queries)),Ia=({checkpoints:s,checkpointId:t,debugIds:n})=>Gs(Ba(t,s)??ct,void 0,n,t),F1=cr(s=>s[0]),k1=cr(s=>dt(s[1])?[]:[s[1]]),_1=cr(s=>s[2]),Sh=Object.freeze(Object.defineProperty({__proto__:null,BackwardCheckpointsView:F1,CellView:Ro,CheckpointView:Ia,CurrentCheckpointView:k1,ForwardCheckpointsView:_1,IndexView:m1,LinkedRowsView:v1,LocalRowsView:N1,MetricView:P1,Provider:E1,RemoteRowView:D1,ResultCellView:rr,ResultRowView:Oa,ResultSortedTableView:A1,ResultTableView:p1,RowView:Eo,SliceView:Za,SortedTableView:b1,TableView:Xa,TablesView:j1,ValueView:ir,ValuesView:x1,useAddRowCallback:Iu,useCell:We,useCellIds:ja,useCellIdsListener:w0,useCellListener:E0,useCheckpoint:Ba,useCheckpointIds:Lc,useCheckpointIdsListener:u1,useCheckpointListener:f1,useCheckpoints:o1,useCheckpointsIds:n1,useCheckpointsOrCheckpointsById:Ct,useCreateCheckpoints:e1,useCreateIndexes:F0,useCreateMergeableStore:zu,useCreateMetrics:v0,useCreatePersister:Ga,useCreateQueries:J0,useCreateRelationships:z0,useCreateStore:Ea,useCreateSynchronizer:C1,useDelCellCallback:i0,useDelRowCallback:c0,useDelTableCallback:o0,useDelTablesCallback:n0,useDelValueCallback:a0,useDelValuesCallback:r0,useDidFinishTransactionListener:N0,useGoBackwardCallback:Ja,useGoForwardCallback:Qa,useGoToCallback:r1,useHasCell:Yu,useHasCellListener:R0,useHasRow:Qu,useHasRowListener:$0,useHasTable:Wu,useHasTableCell:Ju,useHasTableCellListener:T0,useHasTableListener:d0,useHasTables:Hu,useHasTablesListener:l0,useHasValue:Ku,useHasValueListener:x0,useHasValues:qu,useHasValuesListener:V0,useIndexIds:Na,useIndexes:Xi,useIndexesIds:Da,useIndexesOrIndexesById:ge,useLinkedRowIds:Fa,useLinkedRowIdsListener:B0,useLocalRowIds:Aa,useLocalRowIdsListener:W0,useMetric:Ki,useMetricIds:ma,useMetricListener:A0,useMetrics:qi,useMetricsIds:Pa,useMetricsOrMetricsById:Tc,usePersister:h1,usePersisterIds:d1,usePersisterOrPersisterById:nr,usePersisterStatus:T1,usePersisterStatusListener:L1,useProvideCheckpoints:c1,useProvideIndexes:k0,useProvideMetrics:p0,useProvidePersister:S1,useProvideQueries:Q0,useProvideRelationships:H0,useProvideStore:Mu,useProvideSynchronizer:y1,useQueries:tr,useQueriesIds:ka,useQueriesOrQueriesById:Ms,useQueryIds:_a,useRedoInformation:l1,useRelationshipIds:pa,useRelationships:Ii,useRelationshipsIds:va,useRelationshipsOrRelationshipsById:Lt,useRemoteRowId:sr,useRemoteRowIdListener:U0,useResultCell:Wa,useResultCellIds:Ua,useResultCellIdsListener:s1,useResultCellListener:t1,useResultRow:Y0,useResultRowCount:za,useResultRowCountListener:X0,useResultRowIds:Ha,useResultRowIdsListener:Z0,useResultRowListener:I0,useResultSortedRowIds:er,useResultSortedRowIdsListener:O0,useResultTable:G0,useResultTableCellIds:Ma,useResultTableCellIdsListener:K0,useResultTableListener:q0,useRow:Gu,useRowCount:ba,useRowCountListener:L0,useRowIds:Gi,useRowIdsListener:C0,useRowListener:y0,useSetCellCallback:wo,useSetCheckpointCallback:i1,useSetPartialRowCallback:s0,useSetPartialValuesCallback:e0,useSetRowCallback:Ou,useSetTableCallback:Zu,useSetTablesCallback:Xu,useSetValueCallback:So,useSetValuesCallback:t0,useSliceIds:Zi,useSliceIdsListener:_0,useSliceRowIds:Oi,useSliceRowIdsListener:M0,useSortedRowIds:Yi,useSortedRowIdsListener:g0,useSortedRowIdsListenerImpl:Ra,useStartTransactionListener:m0,useStore:Ji,useStoreIds:Va,useStoreOrStoreById:M,useStores:_u,useSynchronizer:$1,useSynchronizerIds:g1,useSynchronizerOrSynchronizerById:or,useSynchronizerStatus:w1,useSynchronizerStatusListener:R1,useTable:Bu,useTableCellIds:hc,useTableCellIdsListener:S0,useTableIds:Qi,useTableIdsListener:f0,useTableListener:h0,useTables:Uu,useTablesListener:u0,useUndoInformation:a1,useValue:ie,useValueIds:Sc,useValueIdsListener:j0,useValueListener:P0,useValues:xa,useValuesListener:b0,useWillFinishTransactionListener:D0},Symbol.toStringTag,{value:"Module"})),re=s=>typeof s,Kt="",sl=".",Cc=re(Kt),tl=re(!0),gc=re(0),M1=re(re),xo="type",nt="default",z1="Listener",H1="add",Pe="Has",$c="Ids",Fe="Table",Er=Fe+"s",U1=Fe+$c,Qo="Row",W1=Qo+"Count",B1=Qo+$c,ao="Cell",Vr=ao+$c,sn="Value",Ri=sn+"s",J1=sn+$c,Ke="currentTarget",br="value",el="￼",Ts=s=>Kt+s,Q1=(s,t=Kt,n)=>s.split(t,n),G1=globalThis,jr=G1.window,nl=Math,Y1=nl.min,xr=nl.floor,q1=isFinite,K1=(s,t)=>s instanceof t,I=s=>s==null,Fs=(s,t,n)=>I(s)?n==null?void 0:n():t(s),ol=s=>s==Cc||s==tl,X1=s=>re(s)==Cc,di=s=>re(s)==M1,To=s=>Array.isArray(s),Pr=(s,t,n)=>s.slice(t,n),jt=s=>s.length,Z1=(s,t)=>s.test(t),cl=s=>{throw new Error(s)},Yt=async(s,t,n)=>{try{return await s()}catch(o){t==null||t(o)}},O1=(s,t)=>s.includes(t),I1=(s,t)=>s.every(t),sf=(s,t)=>jt(s)===jt(t)&&I1(s,(n,o)=>t[o]===n),il=(s,t)=>s.sort(t),Lo=(s,t)=>s.forEach(t),tf=(s,t=Kt)=>s.join(t),vs=(s,t)=>s.map(t),wt=s=>jt(s)==0,ef=(s,t,n)=>s.reduce(t,n),nf=(s,t)=>s.splice(0,t),Co=(s,...t)=>s.push(...t),rl=s=>s.shift(),$e=Object,mr=s=>$e.getPrototypeOf(s),al=$e.entries,of=$e.isFrozen,Go=s=>!I(s)&&Fs(mr(s),t=>t==$e.prototype||I(mr(t)),()=>!0),cf=$e.keys,ll=$e.freeze,lo=(s=[])=>$e.fromEntries(s),no=(s,t)=>t in s,ul=(s,t)=>(delete s[t],s),rf=(s,t)=>Lo(al(s),([n,o])=>t(o,n)),tn=(s,t)=>vs(al(s),([n,o])=>t(o,n)),Qt=(s,t)=>lo(tn(s,(n,o)=>[o,t(n,o)])),af=s=>jt(cf(s)),Xs=s=>Go(s)&&af(s)==0,It=(s,t,n,o=0)=>I(s)||!Go(s)||!o&&Xs(s)||of(s)?(n==null||n(),!1):(rf(s,(c,a)=>{t(c,a)||ul(s,a)}),o?!0:!Xs(s)),fl=JSON.stringify,ke=JSON.parse,Gt=s=>fl(s,(t,n)=>K1(n,Map)?$e.fromEntries([...n]):n),lf=s=>fl(s,(t,n)=>n===void 0?el:n),uf=s=>ke(s,(t,n)=>n===el?void 0:n),ar=s=>t=>ef(ff(t),(n,o)=>n+s(o),0),lr=s=>(s==null?void 0:s.size)??0,ur=ar(lr),oo=ar(ur),hi=ar(oo),Ys=(s,t)=>(s==null?void 0:s.has(t))??!1,K=s=>I(s)||lr(s)==0,ff=s=>[...(s==null?void 0:s.values())??[]],Si=s=>s.clear(),rs=(s,t)=>s==null?void 0:s.forEach(t),Yo=(s,t)=>s==null?void 0:s.delete(t),X=s=>new Map(s),Zn=s=>[...(s==null?void 0:s.keys())??[]],N=(s,t)=>s==null?void 0:s.get(t),te=(s,t)=>rs(s,(n,o)=>t(o,n)),df=(s,t)=>vs([...(s==null?void 0:s.entries())??[]],([n,o])=>t(o,n)),fs=(s,t,n)=>I(n)?(Yo(s,t),s):s==null?void 0:s.set(t,n),As=(s,t,n,o)=>(Ys(s,t)?o==null||o(N(s,t)):fs(s,t,n()),N(s,t)),me=(s,t,n,o=fs)=>(Qt(t,(c,a)=>n(s,a,c)),te(s,c=>no(t,c)?0:o(s,c)),s),qs=(s,t,n,o)=>{const c={};return rs(s,(a,f)=>{if(!(n!=null&&n(a,f))){const L=t?t(a,f):a;o!=null&&o(L)||(c[f]=L)}}),c},Ei=(s,t,n)=>qs(s,o=>qs(o,t,n),K,Xs),Po=(s,t,n)=>qs(s,o=>Ei(o,t,n),K,Xs),ne=(s,t)=>{const n=X();return rs(s,(o,c)=>n.set(c,(t==null?void 0:t(o))??o)),n},Vi=s=>ne(s,ne),Ti=s=>ne(s,Vi),bi=(s,t,n,o,c=0)=>Fs((n?As:N)(s,t[c],c>jt(t)-2?n:X),a=>{if(c>jt(t)-2)return o!=null&&o(a)&&fs(s,t[c]),a;const f=bi(a,t,n,o,c+1);return K(a)&&fs(s,t[c]),f}),hf=/^\d+$/,dl=()=>{const s=[];let t=0;return[n=>(n?rl(s):null)??Kt+t++,n=>{Z1(hf,n)&&jt(s)<1e3&&Co(s,n)}]},co=s=>new Set(To(s)||I(s)?s:[s]),io=(s,t)=>s==null?void 0:s.add(t),Sf=(s,t=[Kt])=>{const n=[],o=(c,a)=>a==jt(t)?Co(n,c):t[a]===null?rs(c,f=>o(f,a+1)):Lo([t[a],null],f=>o(N(c,f),a+1));return o(s,0),n},hl=s=>{let t;const[n,o]=dl(),c=X();return[(d,S,g,w=[],R=()=>[])=>{t??(t=s());const E=n(1);return fs(c,E,[d,S,g,w,R]),io(bi(S,g??[Kt],co),E),E},(d,S,...g)=>Lo(Sf(d,S),w=>rs(w,R=>N(c,R)[0](t,...S??[],...g))),d=>Fs(N(c,d),([,S,g])=>(bi(S,g??[Kt],void 0,w=>(Yo(w,d),K(w)?1:0)),fs(c,d),o(d),g)),d=>Fs(N(c,d),([S,,g=[],w,R])=>{const E=(...V)=>{var p;const m=jt(V);m==jt(g)?S(t,...V,...R(V)):I(g[m])?Lo(((p=w[m])==null?void 0:p.call(w,...V))??[],j=>E(...V,j)):E(...V,g[m])};E()})]},mo=X(),Do=X(),Tf=(s=1,t,n)=>s!=1&&t.isMergeable()?[1,t.getMergeableContent,()=>t.getTransactionMergeableChanges(!n),([[o],[c]])=>!Xs(o)||!Xs(c),t.setDefaultContent]:s!=2?[0,t.getContent,t.getTransactionChanges,([o,c])=>!Xs(o)||!Xs(c),t.setContent]:cl("Store type not supported by this Persister"),Lf=(s,t,n,o,c,a,f,L={},$=0,d=[])=>{let S=0,g=0,w=0,R,E,V;As(mo,d,()=>0),As(Do,d,()=>[]);const m=X(),[p,j,Ls,Rs,gs]=Tf(f,s,$),[us,x,z]=hl(()=>_),ss=C=>{C!=S&&(S=C,x(m,void 0,S))},F=async()=>{if(!N(mo,d)){for(fs(mo,d,1);!I(R=rl(N(Do,d)));)await Yt(R,a);fs(mo,d,0)}},Z=C=>{(p&&To(C==null?void 0:C[0])?(C==null?void 0:C[2])===1?s.applyMergeableChanges:s.setMergeableContent:(C==null?void 0:C[2])===1?s.applyChanges:s.setContent)(C)},as=async C=>(S!=2&&(ss(1),g++,await hs(async()=>{await Yt(async()=>{const A=await t();To(A)?Z(A):C?gs(C):cl(`Content is not an array: ${A}`)},()=>{C&&gs(C)}),ss(0)})),_),es=async C=>(D(),await as(C),await Yt(async()=>E=await o(async(A,Y)=>{Y||A?S!=2&&(ss(1),g++,Z(Y??A),ss(0)):await as()}),a),_),D=async()=>(E&&(await Yt(()=>c(E),a),E=void 0),_),O=()=>!I(E),ns=async C=>(S!=1&&(ss(2),w++,await hs(async()=>{await Yt(()=>n(j,C),a),ss(0)})),_),os=async()=>(ts(),await ns(),V=s.addDidFinishTransactionListener(()=>{const C=Ls();Rs(C)&&ns(C)}),_),ts=async()=>(V&&(s.delListener(V),V=void 0),_),bs=()=>!I(V),Es=async(C,A=!1)=>{const[Y,$s]=A?[os,es]:[es,os];return await Y(C),await $s(C),_},G=async(C=!1)=>{const[A,Y]=C?[ts,D]:[D,ts];return await A(),await Y(),_},ds=()=>S,Cs=C=>us(C,m),Ns=C=>(z(C),s),hs=async(...C)=>(Co(N(Do,d),...C),await F(),_),_={load:as,startAutoLoad:es,stopAutoLoad:D,isAutoLoading:O,save:ns,startAutoSave:os,stopAutoSave:ts,isAutoSaving:bs,startAutoPersisting:Es,stopAutoPersisting:G,getStatus:ds,addStatusListener:Cs,delListener:Ns,schedule:hs,getStore:()=>s,destroy:()=>(nf(N(Do,d)),G()),getStats:()=>({loads:g,saves:w}),...L};return ll(_)},Dr="storage",Cf=(s,t,n,o)=>Lf(s,async()=>uf(n.getItem(t)),async $=>n.setItem(t,lf($())),$=>{const d=S=>{S.storageArea===n&&S.key===t&&Yt(()=>$(ke(S.newValue)),$)};return jr.addEventListener(Dr,d),d},$=>jr.removeEventListener(Dr,$),o,3,{getStorageName:()=>t}),gf=(s,t,n)=>Cf(s,t,sessionStorage,n),Qe=s=>{const t=re(s);return ol(t)||t==gc&&q1(s)?t:void 0},Nr=(s,t,n,o,c)=>I(c)?s.delCell(t,n,o,!0):s.setCell(t,n,o,c),vr=(s,t,n)=>I(n)?s.delValue(t):s.setValue(t,n),Li=(s,t,n,o)=>s==Cc?t:s==gc?n:o,$f=(s,t)=>(s??0)<(t??0)?-1:1,No=s=>[s,s],js=(s,t=ur)=>t(s[0])+t(s[1]),xs=()=>[X(),X()],pr=s=>[...s],vo=([s,t])=>s===t,On=(s,t,n)=>fs(s,t,N(s,t)==-n?void 0:n),Sl=()=>{let s,t,n=!1,o=!1,c=0,a=[];const f=X(),L=X(),$=X(),d=X(),S=X(),g=X(),w=X(),R=X(),E=X(),V=X(),m=X(),p=X(),j=X(),Ls=X(),Rs=co(),gs=X(),us=X(),x=X(),z=X(),ss=xs(),F=xs(),Z=xs(),as=xs(),es=xs(),D=xs(),O=xs(),ns=xs(),os=xs(),ts=xs(),bs=xs(),Es=xs(),G=xs(),ds=xs(),Cs=xs(),Ns=xs(),hs=xs(),Ws=xs(),ks=xs(),zs=xs(),_=xs(),C=xs(),A=X(),Y=xs(),[$s,U,Zt,Bs]=hl(()=>is),Be=e=>It(e,i=>It(i,cn)),Dc=e=>It(e,cn),cn=e=>{if(!It(e,(r,l)=>O1([xo,nt],l)))return!1;const i=e[xo];return!ol(i)&&i!=gc?!1:(Qe(e[nt])!=i&&ul(e,nt),!0)},Nc=To,vc=e=>It(e,rn,Hs),rn=(e,i)=>(!s||Ys(m,i)||Hs(i))&&It(e,(r,l)=>mt(i,l,r),()=>Hs(i)),mt=(e,i,r,l)=>It(l?r:fn(r,e,i),(u,h)=>Fs(an(e,i,h,u),y=>(r[h]=y,!0),()=>!1),()=>Hs(e,i)),an=(e,i,r,l)=>s?Fs(N(N(m,e),r),u=>Qe(l)!=u[xo]?Hs(e,i,r,l,u[nt]):l,()=>Hs(e,i,r,l)):I(Qe(l))?Hs(e,i,r,l):l,ln=(e,i)=>It(i?e:pc(e),(r,l)=>Fs(un(l,r),u=>(e[l]=u,!0),()=>!1),()=>rt()),un=(e,i)=>t?Fs(N(j,e),r=>Qe(i)!=r[xo]?rt(e,i,r[nt]):i,()=>rt(e,i)):I(Qe(i))?rt(e,i):i,fn=(e,i,r)=>(Fs(N(p,i),([l,u])=>{rs(l,(h,y)=>{no(e,y)||(e[y]=h)}),rs(u,h=>{no(e,h)||Hs(i,r,h)})}),e),pc=e=>(t&&(rs(Ls,(i,r)=>{no(e,r)||(e[r]=i)}),rs(Rs,i=>{no(e,i)||rt(i)})),e),dn=e=>me(m,e,(i,r,l)=>{const u=X(),h=co();me(As(m,r,X),l,(y,P,v)=>{fs(y,P,v),Fs(v[nt],Ss=>fs(u,P,Ss),()=>io(h,P))}),fs(p,r,[u,h])},(i,r)=>{fs(m,r),fs(p,r)}),hn=e=>me(j,e,(i,r,l)=>{fs(j,r,l),Fs(l[nt],u=>fs(Ls,r,u),()=>io(Rs,r))},(i,r)=>{fs(j,r),fs(Ls,r),Yo(Rs,r)}),Sn=e=>Xs(e)?Ut():zt(e),Ac=([e,i])=>{(Xs(e)?Ut:zt)(e),(Xs(i)?Wt:Ht)(i)},Tn=e=>me(x,e,(i,r,l)=>Dt(r,l),(i,r)=>$n(r)),Dt=(e,i)=>me(As(x,e,()=>(En(e,1),fs(gs,e,dl()),fs(us,e,X()),X())),i,(r,l,u)=>it(e,r,l,u),(r,l)=>yn(e,r,l)),it=(e,i,r,l,u)=>me(As(i,r,()=>(Vn(e,r,1),X())),l,(h,y,P)=>we(e,r,h,y,P),(h,y)=>wn(e,i,r,h,y,u)),we=(e,i,r,l,u)=>{Ys(r,l)||bn(e,i,l,1);const h=N(r,l);u!==h&&(jn(e,i,l,h,u),fs(r,l,u))},Ln=(e,i,r,l,u)=>Fs(N(i,r),h=>we(e,r,h,l,u),()=>it(e,i,r,fn({[l]:u},e,r))),Cn=e=>Xs(e)?Wt():Ht(e),gn=e=>me(z,e,(i,r,l)=>Nt(r,l),(i,r)=>Rn(r)),Nt=(e,i)=>{Ys(z,e)||xn(e,1);const r=N(z,e);i!==r&&(Pn(e,r,i),fs(z,e,i))},Fc=(e,i)=>{const[r]=N(gs,e);let l;do l=r(i);while(Ys(N(x,e),l));return l},vt=e=>N(x,e)??Dt(e,{}),$n=e=>Dt(e,{}),yn=(e,i,r)=>{const[,l]=N(gs,e);l(r),it(e,i,r,{},!0)},wn=(e,i,r,l,u,h)=>{var v;const y=N((v=N(p,e))==null?void 0:v[0],u);if(!I(y)&&!h)return we(e,r,l,u,y);const P=Ss=>{jn(e,r,Ss,N(l,Ss)),bn(e,r,Ss,-1),fs(l,Ss)};I(y)?P(u):te(l,P),K(l)&&(Vn(e,r,-1),K(fs(i,r))&&(En(e,-1),fs(x,e),fs(gs,e),fs(us,e)))},Rn=e=>{const i=N(Ls,e);if(!I(i))return Nt(e,i);Pn(e,N(z,e)),xn(e,-1),fs(z,e)},En=(e,i)=>On(f,e,i),Vn=(e,i,r)=>On(As(d,e,X),i,r)&&fs($,e,As($,e,()=>0)+r),bn=(e,i,r,l)=>{const u=N(us,e),h=N(u,r)??0;(h==0&&l==1||h==1&&l==-1)&&On(As(L,e,X),r,l),fs(u,r,h!=-l?h+l:null),On(As(As(S,e,X),i,X),r,l)},jn=(e,i,r,l,u)=>{var h;As(As(As(g,e,X),i,X),r,()=>[l,0])[1]=u,(h=a[3])==null||h.call(a,e,i,r,u)},xn=(e,i)=>On(w,e,i),Pn=(e,i,r)=>{var l;As(R,e,()=>[i,0])[1]=r,(l=a[4])==null||l.call(a,e,r)},Hs=(e,i,r,l,u)=>(Co(As(As(As(E,e,X),i,X),r,()=>[]),l),u),rt=(e,i,r)=>(Co(As(V,e,()=>[]),i),r),pt=(e,i,r)=>Fs(N(N(N(g,e),i),r),([l,u])=>[!0,l,u],()=>[!1,...No(Ft(e,i,r))]),mn=e=>Fs(N(R,e),([i,r])=>[!0,i,r],()=>[!1,...No(kt(e))]),Dn=e=>!K(E)&&!K(Ns[e])?rs(e?Ti(E):E,(i,r)=>rs(i,(l,u)=>rs(l,(h,y)=>U(Ns[e],[r,u,y],h)))):0,Nn=e=>!K(V)&&!K(hs[e])?rs(e?ne(V):V,(i,r)=>U(hs[e],[r],i)):0,at=(e,i,r,l)=>{if(!K(e))return U(i,l,()=>qs(e)),te(e,(u,h)=>U(r,[...l??[],u],h==1)),1},vn=e=>{const i=_t();i!=n&&U(ss[e],void 0,i);const r=K(ts[e]),l=K(G[e])&&K(ds[e])&&K(os[e])&&K(bs[e])&&K(D[e])&&K(O[e])&&K(ns[e])&&r&&K(Z[e])&&K(as[e]),u=K(Cs[e])&&K(Es[e])&&K(es[e])&&K(F[e]);if(!l||!u){const h=e?[ne(f),Vi(L),ne($),Vi(d),Ti(S),Ti(g)]:[f,L,$,d,S,g];if(!l){at(h[0],Z[e],as[e]),rs(h[1],(P,v)=>at(P,D[e],O[e],[v])),rs(h[2],(P,v)=>{P!=0&&U(ns[e],[v],kn(v))});const y=co();rs(h[3],(P,v)=>{at(P,os[e],bs[e],[v])&&!r&&(U(ts[e],[v,null]),io(y,v))}),r||rs(h[5],(P,v)=>{if(!Ys(y,v)){const Ss=co();rs(P,Us=>rs(Us,([Bt,Jt],lt)=>Jt!==Bt?io(Ss,lt):Yo(Us,lt))),rs(Ss,Us=>U(ts[e],[v,Us]))}}),rs(h[4],(P,v)=>rs(P,(Ss,Us)=>at(Ss,G[e],ds[e],[v,Us])))}if(!u){let y;rs(h[5],(P,v)=>{let Ss;rs(P,(Us,Bt)=>{let Jt;rs(Us,([lt,Xn],ai)=>{Xn!==lt&&(U(Cs[e],[v,Bt,ai],Xn,lt,pt),y=Ss=Jt=1)}),Jt&&U(Es[e],[v,Bt],pt)}),Ss&&U(es[e],[v],pt)}),y&&U(F[e],void 0,pt)}}},pn=e=>{const i=Mt();i!=o&&U(Ws[e],void 0,i);const r=K(zs[e])&&K(_[e]),l=K(C[e])&&K(ks[e]);if(!r||!l){const u=e?[ne(w),ne(R)]:[w,R];if(r||at(u[0],zs[e],_[e]),!l){let h;rs(u[1],([y,P],v)=>{P!==y&&(U(C[e],[v],P,y,mn),h=1)}),h&&U(ks[e],void 0,mn)}}},H=(e,...i)=>(xe(()=>e(...vs(i,Ts))),is),An=(e,i,r,l,u)=>{let h=At(e,i,...r);return $s(()=>{const y=At(e,i,...r);sf(y,h)||(h=y,l(is,e,i,...r,h))},ts[u?1:0],[e,i],[ys])},kc=()=>[Re(),Ve()],Re=()=>Po(x),ys=()=>Zn(x),_c=e=>Ei(N(x,Ts(e))),Fn=e=>Zn(N(us,Ts(e))),kn=e=>lr(N(x,Ts(e))),Zs=e=>Zn(N(x,Ts(e))),At=(e,i,r,l=0,u)=>Go(e)?At(e.tableId,e.cellId,e.descending,e.offset,e.limit):vs(Pr(il(df(N(x,Ts(e)),(h,y)=>[I(i)?y:N(h,Ts(i)),y]),([h],[y])=>$f(h,y)*(r?-1:1)),l,I(u)?u:l+u),([,h])=>h),Mc=(e,i)=>qs(N(N(x,Ts(e)),Ts(i))),Ee=(e,i)=>Zn(N(N(x,Ts(e)),Ts(i))),Ft=(e,i,r)=>N(N(N(x,Ts(e)),Ts(i)),Ts(r)),Ve=()=>qs(z),be=()=>Zn(z),kt=e=>N(z,Ts(e)),_t=()=>!K(x),_n=e=>Ys(x,Ts(e)),Mn=(e,i)=>Ys(N(us,Ts(e)),Ts(i)),zn=(e,i)=>Ys(N(x,Ts(e)),Ts(i)),Hn=(e,i,r)=>Ys(N(N(x,Ts(e)),Ts(i)),Ts(r)),Mt=()=>!K(z),Un=e=>Ys(z,Ts(e)),zc=()=>Gt(x),Hc=()=>Gt(z),Uc=()=>Gt([x,z]),Wc=()=>Gt(m),Bc=()=>Gt(j),Jc=()=>Gt([m,j]),Qc=e=>H(()=>{const i=di(e)?e():e;Nc(i)&&Ac(i)}),zt=e=>H(()=>vc(e)?Tn(e):0),Gc=(e,i)=>H(r=>rn(i,r)?Dt(r,i):0,e),Yc=(e,i,r)=>H((l,u)=>mt(l,u,r)?it(l,vt(l),u,r):0,e,i),qc=(e,i,r=!0)=>xe(()=>{let l;return mt(e,l,i)&&(e=Ts(e),it(e,vt(e),l=Fc(e,r?1:0),i)),l}),Kc=(e,i,r)=>H((l,u)=>{if(mt(l,u,r,1)){const h=vt(l);Qt(r,(y,P)=>Ln(l,h,u,P,y))}},e,i),Xc=(e,i,r,l)=>H((u,h,y)=>Fs(an(u,h,y,di(l)?l(Ft(u,h,y)):l),P=>Ln(u,vt(u),h,y,P)),e,i,r),Ht=e=>H(()=>ln(e)?gn(e):0),Zc=e=>H(()=>ln(e,1)?Qt(e,(i,r)=>Nt(r,i)):0),Oc=(e,i)=>H(r=>Fs(un(r,di(i)?i(kt(r)):i),l=>Nt(r,l)),e),Ic=e=>H(()=>{Qt(e[0],(i,r)=>I(i)?Qn(r):Qt(i,(l,u)=>I(l)?Gn(r,u):Qt(l,(h,y)=>Nr(is,r,u,y,h)))),Qt(e[1],(i,r)=>vr(is,r,i))}),Wn=e=>(Yt(()=>Sn(ke(e))),is),si=e=>(Yt(()=>Cn(ke(e))),is),ti=e=>H(()=>Yt(()=>{const[i,r]=ke(e);Sn(i),Cn(r)},()=>Wn(e))),Bn=e=>H(()=>{if((s=Be(e))&&(dn(e),!K(x))){const i=Re();Ut(),zt(i)}}),Jn=e=>H(()=>{if(t=Dc(e)){const i=Ve();je(),Wt(),t=!0,hn(e),Ht(i)}}),ei=(e,i)=>H(()=>{Bn(e),Jn(i)}),Ut=()=>H(()=>Tn({})),Qn=e=>H(i=>Ys(x,i)?$n(i):0,e),Gn=(e,i)=>H((r,l)=>Fs(N(x,r),u=>Ys(u,l)?yn(r,u,l):0),e,i),ni=(e,i,r,l)=>H((u,h,y)=>Fs(N(x,u),P=>Fs(N(P,h),v=>Ys(v,y)?wn(u,P,h,v,y,l):0)),e,i,r),Wt=()=>H(()=>gn({})),oi=e=>H(i=>Ys(z,i)?Rn(i):0,e),Yn=()=>H(()=>{dn({}),s=!1}),je=()=>H(()=>{hn({}),t=!1}),ci=()=>H(()=>{Yn(),je()}),xe=(e,i)=>{if(c!=-1){qn();const r=e();return Kn(i),r}},qn=()=>{var e;return c!=-1&&c++,c==1&&((e=a[0])==null||e.call(a),U(A)),is},ii=()=>[qs(g,(e,i)=>N(f,i)===-1?void 0:qs(e,(r,l)=>N(N(d,i),l)===-1?void 0:qs(r,([,u])=>u,u=>vo(u)),K,Xs),K,Xs),qs(R,([,e])=>e,e=>vo(e)),1],ri=()=>[!K(g),!K(R),Po(g,pr,vo),Po(E),qs(R,pr,vo),qs(V),qs(f),Ei(d),Po(S),qs(w)],Kn=e=>{var i,r;return c>0&&(c--,c==0&&(c=1,Dn(1),K(g)||vn(1),Nn(1),K(R)||pn(1),e!=null&&e(is)&&(rs(g,(l,u)=>rs(l,(h,y)=>rs(h,([P],v)=>Nr(is,u,y,v,P)))),Si(g),rs(R,([l],u)=>vr(is,u,l)),Si(R)),U(Y[0],void 0),c=-1,Dn(0),K(g)||vn(0),Nn(0),K(R)||pn(0),(i=a[1])==null||i.call(a),U(Y[1],void 0),(r=a[2])==null||r.call(a),c=0,n=_t(),o=Mt(),Lo([f,L,$,d,S,g,E,w,R,V],Si))),is},is={getContent:kc,getTables:Re,getTableIds:ys,getTable:_c,getTableCellIds:Fn,getRowCount:kn,getRowIds:Zs,getSortedRowIds:At,getRow:Mc,getCellIds:Ee,getCell:Ft,getValues:Ve,getValueIds:be,getValue:kt,hasTables:_t,hasTable:_n,hasTableCell:Mn,hasRow:zn,hasCell:Hn,hasValues:Mt,hasValue:Un,getTablesJson:zc,getValuesJson:Hc,getJson:Uc,getTablesSchemaJson:Wc,getValuesSchemaJson:Bc,getSchemaJson:Jc,hasTablesSchema:()=>s,hasValuesSchema:()=>t,setContent:Qc,setTables:zt,setTable:Gc,setRow:Yc,addRow:qc,setPartialRow:Kc,setCell:Xc,setValues:Ht,setPartialValues:Zc,setValue:Oc,applyChanges:Ic,setTablesJson:Wn,setValuesJson:si,setJson:ti,setTablesSchema:Bn,setValuesSchema:Jn,setSchema:ei,delTables:Ut,delTable:Qn,delRow:Gn,delCell:ni,delValues:Wt,delValue:oi,delTablesSchema:Yn,delValuesSchema:je,delSchema:ci,transaction:xe,startTransaction:qn,getTransactionChanges:ii,getTransactionLog:ri,finishTransaction:Kn,forEachTable:e=>rs(x,(i,r)=>e(r,l=>rs(i,(u,h)=>l(h,y=>te(u,y))))),forEachTableCell:(e,i)=>te(N(us,Ts(e)),i),forEachRow:(e,i)=>rs(N(x,Ts(e)),(r,l)=>i(l,u=>te(r,u))),forEachCell:(e,i,r)=>te(N(N(x,Ts(e)),Ts(i)),r),forEachValue:e=>te(z,e),addSortedRowIdsListener:(e,i,r,l,u,h,y)=>Go(e)?An(e.tableId,e.cellId,[e.descending??!1,e.offset??0,e.limit],i,r):An(e,i,[r,l,u],h,y),addStartTransactionListener:e=>$s(e,A),addWillFinishTransactionListener:e=>$s(e,Y[0]),addDidFinishTransactionListener:e=>$s(e,Y[1]),callListener:e=>(Bs(e),is),delListener:e=>(Zt(e),is),getListenerStats:()=>({hasTables:js(ss),tables:js(F),tableIds:js(Z),hasTable:js(as),table:js(es),tableCellIds:js(D),hasTableCell:js(O,oo),rowCount:js(ns),rowIds:js(os),sortedRowIds:js(ts),hasRow:js(bs,oo),row:js(Es,oo),cellIds:js(G,oo),hasCell:js(ds,hi),cell:js(Cs,hi),invalidCell:js(Ns,hi),hasValues:js(Ws),values:js(ks),valueIds:js(zs),hasValue:js(_),value:js(C),invalidValue:js(hs),transaction:ur(A)+js(Y)}),isMergeable:()=>!1,createStore:Sl,addListener:$s,callListeners:U,setInternalListeners:(e,i,r,l,u)=>a=[e,i,r,l,u]};return Qt({[Pe+Er]:[0,ss,[],()=>[_t()]],[Er]:[0,F],[U1]:[0,Z],[Pe+Fe]:[1,as,[ys],e=>[_n(...e)]],[Fe]:[1,es,[ys]],[Fe+Vr]:[1,D,[ys]],[Pe+Fe+ao]:[2,O,[ys,Fn],e=>[Mn(...e)]],[W1]:[1,ns,[ys]],[B1]:[1,os,[ys]],[Pe+Qo]:[2,bs,[ys,Zs],e=>[zn(...e)]],[Qo]:[2,Es,[ys,Zs]],[Vr]:[2,G,[ys,Zs]],[Pe+ao]:[3,ds,[ys,Zs,Ee],e=>[Hn(...e)]],[ao]:[3,Cs,[ys,Zs,Ee],e=>No(Ft(...e))],InvalidCell:[3,Ns],[Pe+Ri]:[0,Ws,[],()=>[Mt()]],[Ri]:[0,ks],[J1]:[0,zs],[Pe+sn]:[1,_,[be],e=>[Un(...e)]],[sn]:[1,C,[be],e=>No(kt(e[0]))],InvalidValue:[1,hs]},([e,i,r,l],u)=>{is[H1+u+z1]=(...h)=>$s(h[e],i[h[e+1]?1:0],e>0?Pr(h,0,e):void 0,r,l)}),ll(is)},{PureComponent:yf,createContext:Th,useCallback:Rt,useContext:Lh,useEffect:Ch,useLayoutEffect:wf,useMemo:Vo,useRef:Ar,useState:pe,useSyncExternalStore:gh}=oa,fr=(s,...t)=>I(s)?{}:s(...t),Rf=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getLocalTableId(t),s==null?void 0:s.getRemoteTableId(t)],Ef=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getTableId(t)],qo="tinybaseInspector",ji="TinyBase Inspector",Tl=["left","top","bottom","right","full"],ae="state",Ko="sort",xi="open",Xo="position",Zo=xi,Fr="editable",gt=(...s)=>Gt(s),yc=(s,t)=>vs(il([...s]),t),wc=(s,t)=>[!!We(ae,s,Fr,t),Rt(n=>{t.setCell(ae,s,Fr,o=>!o),n.preventDefault()},[t,s])],Vf=({s})=>{const t=ie(Xo,s)??1,n=So(Zo,()=>!0,[],s);return ie(Zo,s)?null:T.jsx("img",{onClick:n,title:ji,"data-position":t})},Ll="editable",bf="←",jf="↑",xf="→",Pf="↓",kr=(s,t)=>vs(hc(s,t),n=>s+sl+n),Oo=(s,t,n)=>{const o=Rt(s,t);return n?o:void 0},Rc=(...s)=>Vo(()=>s,s),Cl=(s,t)=>Vo(()=>({store:s,tableId:t}),[s,t]),mf=(s,t)=>Vo(()=>({queries:s,queryId:t}),[s,t]),gl=(s,t=!1,n,o=0,c,a,f,L)=>{const[[$,d,S],g]=pe([s,t,o]),w=Rt(m=>{g(m),L==null||L(m)},[L]),R=Oo(m=>w([m,m==$?!d:!1,S]),[w,$,d,S],n),E=Rt(m=>w([$,d,m]),[w,$,d]),V=f===!0?_f:f;return[[$,d,S],R,Vo(()=>f===!1?null:T.jsx(V,{offset:S,limit:c,total:a,onChange:E}),[f,V,S,c,a,E])]},Ec=(s,t,n)=>Vo(()=>{const o=t??s;return Qt(To(o)?lo(vs(o,c=>[c,c])):o,(c,a)=>({label:a,component:n,...X1(c)?{label:c}:c}))},[t,n,s]),dr=({className:s,headerRow:t,idColumn:n,params:[o,c,a,f,L,$]})=>T.jsxs("table",{className:s,children:[$?T.jsx("caption",{children:$}):null,t===!1?null:T.jsx("thead",{children:T.jsxs("tr",{children:[n===!1?null:T.jsx(_r,{sort:f??[],label:"Id",onClick:L}),tn(o,({label:d},S)=>T.jsx(_r,{cellId:S,label:d,sort:f??[],onClick:L},S))]})}),T.jsx("tbody",{children:vs(a,d=>T.jsxs("tr",{children:[n===!1?null:T.jsx("th",{children:d}),tn(o,({component:S,getComponentProps:g},w)=>T.jsx("td",{children:T.jsx(S,{...fr(g,d,w),...c,rowId:d,cellId:w})},w))]},d))})]}),_r=({cellId:s,sort:[t,n],label:o=s??Kt,onClick:c})=>T.jsxs("th",{onClick:Oo(()=>c==null?void 0:c(s),[c,s],c),className:I(n)||t!=s?void 0:`sorted ${n?"de":"a"}scending`,children:[I(n)||t!=s?null:(n?Pf:jf)+" ",o]}),Df=({localRowId:s,params:[t,n,o,c,a,f,L]})=>{const $=sr(a,s,f);return T.jsxs("tr",{children:[t===!1?null:T.jsxs(T.Fragment,{children:[T.jsx("th",{children:s}),T.jsx("th",{children:$})]}),tn(n,({component:d,getComponentProps:S},g)=>{const[w,R]=Q1(g,sl,2),E=w===o?s:w===c?$:null;return I(E)?null:T.jsx("td",{children:T.jsx(d,{...fr(S,E,R),store:L,tableId:w,rowId:E,cellId:R})},g)})]})},$l=({thing:s,onThingChange:t,className:n,hasSchema:o,showType:c=!0})=>{const[a,f]=pe(),[L,$]=pe(),[d,S]=pe(),[g,w]=pe(),[R,E]=pe();L!==s&&(f(Qe(s)),$(s),S(String(s)),w(Number(s)||0),E(!!s));const V=Rt((p,j)=>{j(p),$(p),t(p)},[t]),m=Rt(()=>{if(!(o!=null&&o())){const p=Li(a,gc,tl,Cc),j=Li(p,d,g,R);f(p),$(j),t(j)}},[o,t,d,g,R,a]);return T.jsxs("div",{className:n,children:[c?T.jsx("button",{className:a,onClick:m,children:a}):null,Li(a,T.jsx("input",{value:d,onChange:Rt(p=>V(String(p[Ke][br]),S),[V])},a),T.jsx("input",{type:"number",value:g,onChange:Rt(p=>V(Number(p[Ke][br]||0),w),[V])},a),T.jsx("input",{type:"checkbox",checked:R,onChange:Rt(p=>V(!!p[Ke].checked,E),[V])},a))]})},Nf=({tableId:s,cellId:t,descending:n,offset:o,limit:c,store:a,editable:f,sortOnClick:L,paginator:$=!1,onChange:d,customCells:S,...g})=>{const[w,R,E]=gl(t,n,L,o,c,ba(s,a),$,d);return T.jsx(dr,{...g,params:Rc(Ec(hc(s,a),S,f?hr:Ro),Cl(a,s),Yi(s,...w,c,a),w,R,E)})},vf=({store:s,editable:t=!1,valueComponent:n=t?kf:ir,getValueComponentProps:o,className:c,headerRow:a,idColumn:f})=>T.jsxs("table",{className:c,children:[a===!1?null:T.jsx("thead",{children:T.jsxs("tr",{children:[f===!1?null:T.jsx("th",{children:"Id"}),T.jsx("th",{children:sn})]})}),T.jsx("tbody",{children:vs(Sc(s),L=>T.jsxs("tr",{children:[f===!1?null:T.jsx("th",{children:L}),T.jsx("td",{children:T.jsx(n,{...fr(o,L),valueId:L,store:s})})]},L))})]}),pf=({indexId:s,sliceId:t,indexes:n,editable:o,customCells:c,...a})=>{const[f,L,$]=Ef(ge(n),s);return T.jsx(dr,{...a,params:Rc(Ec(hc($,L),c,o?hr:Ro),Cl(L,$),Oi(s,t,f))})},Af=({relationshipId:s,relationships:t,editable:n,customCells:o,className:c,headerRow:a,idColumn:f=!0})=>{const[L,$,d,S]=Rf(Lt(t),s),g=Ec([...kr(d,$),...kr(S,$)],o,n?hr:Ro),w=Rc(f,g,d,S,s,L,$);return T.jsxs("table",{className:c,children:[a===!1?null:T.jsx("thead",{children:T.jsxs("tr",{children:[f===!1?null:T.jsxs(T.Fragment,{children:[T.jsxs("th",{children:[d,".Id"]}),T.jsxs("th",{children:[S,".Id"]})]}),tn(g,({label:R},E)=>T.jsx("th",{children:R},E))]})}),T.jsx("tbody",{children:vs(Gi(d,$),R=>T.jsx(Df,{localRowId:R,params:w},R))})]})},Ff=({queryId:s,cellId:t,descending:n,offset:o,limit:c,queries:a,sortOnClick:f,paginator:L=!1,customCells:$,onChange:d,...S})=>{const[g,w,R]=gl(t,n,f,o,c,za(s,a),L,d);return T.jsx(dr,{...S,params:Rc(Ec(Ma(s,a),$,rr),mf(a,s),er(s,...g,c,a),g,w,R)})},hr=({tableId:s,rowId:t,cellId:n,store:o,className:c,showType:a})=>{var f;return T.jsx($l,{thing:We(s,t,n,o),onThingChange:wo(s,t,n,L=>L,[],o),className:c??Ll+ao,showType:a,hasSchema:(f=M(o))==null?void 0:f.hasTablesSchema})},kf=({valueId:s,store:t,className:n,showType:o})=>{var c;return T.jsx($l,{thing:ie(s,t),onThingChange:So(s,a=>a,[],t),className:n??Ll+sn,showType:o,hasSchema:(c=M(t))==null?void 0:c.hasValuesSchema})},_f=({onChange:s,total:t,offset:n=0,limit:o=t,singular:c="row",plural:a=c+"s"})=>{(n>t||n<0)&&(n=0,s(0));const f=Oo(()=>s(n-o),[s,n,o],n>0),L=Oo(()=>s(n+o),[s,n,o],n+o<t);return T.jsxs(T.Fragment,{children:[t>o&&T.jsxs(T.Fragment,{children:[T.jsx("button",{className:"previous",disabled:n==0,onClick:f,children:bf}),T.jsx("button",{className:"next",disabled:n+o>=t,onClick:L,children:xf}),n+1," to ",Y1(t,n+o)," of "]}),t," ",t!=1?a:c]})},$t=({uniqueId:s,summary:t,editable:n,handleEditable:o,children:c,s:a})=>{const f=!!We(ae,s,xi,a),L=wo(ae,s,xi,$=>$[Ke].open,[],a);return T.jsxs("details",{open:f,onToggle:L,children:[T.jsxs("summary",{children:[t,o?T.jsx("img",{onClick:o,className:n?"done":"edit"}):null]}),c]})},Mf=({indexes:s,indexesId:t,indexId:n,s:o})=>T.jsx($t,{uniqueId:gt("i",t,n),summary:"Index: "+n,s:o,children:vs(Zi(n,s),c=>T.jsx(zf,{indexes:s,indexesId:t,indexId:n,sliceId:c,s:o},c))}),zf=({indexes:s,indexesId:t,indexId:n,sliceId:o,s:c})=>{const a=gt("i",t,n,o),[f,L]=wc(a,c);return T.jsx($t,{uniqueId:a,summary:"Slice: "+o,editable:f,handleEditable:L,s:c,children:T.jsx(pf,{sliceId:o,indexId:n,indexes:s,editable:f})})},Mr=({indexesId:s,s:t})=>{const n=Xi(s),o=Na(n);return I(n)?null:T.jsx($t,{uniqueId:gt("i",s),summary:"Indexes: "+(s??nt),s:t,children:wt(o)?"No indexes defined":yc(o,c=>T.jsx(Mf,{indexes:n,indexesId:s,indexId:c,s:t},c))})},Hf=({metrics:s,metricId:t})=>T.jsxs("tr",{children:[T.jsx("th",{children:t}),T.jsx("td",{children:s==null?void 0:s.getTableId(t)}),T.jsx("td",{children:Ki(t,s)})]}),zr=({metricsId:s,s:t})=>{const n=qi(s),o=ma(n);return I(n)?null:T.jsx($t,{uniqueId:gt("m",s),summary:"Metrics: "+(s??nt),s:t,children:wt(o)?"No metrics defined":T.jsxs("table",{children:[T.jsxs("thead",{children:[T.jsx("th",{children:"Metric Id"}),T.jsx("th",{children:"Table Id"}),T.jsx("th",{children:"Metric"})]}),T.jsx("tbody",{children:vs(o,c=>T.jsx(Hf,{metrics:n,metricId:c},c))})]})})},Uf=({queries:s,queriesId:t,queryId:n,s:o})=>{const c=gt("q",t,n),[a,f,L]=ke(We(ae,c,Ko,o)??"[]"),$=wo(ae,c,Ko,Gt,[],o);return T.jsx($t,{uniqueId:c,summary:"Query: "+n,s:o,children:T.jsx(Ff,{queryId:n,queries:s,cellId:a,descending:f,offset:L,limit:10,paginator:!0,sortOnClick:!0,onChange:$})})},Hr=({queriesId:s,s:t})=>{const n=tr(s),o=_a(n);return I(n)?null:T.jsx($t,{uniqueId:gt("q",s),summary:"Queries: "+(s??nt),s:t,children:wt(o)?"No queries defined":yc(o,c=>T.jsx(Uf,{queries:n,queriesId:s,queryId:c,s:t},c))})},Wf=({relationships:s,relationshipsId:t,relationshipId:n,s:o})=>{const c=gt("r",t,n),[a,f]=wc(c,o);return T.jsx($t,{uniqueId:c,summary:"Relationship: "+n,editable:a,handleEditable:f,s:o,children:T.jsx(Af,{relationshipId:n,relationships:s,editable:a})})},Ur=({relationshipsId:s,s:t})=>{const n=Ii(s),o=pa(n);return I(n)?null:T.jsx($t,{uniqueId:gt("r",s),summary:"Relationships: "+(s??nt),s:t,children:wt(o)?"No relationships defined":yc(o,c=>T.jsx(Wf,{relationships:n,relationshipsId:s,relationshipId:c,s:t},c))})},Bf=({tableId:s,store:t,storeId:n,s:o})=>{const c=gt("t",n,s),[a,f,L]=ke(We(ae,c,Ko,o)??"[]"),$=wo(ae,c,Ko,Gt,[],o),[d,S]=wc(c,o);return T.jsx($t,{uniqueId:c,summary:Fe+": "+s,editable:d,handleEditable:S,s:o,children:T.jsx(Nf,{tableId:s,store:t,cellId:a,descending:f,offset:L,limit:10,paginator:!0,sortOnClick:!0,onChange:$,editable:d})})},Jf=({store:s,storeId:t,s:n})=>{const o=gt("v",t),[c,a]=wc(o,n);return wt(Sc(s))?null:T.jsx($t,{uniqueId:o,summary:Ri,editable:c,handleEditable:a,s:n,children:T.jsx(vf,{store:s,editable:c})})},Wr=({storeId:s,s:t})=>{const n=Ji(s),o=Qi(n);return I(n)?null:T.jsxs($t,{uniqueId:gt("s",s),summary:(n.isMergeable()?"Mergeable":"")+"Store: "+(s??nt),s:t,children:[T.jsx(Jf,{storeId:s,store:n,s:t}),yc(o,c=>T.jsx(Bf,{store:n,storeId:s,tableId:c,s:t},c))]})},Qf=({s})=>{const t=Ar(null),n=Ar(0),[o,c]=pe(!1),{scrollLeft:a,scrollTop:f}=xa(s);wf(()=>{const j=t.current;if(j&&!o){const Ls=new MutationObserver(()=>{j.scrollWidth>=xr(a)+j.clientWidth&&j.scrollHeight>=xr(f)+j.clientHeight&&j.scrollTo(a,f)});return Ls.observe(j,{childList:!0,subtree:!0}),()=>Ls.disconnect()}},[o,a,f]);const L=Rt(j=>{const{scrollLeft:Ls,scrollTop:Rs}=j[Ke];cancelIdleCallback(n.current),n.current=requestIdleCallback(()=>{c(!0),s.setPartialValues({scrollLeft:Ls,scrollTop:Rs})})},[s]),$=Ji(),d=Va(),S=qi(),g=Pa(),w=Xi(),R=Da(),E=Ii(),V=va(),m=tr(),p=ka();return I($)&&wt(d)&&I(S)&&wt(g)&&I(w)&&wt(R)&&I(E)&&wt(V)&&I(m)&&wt(p)?T.jsx("span",{className:"warn",children:"There are no Stores or other objects to inspect. Make sure you placed the Inspector inside a Provider component."}):T.jsxs("article",{ref:t,onScroll:L,children:[T.jsx(Wr,{s}),vs(d,j=>T.jsx(Wr,{storeId:j,s},j)),T.jsx(zr,{s}),vs(g,j=>T.jsx(zr,{metricsId:j,s},j)),T.jsx(Mr,{s}),vs(R,j=>T.jsx(Mr,{indexesId:j,s},j)),T.jsx(Ur,{s}),vs(V,j=>T.jsx(Ur,{relationshipsId:j,s},j)),T.jsx(Hr,{s}),vs(p,j=>T.jsx(Hr,{queriesId:j,s},j))]})};class Gf extends yf{constructor(n){super(n);$r(this,"componentDidCatch",(n,o)=>console.error(n,o.componentStack));this.state={e:0}}static getDerivedStateFromError(){return{e:1}}render(){return this.state.e?T.jsx("span",{className:"warn",children:"Inspector error: please see console for details."}):this.props.children}}const Yf=({s})=>{const t=ie(Xo,s)??1,n=So(Zo,()=>!1,[],s),o=So(Xo,c=>Number(c[Ke].dataset.id),[],s);return T.jsxs("header",{children:[T.jsx("img",{title:ji}),T.jsx("span",{children:ji}),vs(Tl,(c,a)=>a==t?null:T.jsx("img",{onClick:o,"data-id":a,title:"Dock to "+c},a)),T.jsx("img",{onClick:n,title:"Close"})]})},qf=({s})=>{const t=ie(Xo,s)??1;return ie(Zo,s)?T.jsxs("main",{"data-position":t,children:[T.jsx(Yf,{s}),T.jsx(Gf,{children:T.jsx(Qf,{s})})]}):null};var Kf="data:image/svg+xml,%3csvg viewBox='0 0 680 680' xmlns='http://www.w3.org/2000/svg' style='width:680px%3bheight:680px'%3e %3cpath stroke='white' stroke-width='80' fill='none' d='M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z' /%3e %3cpath fill='%23d81b60' d='M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z' /%3e %3cpath d='M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z' /%3e%3c/svg%3e";const yl="M20 80l5-15l40-40l10 10l-40 40l-15 5m5-15l10 10",wl='content:url("',Rl='")',Vc=wl+"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' stroke-width='4' stroke='white' fill='none'>",bc="</svg>"+Rl,Br=wl+Kf+Rl,Xf=vs([[20,20,20,60],[20,20,60,20],[20,60,60,20],[60,20,20,60],[30,30,40,40]],([s,t,n,o])=>Vc+`<rect x='20' y='20' width='60' height='60' fill='grey'/><rect x='${s}' y='${t}' width='${n}' height='${o}' fill='white'/>`+bc),Zf=Vc+"<path d='M20 20l60 60M20 80l60-60' />"+bc,Of=Vc+`<path d='${yl}' />`+bc,If=Vc+`<path d='${yl}M20 20l60 60' />`+bc,In="*::-webkit-scrollbar",sd=tf(tn({"":"all:initial;font-family:sans-serif;font-size:0.75rem;position:fixed;z-index:999999","*":"all:revert","*::before":"all:revert","*::after":"all:revert",[In]:"width:0.5rem;height:0.5rem;",[In+"-track"]:"background:#111",[In+"-thumb"]:"background:#999;border:1px solid #111",[In+"-thumb:hover"]:"background:#fff",[In+"-corner"]:"background:#111",img:"width:1rem;height:1rem;background:#111;border:0;vertical-align:text-bottom",">img":"padding:0.25rem;bottom:0;right:0;position:fixed;"+Br,...lo(vs(["bottom:0;left:0","top:0;right:0"],(s,t)=>[`>img[data-position='${t}']`,s])),main:"display:flex;flex-direction:column;background:#111d;color:#fff;position:fixed;",...lo(vs(["bottom:0;left:0;width:35vw;height:100vh","top:0;right:0;width:100vw;height:30vh","bottom:0;left:0;width:100vw;height:30vh","top:0;right:0;width:35vw;height:100vh","top:0;right:0;width:100vw;height:100vh"],(s,t)=>[`main[data-position='${t}']`,s])),header:"display:flex;padding:0.25rem;background:#000;align-items:center","header>img:nth-of-type(1)":Br,"header>img:nth-of-type(6)":Zf,...lo(vs(Xf,(s,t)=>[`header>img[data-id='${t}']`,s])),"header>span":"flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-left:0.25rem",article:"padding:0.25rem 0.25rem 0.25rem 0.5rem;overflow:auto;flex:1",details:"margin-left:0.75rem;width:fit-content;","details img":"display:none","details[open]>summary img":"display:unset;background:none;margin-left:0.25rem","details[open]>summary img.edit":Of,"details[open]>summary img.done":If,summary:"margin-left:-0.75rem;line-height:1.25rem;user-select:none;width:fit-content",table:"border-collapse:collapse;table-layout:fixed;margin-bottom:0.5rem","table input":"background:#111;color:unset;padding:0 0.25rem;border:0;font-size:unset;vertical-align:top;margin:0",'table input[type="number"]':"width:4rem","table tbody button":"font-size:0;background:#fff;border-radius:50%;margin:0 0.125rem 0 0;width:0.85rem;color:#111","table button:first-letter":"font-size:0.75rem",thead:"background:#222","th:nth-of-type(1)":"min-width:2rem;","th.sorted":"background:#000","table caption":"text-align:left;white-space:nowrap;line-height:1.25rem",button:"width:1.5rem;border:none;background:none;color:#fff;padding:0","button[disabled]":"color:#777","button.next":"margin-right:0.5rem",[`th,#${qo} td`]:"overflow:hidden;text-overflow:ellipsis;padding:0.25rem 0.5rem;max-width:12rem;white-space:nowrap;border-width:1px 0;border-style:solid;border-color:#777;text-align:left","span.warn":"margin:0.25rem;color:#d81b60"},(s,t)=>s?`#${qo} ${t}{${s}}`:"")),$h=({position:s="right",open:t=!1})=>{const n=Ea(Sl),o=Tl.indexOf(s);return Ga(n,c=>gf(c,qo),void 0,async c=>{await c.load([{},{position:o==-1?1:o,open:!!t}]),await c.startAutoSave()}),T.jsxs(T.Fragment,{children:[T.jsxs("aside",{id:qo,children:[T.jsx(Vf,{s:n}),T.jsx(qf,{s:n})]}),T.jsx("style",{children:sd})]})},Io="",El="￼",td=globalThis,Jr=td.window,Et=s=>s==null,sc=(s,t,n)=>Et(s)?n==null?void 0:n():t(s),Pi=s=>Array.isArray(s),_e=s=>s.length,ed=(s,t)=>s.test(t),Vl=s=>{throw new Error(s)},Ge=async(s,t,n)=>{try{return await s()}catch(o){t==null||t(o)}},mi=(s,t)=>s.forEach(t),nd=(s,t)=>s.splice(0,t),Sr=(s,...t)=>s.push(...t),bl=s=>s.shift(),jc=Object,Qr=s=>jc.getPrototypeOf(s),od=s=>!Et(s)&&sc(Qr(s),t=>t==jc.prototype||Et(Qr(t)),()=>!0),cd=jc.keys,id=jc.freeze,rd=s=>_e(cd(s)),po=s=>od(s)&&rd(s)==0,ad=JSON.stringify,jl=JSON.parse,ld=s=>ad(s,(t,n)=>n===void 0?El:n),ud=s=>jl(s,(t,n)=>n===El?void 0:n),fd=s=>(s==null?void 0:s.size)??0,dd=(s,t)=>(s==null?void 0:s.has(t))??!1,xl=s=>Et(s)||fd(s)==0,Pl=(s,t)=>s==null?void 0:s.forEach(t),ml=(s,t)=>s==null?void 0:s.delete(t),bo=s=>new Map(s),ut=(s,t)=>s==null?void 0:s.get(t),Me=(s,t,n)=>Et(n)?(ml(s,t),s):s==null?void 0:s.set(t,n),Di=(s,t,n,o)=>(dd(s,t)?o==null||o(ut(s,t)):Me(s,t,n()),ut(s,t)),Ni=(s,t,n,o,c=0)=>sc((n?Di:ut)(s,t[c],c>_e(t)-2?n:bo),a=>{if(c>_e(t)-2)return o!=null&&o(a)&&Me(s,t[c]),a;const f=Ni(a,t,n,o,c+1);return xl(a)&&Me(s,t[c]),f}),hd=/^\d+$/,Sd=()=>{const s=[];let t=0;return[n=>(n?bl(s):null)??Io+t++,n=>{ed(hd,n)&&_e(s)<1e3&&Sr(s,n)}]},Td=s=>new Set(Pi(s)||Et(s)?s:[s]),Ld=(s,t)=>s==null?void 0:s.add(t),Cd=(s,t=[Io])=>{const n=[],o=(c,a)=>a==_e(t)?Sr(n,c):t[a]===null?Pl(c,f=>o(f,a+1)):mi([t[a],null],f=>o(ut(c,f),a+1));return o(s,0),n},gd=s=>{let t;const[n,o]=Sd(),c=bo();return[(d,S,g,w=[],R=()=>[])=>{t??(t=s());const E=n(1);return Me(c,E,[d,S,g,w,R]),Ld(Ni(S,g??[Io],Td),E),E},(d,S,...g)=>mi(Cd(d,S),w=>Pl(w,R=>ut(c,R)[0](t,...S??[],...g))),d=>sc(ut(c,d),([,S,g])=>(Ni(S,g??[Io],void 0,w=>(ml(w,d),xl(w)?1:0)),Me(c,d),o(d),g)),d=>sc(ut(c,d),([S,,g=[],w,R])=>{const E=(...V)=>{var p;const m=_e(V);m==_e(g)?S(t,...V,...R(V)):Et(g[m])?mi(((p=w[m])==null?void 0:p.call(w,...V))??[],j=>E(...V,j)):E(...V,g[m])};E()})]},Ao=bo(),Fo=bo(),$d=(s=1,t,n)=>s!=1&&t.isMergeable()?[1,t.getMergeableContent,()=>t.getTransactionMergeableChanges(!n),([[o],[c]])=>!po(o)||!po(c),t.setDefaultContent]:s!=2?[0,t.getContent,t.getTransactionChanges,([o,c])=>!po(o)||!po(c),t.setContent]:Vl("Store type not supported by this Persister"),yd=(s,t,n,o,c,a,f,L={},$=0,d=[])=>{let S=0,g=0,w=0,R,E,V;Di(Ao,d,()=>0),Di(Fo,d,()=>[]);const m=bo(),[p,j,Ls,Rs,gs]=$d(f,s,$),[us,x,z]=gd(()=>_),ss=C=>{C!=S&&(S=C,x(m,void 0,S))},F=async()=>{if(!ut(Ao,d)){for(Me(Ao,d,1);!Et(R=bl(ut(Fo,d)));)await Ge(R,a);Me(Ao,d,0)}},Z=C=>{(p&&Pi(C==null?void 0:C[0])?(C==null?void 0:C[2])===1?s.applyMergeableChanges:s.setMergeableContent:(C==null?void 0:C[2])===1?s.applyChanges:s.setContent)(C)},as=async C=>(S!=2&&(ss(1),g++,await hs(async()=>{await Ge(async()=>{const A=await t();Pi(A)?Z(A):C?gs(C):Vl(`Content is not an array: ${A}`)},()=>{C&&gs(C)}),ss(0)})),_),es=async C=>(D(),await as(C),await Ge(async()=>E=await o(async(A,Y)=>{Y||A?S!=2&&(ss(1),g++,Z(Y??A),ss(0)):await as()}),a),_),D=async()=>(E&&(await Ge(()=>c(E),a),E=void 0),_),O=()=>!Et(E),ns=async C=>(S!=1&&(ss(2),w++,await hs(async()=>{await Ge(()=>n(j,C),a),ss(0)})),_),os=async()=>(ts(),await ns(),V=s.addDidFinishTransactionListener(()=>{const C=Ls();Rs(C)&&ns(C)}),_),ts=async()=>(V&&(s.delListener(V),V=void 0),_),bs=()=>!Et(V),Es=async(C,A=!1)=>{const[Y,$s]=A?[os,es]:[es,os];return await Y(C),await $s(C),_},G=async(C=!1)=>{const[A,Y]=C?[ts,D]:[D,ts];return await A(),await Y(),_},ds=()=>S,Cs=C=>us(C,m),Ns=C=>(z(C),s),hs=async(...C)=>(Sr(ut(Fo,d),...C),await F(),_),_={load:as,startAutoLoad:es,stopAutoLoad:D,isAutoLoading:O,save:ns,startAutoSave:os,stopAutoSave:ts,isAutoSaving:bs,startAutoPersisting:Es,stopAutoPersisting:G,getStatus:ds,addStatusListener:Cs,delListener:Ns,schedule:hs,getStore:()=>s,destroy:()=>(nd(ut(Fo,d)),G()),getStats:()=>({loads:g,saves:w}),...L};return id(_)},Gr="storage",Dl=(s,t,n,o)=>yd(s,async()=>ud(n.getItem(t)),async $=>n.setItem(t,ld($())),$=>{const d=S=>{S.storageArea===n&&S.key===t&&Ge(()=>$(jl(S.newValue)),$)};return Jr.addEventListener(Gr,d),d},$=>Jr.removeEventListener(Gr,$),o,3,{getStorageName:()=>t}),yh=(s,t,n)=>Dl(s,t,localStorage,n),wh=(s,t,n)=>Dl(s,t,sessionStorage,n),le=s=>typeof s,ue="",Nl=le(ue),wd=le(!0),vl=le(0),Rd=le(le),ko="type",De="default",Ed="Listener",Vd="add",Ne="Has",xc="Ids",Ye="Table",Yr=Ye+"s",bd=Ye+xc,tc="Row",jd=tc+"Count",xd=tc+xc,Bo="Cell",qr=Bo+xc,ec="Value",Kr=ec+"s",Pd=ec+xc,ls=s=>ue+s,md=isFinite,Dd=(s,t)=>s instanceof t,Vs=s=>s==null,Ds=(s,t,n)=>Vs(s)?n==null?void 0:n():t(s),pl=s=>s==Nl||s==wd,Nd=s=>le(s)==Nl,Ci=s=>le(s)==Rd,en=s=>Array.isArray(s),Xr=(s,t,n)=>s.slice(t,n),xt=s=>s.length,vd=(s,t)=>s.test(t),gi=async(s,t,n)=>{try{return await s()}catch(o){t==null||t(o)}},pd=(s,t)=>s.includes(t),Al=(s,t)=>s.every(t),Fl=(s,t)=>xt(s)===xt(t)&&Al(s,(n,o)=>t[o]===n),Zr=(s,t)=>Al(s,(n,o)=>o==0||t(s[o-1],n)<=0),vi=(s,t)=>s.sort(t),qt=(s,t)=>s.forEach(t),go=(s,t)=>s.map(t),Ad=s=>xt(s)==0,Fd=(s,t,n)=>s.reduce(t,n),nc=(s,...t)=>s.push(...t),kd=s=>s.shift(),so=s=>{const t=le(s);return pl(t)||t==vl&&md(s)?t:void 0},Or=(s,t,n,o,c)=>Vs(c)?s.delCell(t,n,o,!0):s.setCell(t,n,o,c),Ir=(s,t,n)=>Vs(n)?s.delValue(t):s.setValue(t,n),Tr=s=>t=>Fd(Cr(t),(n,o)=>n+s(o),0),Lr=s=>(s==null?void 0:s.size)??0,Pc=Tr(Lr),qe=Tr(Pc),$i=Tr(qe),ps=(s,t)=>(s==null?void 0:s.has(t))??!1,B=s=>Vs(s)||Lr(s)==0,Cr=s=>[...(s==null?void 0:s.values())??[]],uo=s=>s.clear(),J=(s,t)=>s==null?void 0:s.forEach(t),ce=(s,t)=>s==null?void 0:s.delete(t),ye=Object,sa=s=>ye.getPrototypeOf(s),kl=ye.entries,_d=ye.isFrozen,oc=s=>!Vs(s)&&Ds(sa(s),t=>t==ye.prototype||Vs(sa(t)),()=>!0),Md=ye.keys,_l=ye.freeze,zd=(s=[])=>ye.fromEntries(s),ro=(s,t)=>t in s,Ml=(s,t)=>(delete s[t],s),Hd=(s,t)=>qt(kl(s),([n,o])=>t(o,n)),Ud=(s,t)=>go(kl(s),([n,o])=>t(o,n)),ee=(s,t)=>zd(Ud(s,(n,o)=>[o,t(n,o)])),Wd=s=>xt(Md(s)),yt=s=>oc(s)&&Wd(s)==0,se=(s,t,n,o=0)=>Vs(s)||!oc(s)||!o&&yt(s)||_d(s)?(n==null||n(),!1):(Hd(s,(c,a)=>{t(c,a)||Ml(s,a)}),o?!0:!yt(s)),k=s=>new Map(s),Ae=s=>[...(s==null?void 0:s.keys())??[]],b=(s,t)=>s==null?void 0:s.get(t),Os=(s,t)=>J(s,(n,o)=>t(o,n)),Bd=(s,t)=>go([...(s==null?void 0:s.entries())??[]],([n,o])=>t(o,n)),W=(s,t,n)=>Vs(n)?(ce(s,t),s):s==null?void 0:s.set(t,n),_s=(s,t,n,o)=>(ps(s,t)?o==null||o(b(s,t)):W(s,t,n()),b(s,t)),ve=(s,t,n,o=W)=>(ee(t,(c,a)=>n(s,a,c)),Os(s,c=>ro(t,c)?0:o(s,c)),s),Ks=(s,t,n,o)=>{const c={};return J(s,(a,f)=>{if(!(n!=null&&n(a,f))){const L=t?t(a,f):a;o!=null&&o(L)||(c[f]=L)}}),c},pi=(s,t,n)=>Ks(s,o=>Ks(o,t,n),B,yt),_o=(s,t,n)=>Ks(s,o=>pi(o,t,n),B,yt),oe=(s,t)=>{const n=k();return J(s,(o,c)=>n.set(c,(t==null?void 0:t(o))??o)),n},Ai=s=>oe(s,oe),yi=s=>oe(s,Ai),Fi=(s,t,n,o,c=0)=>Ds((n?_s:b)(s,t[c],c>xt(t)-2?n:k),a=>{if(c>xt(t)-2)return o!=null&&o(a)&&W(s,t[c]),a;const f=Fi(a,t,n,o,c+1);return B(a)&&W(s,t[c]),f}),ot=s=>new Set(en(s)||Vs(s)?s:[s]),Is=(s,t)=>s==null?void 0:s.add(t),Jd=(s,t,n,o,c)=>{const a=s.hasRow,f=k(),L=k(),$=k(),d=k(),S=k(),g=k(),w=()=>s,R=()=>Ae(f),E=F=>Os(L,F),V=F=>ps(L,F),m=F=>b(f,F),p=F=>b(L,F),j=(F,Z)=>W(L,F,Z),Ls=(F,Z,...as)=>{const es=_s(g,F,ot);return qt(as,D=>Is(es,D)&&Z&&s.callListener(D)),as},Rs=(F,...Z)=>Ds(b(g,F),as=>{qt(Ad(Z)?Cr(as):Z,es=>{s.delListener(es),ce(as,es)}),B(as)&&W(g,F)}),gs=(F,Z)=>{W(f,F,Z),ps(L,F)||(W(L,F,t()),W(d,F,k()),W(S,F,k()),c($))},us=(F,Z,as,es,D)=>{gs(F,Z);const O=k(),ns=k(),os=b(d,F),ts=b(S,F),bs=G=>{const ds=hs=>s.getCell(Z,G,hs),Cs=b(os,G),Ns=a(Z,G)?n(es(ds,G)):void 0;if(Cs===Ns||en(Cs)&&en(Ns)&&Fl(Cs,Ns)||W(O,G,[Cs,Ns]),!Vs(D)){const hs=b(ts,G),Ws=a(Z,G)?D(ds,G):void 0;hs!=Ws&&W(ns,G,Ws)}},Es=G=>{as(()=>{J(O,([,ds],Cs)=>W(os,Cs,ds)),J(ns,(ds,Cs)=>W(ts,Cs,ds))},O,ns,os,ts,G),uo(O),uo(ns)};Os(os,bs),s.hasTable(Z)&&qt(s.getRowIds(Z),G=>{ps(os,G)||bs(G)}),Es(!0),Rs(F),Ls(F,0,s.addRowListener(Z,null,(G,ds,Cs)=>bs(Cs)),s.addTableListener(Z,()=>Es()))},x=F=>{W(f,F),W(L,F),W(d,F),W(S,F),Rs(F),c($)};return[w,R,E,V,m,p,j,gs,us,x,F=>o(F,$),()=>Os(g,x),Ls,Rs]},ta=(s,t)=>Nd(s)?n=>n(s):s??(()=>t??ue),Qd=(s,t)=>{const n=new WeakMap;return o=>{n.has(o)||n.set(o,s(o));const c=n.get(o);return t==null||t(c),c}},Gd=/^\d+$/,zl=()=>{const s=[];let t=0;return[n=>(n?kd(s):null)??ue+t++,n=>{vd(Gd,n)&&xt(s)<1e3&&nc(s,n)}]},Yd=(s,t=[ue])=>{const n=[],o=(c,a)=>a==xt(t)?nc(n,c):t[a]===null?J(c,f=>o(f,a+1)):qt([t[a],null],f=>o(b(c,f),a+1));return o(s,0),n},Hl=s=>{let t;const[n,o]=zl(),c=k();return[(d,S,g,w=[],R=()=>[])=>{t??(t=s());const E=n(1);return W(c,E,[d,S,g,w,R]),Is(Fi(S,g??[ue],ot),E),E},(d,S,...g)=>qt(Yd(d,S),w=>J(w,R=>b(c,R)[0](t,...S??[],...g))),d=>Ds(b(c,d),([,S,g])=>(Fi(S,g??[ue],void 0,w=>(ce(w,d),B(w)?1:0)),W(c,d),o(d),g)),d=>Ds(b(c,d),([S,,g=[],w,R])=>{const E=(...V)=>{var p;const m=xt(V);m==xt(g)?S(t,...V,...R(V)):Vs(g[m])?qt(((p=w[m])==null?void 0:p.call(w,...V))??[],j=>E(...V,j)):E(...V,g[m])};E()})]},Ul=(s,t)=>(s??0)<(t??0)?-1:1,Rh=Qd(s=>{const t=k(),n=k(),[o,c,a]=Hl(()=>es),[f,L,$,d,S,g,w,,R,E,V,m]=Jd(s,k,D=>Vs(D)?ue:en(D)?go(D,ls):ls(D),o,c),p=(D,O)=>ps(g(D),O),j=(D,O,ns,os,ts,bs=Ul)=>{const Es=Vs(ts)?void 0:([G],[ds])=>ts(G,ds);return R(D,O,(G,ds,Cs,Ns,hs,Ws)=>{let ks=0;const zs=ot(),_=ot(),C=g(D);if(J(ds,([A,Y],$s)=>{const U=ot(A),Zt=ot(Y);J(U,Bs=>ce(Zt,Bs)?ce(U,Bs):0),J(U,Bs=>{Is(zs,Bs),Ds(b(C,Bs),Be=>{ce(Be,$s),B(Be)&&(W(C,Bs),ks=1)})}),J(Zt,Bs=>{Is(zs,Bs),ps(C,Bs)||(W(C,Bs,ot()),ks=1),Is(b(C,Bs),$s),Vs(os)||Is(_,Bs)})}),G(),B(hs)||(Ws?Os(C,A=>Is(_,A)):Os(Cs,A=>Ds(b(Ns,A),Y=>qt(en(Y)?Y:[Y],$s=>Is(_,$s)))),J(_,A=>{const Y=(U,Zt)=>bs(b(hs,U),b(hs,Zt),A),$s=[...b(C,A)];Zr($s,Y)||(W(C,A,ot(vi($s,Y))),Is(zs,A))})),(ks||Ws)&&!Vs(Es)){const A=[...C];Zr(A,Es)||(w(D,k(vi(A,Es))),ks=1)}ks&&c(t,[D]),J(zs,A=>c(n,[D,A]))},ta(ns),Ds(os,ta)),es},Ls=D=>$((O,ns)=>D(O,os=>gs(O,os,ns))),Rs=(D,O)=>gs(D,O,g(D)),gs=(D,O,ns)=>{const os=S(D);J(ns,(ts,bs)=>O(bs,Es=>J(ts,G=>Es(G,ds=>s.forEachCell(os,G,ds)))))},es={setIndexDefinition:j,delIndexDefinition:D=>(E(D),es),getStore:f,getIndexIds:L,forEachIndex:Ls,forEachSlice:Rs,hasIndex:d,hasSlice:p,getTableId:S,getSliceIds:D=>Ae(g(D)),getSliceRowIds:(D,O)=>Cr(b(g(D),O)),addIndexIdsListener:V,addSliceIdsListener:(D,O)=>o(O,t,[D]),addSliceRowIdsListener:(D,O,ns)=>o(ns,n,[D,O]),delListener:D=>(a(D),es),destroy:m,getListenerStats:()=>({sliceIds:Pc(t),sliceRowIds:qe(n)})};return _l(es)}),qd=JSON.stringify,wi=JSON.parse,Je=s=>qd(s,(t,n)=>Dd(n,Map)?ye.fromEntries([...n]):n),Mo=s=>[s,s],Ps=(s,t=Pc)=>t(s[0])+t(s[1]),ms=()=>[k(),k()],ea=s=>[...s],zo=([s,t])=>s===t,to=(s,t,n)=>W(s,t,b(s,t)==-n?void 0:n),Kd=()=>{let s,t,n=!1,o=!1,c=0,a=[];const f=k(),L=k(),$=k(),d=k(),S=k(),g=k(),w=k(),R=k(),E=k(),V=k(),m=k(),p=k(),j=k(),Ls=k(),Rs=ot(),gs=k(),us=k(),x=k(),z=k(),ss=ms(),F=ms(),Z=ms(),as=ms(),es=ms(),D=ms(),O=ms(),ns=ms(),os=ms(),ts=ms(),bs=ms(),Es=ms(),G=ms(),ds=ms(),Cs=ms(),Ns=ms(),hs=ms(),Ws=ms(),ks=ms(),zs=ms(),_=ms(),C=ms(),A=k(),Y=ms(),[$s,U,Zt,Bs]=Hl(()=>is),Be=e=>se(e,i=>se(i,cn)),Dc=e=>se(e,cn),cn=e=>{if(!se(e,(r,l)=>pd([ko,De],l)))return!1;const i=e[ko];return!pl(i)&&i!=vl?!1:(so(e[De])!=i&&Ml(e,De),!0)},Nc=en,vc=e=>se(e,rn,Hs),rn=(e,i)=>(!s||ps(m,i)||Hs(i))&&se(e,(r,l)=>mt(i,l,r),()=>Hs(i)),mt=(e,i,r,l)=>se(l?r:fn(r,e,i),(u,h)=>Ds(an(e,i,h,u),y=>(r[h]=y,!0),()=>!1),()=>Hs(e,i)),an=(e,i,r,l)=>s?Ds(b(b(m,e),r),u=>so(l)!=u[ko]?Hs(e,i,r,l,u[De]):l,()=>Hs(e,i,r,l)):Vs(so(l))?Hs(e,i,r,l):l,ln=(e,i)=>se(i?e:pc(e),(r,l)=>Ds(un(l,r),u=>(e[l]=u,!0),()=>!1),()=>rt()),un=(e,i)=>t?Ds(b(j,e),r=>so(i)!=r[ko]?rt(e,i,r[De]):i,()=>rt(e,i)):Vs(so(i))?rt(e,i):i,fn=(e,i,r)=>(Ds(b(p,i),([l,u])=>{J(l,(h,y)=>{ro(e,y)||(e[y]=h)}),J(u,h=>{ro(e,h)||Hs(i,r,h)})}),e),pc=e=>(t&&(J(Ls,(i,r)=>{ro(e,r)||(e[r]=i)}),J(Rs,i=>{ro(e,i)||rt(i)})),e),dn=e=>ve(m,e,(i,r,l)=>{const u=k(),h=ot();ve(_s(m,r,k),l,(y,P,v)=>{W(y,P,v),Ds(v[De],Ss=>W(u,P,Ss),()=>Is(h,P))}),W(p,r,[u,h])},(i,r)=>{W(m,r),W(p,r)}),hn=e=>ve(j,e,(i,r,l)=>{W(j,r,l),Ds(l[De],u=>W(Ls,r,u),()=>Is(Rs,r))},(i,r)=>{W(j,r),W(Ls,r),ce(Rs,r)}),Sn=e=>yt(e)?Ut():zt(e),Ac=([e,i])=>{(yt(e)?Ut:zt)(e),(yt(i)?Wt:Ht)(i)},Tn=e=>ve(x,e,(i,r,l)=>Dt(r,l),(i,r)=>$n(r)),Dt=(e,i)=>ve(_s(x,e,()=>(En(e,1),W(gs,e,zl()),W(us,e,k()),k())),i,(r,l,u)=>it(e,r,l,u),(r,l)=>yn(e,r,l)),it=(e,i,r,l,u)=>ve(_s(i,r,()=>(Vn(e,r,1),k())),l,(h,y,P)=>we(e,r,h,y,P),(h,y)=>wn(e,i,r,h,y,u)),we=(e,i,r,l,u)=>{ps(r,l)||bn(e,i,l,1);const h=b(r,l);u!==h&&(jn(e,i,l,h,u),W(r,l,u))},Ln=(e,i,r,l,u)=>Ds(b(i,r),h=>we(e,r,h,l,u),()=>it(e,i,r,fn({[l]:u},e,r))),Cn=e=>yt(e)?Wt():Ht(e),gn=e=>ve(z,e,(i,r,l)=>Nt(r,l),(i,r)=>Rn(r)),Nt=(e,i)=>{ps(z,e)||xn(e,1);const r=b(z,e);i!==r&&(Pn(e,r,i),W(z,e,i))},Fc=(e,i)=>{const[r]=b(gs,e);let l;do l=r(i);while(ps(b(x,e),l));return l},vt=e=>b(x,e)??Dt(e,{}),$n=e=>Dt(e,{}),yn=(e,i,r)=>{const[,l]=b(gs,e);l(r),it(e,i,r,{},!0)},wn=(e,i,r,l,u,h)=>{var v;const y=b((v=b(p,e))==null?void 0:v[0],u);if(!Vs(y)&&!h)return we(e,r,l,u,y);const P=Ss=>{jn(e,r,Ss,b(l,Ss)),bn(e,r,Ss,-1),W(l,Ss)};Vs(y)?P(u):Os(l,P),B(l)&&(Vn(e,r,-1),B(W(i,r))&&(En(e,-1),W(x,e),W(gs,e),W(us,e)))},Rn=e=>{const i=b(Ls,e);if(!Vs(i))return Nt(e,i);Pn(e,b(z,e)),xn(e,-1),W(z,e)},En=(e,i)=>to(f,e,i),Vn=(e,i,r)=>to(_s(d,e,k),i,r)&&W($,e,_s($,e,()=>0)+r),bn=(e,i,r,l)=>{const u=b(us,e),h=b(u,r)??0;(h==0&&l==1||h==1&&l==-1)&&to(_s(L,e,k),r,l),W(u,r,h!=-l?h+l:null),to(_s(_s(S,e,k),i,k),r,l)},jn=(e,i,r,l,u)=>{var h;_s(_s(_s(g,e,k),i,k),r,()=>[l,0])[1]=u,(h=a[3])==null||h.call(a,e,i,r,u)},xn=(e,i)=>to(w,e,i),Pn=(e,i,r)=>{var l;_s(R,e,()=>[i,0])[1]=r,(l=a[4])==null||l.call(a,e,r)},Hs=(e,i,r,l,u)=>(nc(_s(_s(_s(E,e,k),i,k),r,()=>[]),l),u),rt=(e,i,r)=>(nc(_s(V,e,()=>[]),i),r),pt=(e,i,r)=>Ds(b(b(b(g,e),i),r),([l,u])=>[!0,l,u],()=>[!1,...Mo(Ft(e,i,r))]),mn=e=>Ds(b(R,e),([i,r])=>[!0,i,r],()=>[!1,...Mo(kt(e))]),Dn=e=>!B(E)&&!B(Ns[e])?J(e?yi(E):E,(i,r)=>J(i,(l,u)=>J(l,(h,y)=>U(Ns[e],[r,u,y],h)))):0,Nn=e=>!B(V)&&!B(hs[e])?J(e?oe(V):V,(i,r)=>U(hs[e],[r],i)):0,at=(e,i,r,l)=>{if(!B(e))return U(i,l,()=>Ks(e)),Os(e,(u,h)=>U(r,[...l??[],u],h==1)),1},vn=e=>{const i=_t();i!=n&&U(ss[e],void 0,i);const r=B(ts[e]),l=B(G[e])&&B(ds[e])&&B(os[e])&&B(bs[e])&&B(D[e])&&B(O[e])&&B(ns[e])&&r&&B(Z[e])&&B(as[e]),u=B(Cs[e])&&B(Es[e])&&B(es[e])&&B(F[e]);if(!l||!u){const h=e?[oe(f),Ai(L),oe($),Ai(d),yi(S),yi(g)]:[f,L,$,d,S,g];if(!l){at(h[0],Z[e],as[e]),J(h[1],(P,v)=>at(P,D[e],O[e],[v])),J(h[2],(P,v)=>{P!=0&&U(ns[e],[v],kn(v))});const y=ot();J(h[3],(P,v)=>{at(P,os[e],bs[e],[v])&&!r&&(U(ts[e],[v,null]),Is(y,v))}),r||J(h[5],(P,v)=>{if(!ps(y,v)){const Ss=ot();J(P,Us=>J(Us,([Bt,Jt],lt)=>Jt!==Bt?Is(Ss,lt):ce(Us,lt))),J(Ss,Us=>U(ts[e],[v,Us]))}}),J(h[4],(P,v)=>J(P,(Ss,Us)=>at(Ss,G[e],ds[e],[v,Us])))}if(!u){let y;J(h[5],(P,v)=>{let Ss;J(P,(Us,Bt)=>{let Jt;J(Us,([lt,Xn],ai)=>{Xn!==lt&&(U(Cs[e],[v,Bt,ai],Xn,lt,pt),y=Ss=Jt=1)}),Jt&&U(Es[e],[v,Bt],pt)}),Ss&&U(es[e],[v],pt)}),y&&U(F[e],void 0,pt)}}},pn=e=>{const i=Mt();i!=o&&U(Ws[e],void 0,i);const r=B(zs[e])&&B(_[e]),l=B(C[e])&&B(ks[e]);if(!r||!l){const u=e?[oe(w),oe(R)]:[w,R];if(r||at(u[0],zs[e],_[e]),!l){let h;J(u[1],([y,P],v)=>{P!==y&&(U(C[e],[v],P,y,mn),h=1)}),h&&U(ks[e],void 0,mn)}}},H=(e,...i)=>(xe(()=>e(...go(i,ls))),is),An=(e,i,r,l,u)=>{let h=At(e,i,...r);return $s(()=>{const y=At(e,i,...r);Fl(y,h)||(h=y,l(is,e,i,...r,h))},ts[u?1:0],[e,i],[ys])},kc=()=>[Re(),Ve()],Re=()=>_o(x),ys=()=>Ae(x),_c=e=>pi(b(x,ls(e))),Fn=e=>Ae(b(us,ls(e))),kn=e=>Lr(b(x,ls(e))),Zs=e=>Ae(b(x,ls(e))),At=(e,i,r,l=0,u)=>oc(e)?At(e.tableId,e.cellId,e.descending,e.offset,e.limit):go(Xr(vi(Bd(b(x,ls(e)),(h,y)=>[Vs(i)?y:b(h,ls(i)),y]),([h],[y])=>Ul(h,y)*(r?-1:1)),l,Vs(u)?u:l+u),([,h])=>h),Mc=(e,i)=>Ks(b(b(x,ls(e)),ls(i))),Ee=(e,i)=>Ae(b(b(x,ls(e)),ls(i))),Ft=(e,i,r)=>b(b(b(x,ls(e)),ls(i)),ls(r)),Ve=()=>Ks(z),be=()=>Ae(z),kt=e=>b(z,ls(e)),_t=()=>!B(x),_n=e=>ps(x,ls(e)),Mn=(e,i)=>ps(b(us,ls(e)),ls(i)),zn=(e,i)=>ps(b(x,ls(e)),ls(i)),Hn=(e,i,r)=>ps(b(b(x,ls(e)),ls(i)),ls(r)),Mt=()=>!B(z),Un=e=>ps(z,ls(e)),zc=()=>Je(x),Hc=()=>Je(z),Uc=()=>Je([x,z]),Wc=()=>Je(m),Bc=()=>Je(j),Jc=()=>Je([m,j]),Qc=e=>H(()=>{const i=Ci(e)?e():e;Nc(i)&&Ac(i)}),zt=e=>H(()=>vc(e)?Tn(e):0),Gc=(e,i)=>H(r=>rn(i,r)?Dt(r,i):0,e),Yc=(e,i,r)=>H((l,u)=>mt(l,u,r)?it(l,vt(l),u,r):0,e,i),qc=(e,i,r=!0)=>xe(()=>{let l;return mt(e,l,i)&&(e=ls(e),it(e,vt(e),l=Fc(e,r?1:0),i)),l}),Kc=(e,i,r)=>H((l,u)=>{if(mt(l,u,r,1)){const h=vt(l);ee(r,(y,P)=>Ln(l,h,u,P,y))}},e,i),Xc=(e,i,r,l)=>H((u,h,y)=>Ds(an(u,h,y,Ci(l)?l(Ft(u,h,y)):l),P=>Ln(u,vt(u),h,y,P)),e,i,r),Ht=e=>H(()=>ln(e)?gn(e):0),Zc=e=>H(()=>ln(e,1)?ee(e,(i,r)=>Nt(r,i)):0),Oc=(e,i)=>H(r=>Ds(un(r,Ci(i)?i(kt(r)):i),l=>Nt(r,l)),e),Ic=e=>H(()=>{ee(e[0],(i,r)=>Vs(i)?Qn(r):ee(i,(l,u)=>Vs(l)?Gn(r,u):ee(l,(h,y)=>Or(is,r,u,y,h)))),ee(e[1],(i,r)=>Ir(is,r,i))}),Wn=e=>(gi(()=>Sn(wi(e))),is),si=e=>(gi(()=>Cn(wi(e))),is),ti=e=>H(()=>gi(()=>{const[i,r]=wi(e);Sn(i),Cn(r)},()=>Wn(e))),Bn=e=>H(()=>{if((s=Be(e))&&(dn(e),!B(x))){const i=Re();Ut(),zt(i)}}),Jn=e=>H(()=>{if(t=Dc(e)){const i=Ve();je(),Wt(),t=!0,hn(e),Ht(i)}}),ei=(e,i)=>H(()=>{Bn(e),Jn(i)}),Ut=()=>H(()=>Tn({})),Qn=e=>H(i=>ps(x,i)?$n(i):0,e),Gn=(e,i)=>H((r,l)=>Ds(b(x,r),u=>ps(u,l)?yn(r,u,l):0),e,i),ni=(e,i,r,l)=>H((u,h,y)=>Ds(b(x,u),P=>Ds(b(P,h),v=>ps(v,y)?wn(u,P,h,v,y,l):0)),e,i,r),Wt=()=>H(()=>gn({})),oi=e=>H(i=>ps(z,i)?Rn(i):0,e),Yn=()=>H(()=>{dn({}),s=!1}),je=()=>H(()=>{hn({}),t=!1}),ci=()=>H(()=>{Yn(),je()}),xe=(e,i)=>{if(c!=-1){qn();const r=e();return Kn(i),r}},qn=()=>{var e;return c!=-1&&c++,c==1&&((e=a[0])==null||e.call(a),U(A)),is},ii=()=>[Ks(g,(e,i)=>b(f,i)===-1?void 0:Ks(e,(r,l)=>b(b(d,i),l)===-1?void 0:Ks(r,([,u])=>u,u=>zo(u)),B,yt),B,yt),Ks(R,([,e])=>e,e=>zo(e)),1],ri=()=>[!B(g),!B(R),_o(g,ea,zo),_o(E),Ks(R,ea,zo),Ks(V),Ks(f),pi(d),_o(S),Ks(w)],Kn=e=>{var i,r;return c>0&&(c--,c==0&&(c=1,Dn(1),B(g)||vn(1),Nn(1),B(R)||pn(1),e!=null&&e(is)&&(J(g,(l,u)=>J(l,(h,y)=>J(h,([P],v)=>Or(is,u,y,v,P)))),uo(g),J(R,([l],u)=>Ir(is,u,l)),uo(R)),U(Y[0],void 0),c=-1,Dn(0),B(g)||vn(0),Nn(0),B(R)||pn(0),(i=a[1])==null||i.call(a),U(Y[1],void 0),(r=a[2])==null||r.call(a),c=0,n=_t(),o=Mt(),qt([f,L,$,d,S,g,E,w,R,V],uo))),is},is={getContent:kc,getTables:Re,getTableIds:ys,getTable:_c,getTableCellIds:Fn,getRowCount:kn,getRowIds:Zs,getSortedRowIds:At,getRow:Mc,getCellIds:Ee,getCell:Ft,getValues:Ve,getValueIds:be,getValue:kt,hasTables:_t,hasTable:_n,hasTableCell:Mn,hasRow:zn,hasCell:Hn,hasValues:Mt,hasValue:Un,getTablesJson:zc,getValuesJson:Hc,getJson:Uc,getTablesSchemaJson:Wc,getValuesSchemaJson:Bc,getSchemaJson:Jc,hasTablesSchema:()=>s,hasValuesSchema:()=>t,setContent:Qc,setTables:zt,setTable:Gc,setRow:Yc,addRow:qc,setPartialRow:Kc,setCell:Xc,setValues:Ht,setPartialValues:Zc,setValue:Oc,applyChanges:Ic,setTablesJson:Wn,setValuesJson:si,setJson:ti,setTablesSchema:Bn,setValuesSchema:Jn,setSchema:ei,delTables:Ut,delTable:Qn,delRow:Gn,delCell:ni,delValues:Wt,delValue:oi,delTablesSchema:Yn,delValuesSchema:je,delSchema:ci,transaction:xe,startTransaction:qn,getTransactionChanges:ii,getTransactionLog:ri,finishTransaction:Kn,forEachTable:e=>J(x,(i,r)=>e(r,l=>J(i,(u,h)=>l(h,y=>Os(u,y))))),forEachTableCell:(e,i)=>Os(b(us,ls(e)),i),forEachRow:(e,i)=>J(b(x,ls(e)),(r,l)=>i(l,u=>Os(r,u))),forEachCell:(e,i,r)=>Os(b(b(x,ls(e)),ls(i)),r),forEachValue:e=>Os(z,e),addSortedRowIdsListener:(e,i,r,l,u,h,y)=>oc(e)?An(e.tableId,e.cellId,[e.descending??!1,e.offset??0,e.limit],i,r):An(e,i,[r,l,u],h,y),addStartTransactionListener:e=>$s(e,A),addWillFinishTransactionListener:e=>$s(e,Y[0]),addDidFinishTransactionListener:e=>$s(e,Y[1]),callListener:e=>(Bs(e),is),delListener:e=>(Zt(e),is),getListenerStats:()=>({hasTables:Ps(ss),tables:Ps(F),tableIds:Ps(Z),hasTable:Ps(as),table:Ps(es),tableCellIds:Ps(D),hasTableCell:Ps(O,qe),rowCount:Ps(ns),rowIds:Ps(os),sortedRowIds:Ps(ts),hasRow:Ps(bs,qe),row:Ps(Es,qe),cellIds:Ps(G,qe),hasCell:Ps(ds,$i),cell:Ps(Cs,$i),invalidCell:Ps(Ns,$i),hasValues:Ps(Ws),values:Ps(ks),valueIds:Ps(zs),hasValue:Ps(_),value:Ps(C),invalidValue:Ps(hs),transaction:Pc(A)+Ps(Y)}),isMergeable:()=>!1,createStore:Kd,addListener:$s,callListeners:U,setInternalListeners:(e,i,r,l,u)=>a=[e,i,r,l,u]};return ee({[Ne+Yr]:[0,ss,[],()=>[_t()]],[Yr]:[0,F],[bd]:[0,Z],[Ne+Ye]:[1,as,[ys],e=>[_n(...e)]],[Ye]:[1,es,[ys]],[Ye+qr]:[1,D,[ys]],[Ne+Ye+Bo]:[2,O,[ys,Fn],e=>[Mn(...e)]],[jd]:[1,ns,[ys]],[xd]:[1,os,[ys]],[Ne+tc]:[2,bs,[ys,Zs],e=>[zn(...e)]],[tc]:[2,Es,[ys,Zs]],[qr]:[2,G,[ys,Zs]],[Ne+Bo]:[3,ds,[ys,Zs,Ee],e=>[Hn(...e)]],[Bo]:[3,Cs,[ys,Zs,Ee],e=>Mo(Ft(...e))],InvalidCell:[3,Ns],[Ne+Kr]:[0,Ws,[],()=>[Mt()]],[Kr]:[0,ks],[Pd]:[0,zs],[Ne+ec]:[1,_,[be],e=>[Un(...e)]],[ec]:[1,C,[be],e=>Mo(kt(e[0]))],InvalidValue:[1,hs]},([e,i,r,l],u)=>{is[Vd+u+Ed]=(...h)=>$s(h[e],i[h[e+1]?1:0],e>0?Xr(h,0,e):void 0,r,l)}),_l(is)},cc="",Vt=s=>s==null,ic=(s,t,n)=>Vt(s)?n==null?void 0:n():t(s),ki=s=>Array.isArray(s),ze=s=>s.length,Xd=(s,t)=>s.test(t),Wl=s=>{throw new Error(s)},eo=async(s,t,n)=>{try{return await s()}catch(o){t==null||t(o)}},_i=(s,t)=>s.forEach(t),Zd=(s,t)=>s.splice(0,t),gr=(s,...t)=>s.push(...t),Bl=s=>s.shift(),Od=s=>(s==null?void 0:s.size)??0,Id=(s,t)=>(s==null?void 0:s.has(t))??!1,Jl=s=>Vt(s)||Od(s)==0,Ql=(s,t)=>s==null?void 0:s.forEach(t),Gl=(s,t)=>s==null?void 0:s.delete(t),mc=Object,na=s=>mc.getPrototypeOf(s),sh=s=>!Vt(s)&&ic(na(s),t=>t==mc.prototype||Vt(na(t)),()=>!0),th=mc.keys,eh=mc.freeze,nh=s=>ze(th(s)),Ho=s=>sh(s)&&nh(s)==0,jo=s=>new Map(s),ft=(s,t)=>s==null?void 0:s.get(t),He=(s,t,n)=>Vt(n)?(Gl(s,t),s):s==null?void 0:s.set(t,n),Mi=(s,t,n,o)=>(Id(s,t)?o==null||o(ft(s,t)):He(s,t,n()),ft(s,t)),zi=(s,t,n,o,c=0)=>ic((n?Mi:ft)(s,t[c],c>ze(t)-2?n:jo),a=>{if(c>ze(t)-2)return o!=null&&o(a)&&He(s,t[c]),a;const f=zi(a,t,n,o,c+1);return Jl(a)&&He(s,t[c]),f}),oh=/^\d+$/,ch=()=>{const s=[];let t=0;return[n=>(n?Bl(s):null)??cc+t++,n=>{Xd(oh,n)&&ze(s)<1e3&&gr(s,n)}]},ih=s=>new Set(ki(s)||Vt(s)?s:[s]),rh=(s,t)=>s==null?void 0:s.add(t),ah=(s,t=[cc])=>{const n=[],o=(c,a)=>a==ze(t)?gr(n,c):t[a]===null?Ql(c,f=>o(f,a+1)):_i([t[a],null],f=>o(ft(c,f),a+1));return o(s,0),n},lh=s=>{let t;const[n,o]=ch(),c=jo();return[(d,S,g,w=[],R=()=>[])=>{t??(t=s());const E=n(1);return He(c,E,[d,S,g,w,R]),rh(zi(S,g??[cc],ih),E),E},(d,S,...g)=>_i(ah(d,S),w=>Ql(w,R=>ft(c,R)[0](t,...S??[],...g))),d=>ic(ft(c,d),([,S,g])=>(zi(S,g??[cc],void 0,w=>(Gl(w,d),Jl(w)?1:0)),He(c,d),o(d),g)),d=>ic(ft(c,d),([S,,g=[],w,R])=>{const E=(...V)=>{var p;const m=ze(V);m==ze(g)?S(t,...V,...R(V)):Vt(g[m])?_i(((p=w[m])==null?void 0:p.call(w,...V))??[],j=>E(...V,j)):E(...V,g[m])};E()})]},Uo=jo(),Wo=jo(),uh=(s=1,t,n)=>s!=1&&t.isMergeable()?[1,t.getMergeableContent,()=>t.getTransactionMergeableChanges(!n),([[o],[c]])=>!Ho(o)||!Ho(c),t.setDefaultContent]:s!=2?[0,t.getContent,t.getTransactionChanges,([o,c])=>!Ho(o)||!Ho(c),t.setContent]:Wl("Store type not supported by this Persister"),Eh=(s,t,n,o,c,a,f,L={},$=0,d=[])=>{let S=0,g=0,w=0,R,E,V;Mi(Uo,d,()=>0),Mi(Wo,d,()=>[]);const m=jo(),[p,j,Ls,Rs,gs]=uh(f,s,$),[us,x,z]=lh(()=>_),ss=C=>{C!=S&&(S=C,x(m,void 0,S))},F=async()=>{if(!ft(Uo,d)){for(He(Uo,d,1);!Vt(R=Bl(ft(Wo,d)));)await eo(R,a);He(Uo,d,0)}},Z=C=>{(p&&ki(C==null?void 0:C[0])?(C==null?void 0:C[2])===1?s.applyMergeableChanges:s.setMergeableContent:(C==null?void 0:C[2])===1?s.applyChanges:s.setContent)(C)},as=async C=>(S!=2&&(ss(1),g++,await hs(async()=>{await eo(async()=>{const A=await t();ki(A)?Z(A):C?gs(C):Wl(`Content is not an array: ${A}`)},()=>{C&&gs(C)}),ss(0)})),_),es=async C=>(D(),await as(C),await eo(async()=>E=await o(async(A,Y)=>{Y||A?S!=2&&(ss(1),g++,Z(Y??A),ss(0)):await as()}),a),_),D=async()=>(E&&(await eo(()=>c(E),a),E=void 0),_),O=()=>!Vt(E),ns=async C=>(S!=1&&(ss(2),w++,await hs(async()=>{await eo(()=>n(j,C),a),ss(0)})),_),os=async()=>(ts(),await ns(),V=s.addDidFinishTransactionListener(()=>{const C=Ls();Rs(C)&&ns(C)}),_),ts=async()=>(V&&(s.delListener(V),V=void 0),_),bs=()=>!Vt(V),Es=async(C,A=!1)=>{const[Y,$s]=A?[os,es]:[es,os];return await Y(C),await $s(C),_},G=async(C=!1)=>{const[A,Y]=C?[ts,D]:[D,ts];return await A(),await Y(),_},ds=()=>S,Cs=C=>us(C,m),Ns=C=>(z(C),s),hs=async(...C)=>(gr(ft(Wo,d),...C),await F(),_),_={load:as,startAutoLoad:es,stopAutoLoad:D,isAutoLoading:O,save:ns,startAutoSave:os,stopAutoSave:ts,isAutoSaving:bs,startAutoPersisting:Es,stopAutoPersisting:G,getStatus:ds,addStatusListener:Cs,delListener:Ns,schedule:hs,getStore:()=>s,destroy:()=>(Zd(ft(Wo,d)),G()),getStats:()=>({loads:g,saves:w}),...L};return eh(_)};export{$h as I,E1 as P,Sh as U,yh as a,Eh as b,Kd as c,wh as d,Rh as e};
