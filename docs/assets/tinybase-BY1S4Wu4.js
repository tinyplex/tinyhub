var Uu=Object.defineProperty;var zu=(s,t,e)=>t in s?Uu(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var ja=(s,t,e)=>zu(s,typeof t!="symbol"?t+"":t,e);import{R as sa,j as C}from"./react-NscsqV4B.js";const So=s=>typeof s,Hu="tinybase",ie="",Wu=So(ie),Ou=So(So),Bu="Listener",$c="Result",Gu="get",Qu="set",Ju="add",Yu="Has",qu="has",At="Ids",ta="Table",Ku=ta+At,Sc="Row",Li=Sc+"Count",hi=Sc+At,gi="Sorted"+Sc+At,Tc="Cell",Ri=Tc+At,Cc="Value",Xu=Cc+"s",Zu=Cc+At,yi="Metric",Iu="Index",Ei="Slice",s1="Relationship",t1="Remote"+Sc+"Id",e1="Query",Rr=globalThis,Ze=s=>s==null,qo=(s,t,e)=>Ze(s)?e==null?void 0:e():t(s),bi=s=>So(s)==Wu,wi=s=>So(s)==Ou,n1=s=>Array.isArray(s),Ko=s=>s.length,o1=()=>{},c1=(s,t)=>ea(new Array(s).fill(0),(e,o)=>t(o)),Vi=(s,t)=>s.every(t),yr=(s,t)=>Ko(s)===Ko(t)&&Vi(s,(e,o)=>t[o]===e),ea=(s,t)=>s.map(t),r1=(s,t)=>s.filter(t),xa=(s,t,e)=>s.with(t,e),Lc=Object,Aa=s=>Lc.getPrototypeOf(s),a1=Lc.entries,Da=s=>!Ze(s)&&qo(Aa(s),t=>t==Lc.prototype||Ze(Aa(t)),()=>!0),ji=Lc.keys,xi=(s,t)=>qo(s,e=>e[t]),i1=(s,t)=>t in s,l1=(s,t)=>(delete s[t],s),u1=s=>Ko(ji(s)),Ai=(s,t)=>{const e=a1(s);return Ko(e)===u1(t)&&Vi(e,([o,c])=>Da(c)?Da(t[o])?Ai(t[o],c):!1:t[o]===c)},{PureComponent:hT,createContext:f1,useCallback:To,useContext:na,useEffect:Pa,useLayoutEffect:gT,useMemo:Di,useRef:d1,useState:Fr,useSyncExternalStore:$1}=sa,Er=Hu+"_uirc",Xo=Rr[Er]?Rr[Er]:Rr[Er]=f1([]),cn=(s,t)=>{const e=na(Xo);return Ze(s)?e[t*2]:bi(s)?xi(e[t*2+1],s):s},bo=(s,t)=>{const e=cn(s,t);return Ze(s)||bi(s)?e:s},wo=s=>ji(na(Xo)[s*2+1]??{}),S1=()=>wo(0),Pi=s=>cn(s,0),rt=s=>bo(s,0),T1=()=>wo(1),Ni=s=>cn(s,1),vi=s=>bo(s,1),C1=()=>wo(2),mi=s=>cn(s,2),hc=s=>bo(s,2),L1=()=>wo(3),_i=s=>cn(s,3),oa=s=>bo(s,3),h1=()=>wo(4),Fi=s=>cn(s,4),Vo=s=>bo(s,4),Yt=[],Na=[{},[],[Yt,void 0,Yt],void 0,!1,0],g1=[Ai,yr,([s,t,e],[o,c,i])=>t===c&&yr(s,o)&&yr(e,i)],R1=(s,t)=>s===t,y1=(s,t,...e)=>{var c;const o=(c=s==null?void 0:s[Ju+t+Bu])==null?void 0:c.call(s,...e);return()=>{var i;return(i=s==null?void 0:s.delListener)==null?void 0:i.call(s,o)}},Ps=(s,t,e,o=Yt)=>{const c=d1(Na[e]),i=To(()=>{var L;const $=((L=t==null?void 0:t[(e==4?qu:Gu)+s])==null?void 0:L.call(t,...o))??Na[e];return(g1[e]??R1)($,c.current)?c.current:c.current=$},[t,e,s,...o]),u=To($=>y1(t,(e==4?Yu:ie)+s,...o,$),[t,e,s,...o]);return $1(u,i,i)},Mi=(s,t,e,o=Yt,c=o1,i=Yt,...u)=>{const $=rt(s);return To(L=>qo($,d=>qo(e(L,d),S=>c(d[Qu+t](...E1(u,d,L),S),S))),[$,t,...o,...i,...b1(u)])},E1=(s,t,e)=>ea(s,o=>wi(o)?o(e,t):o),b1=s=>r1(s,t=>!wi(t)),w1=(s,t=Yt)=>Di(s,t),V1=s=>Ps(Ku,rt(s),1),ca=(s,t)=>Ps(ta+Ri,rt(t),1,[s]),j1=(s,t)=>Ps(Li,rt(t),5,[s]),x1=(s,t)=>Ps(hi,rt(t),1,[s]),A1=(s,t,e,o=0,c,i)=>Ps(gi,rt(i),1,[s,t,e,o,c]),rn=(s,t,e,o)=>Ps(Tc,rt(o),3,[s,t,e]),D1=s=>Ps(Xu,rt(s),0),ki=s=>Ps(Zu,rt(s),1),Ue=(s,t)=>Ps(Cc,rt(t),3,[s]),gc=(s,t,e,o,c,i,u,$)=>Mi(i,Tc,o,c,u,$,s,t,e),Zo=(s,t,e,o,c,i)=>Mi(o,Cc,t,e,c,i,s),P1=s=>Ps(yi+At,vi(s),1),N1=(s,t)=>Ps(yi,vi(t),3,[s]),v1=(s,t)=>Ps(Ei+At,hc(t),1,[s]),m1=s=>Ps(Iu+At,hc(s),1),_1=(s,t,e)=>Ps(Ei+hi,hc(e),1,[s,t]),F1=s=>Ps(s1+At,oa(s),1),M1=(s,t,e)=>Ps(t1,oa(e),3,[s,t]),k1=s=>Ps(e1+At,Vo(s),1),p1=(s,t)=>Ps($c+ta+Ri,Vo(t),1,[s]),U1=(s,t)=>Ps($c+Li,Vo(t),5,[s]),z1=(s,t,e,o=0,c,i)=>Ps($c+gi,Vo(i),1,[s,t,e,o,c]),H1=(s,t,e,o)=>Ps($c+Tc,Vo(o),3,[s,t,e]),W1=(s,t,e=Yt,o,c=Yt,i,u=Yt)=>{const[,$]=Fr(),[L,d]=Fr();return Pa(()=>{(async()=>{const S=s?await t(s):void 0;d(S),S&&o&&(async()=>(await o(S),$([])))()})()},[s,...e,...c]),Pa(()=>()=>{L&&L.destroy()},[L,...u]),L},Zt=(s,t,e,o,c)=>[e??t[s*2],{...t[s*2+1],...o,...c[s]}],RT=({store:s,storesById:t,metrics:e,metricsById:o,indexes:c,indexesById:i,relationships:u,relationshipsById:$,queries:L,queriesById:d,checkpoints:S,checkpointsById:h,persister:R,persistersById:E,synchronizer:b,synchronizersById:w,children:N})=>{const D=na(Xo),[V,cs]=Fr(()=>c1(8,()=>({}))),Ls=To((K,j,_)=>cs(J=>xi(J[K],j)==_?J:xa(J,K,{...J[K],[j]:_})),[]),is=To((K,j)=>cs(_=>i1(_[K],j)?xa(_,K,l1(_[K],j)):_),[]);return C.jsx(Xo.Provider,{value:Di(()=>[...Zt(0,D,s,t,V),...Zt(1,D,e,o,V),...Zt(2,D,c,i,V),...Zt(3,D,u,$,V),...Zt(4,D,L,d,V),...Zt(5,D,S,h,V),...Zt(6,D,R,E,V),...Zt(7,D,b,w,V),Ls,is],[V,s,t,e,o,c,i,u,$,L,d,S,h,R,E,b,w,D,Ls,is]),children:N})},ra=(s,t,e,o)=>{const c=Ze(t)||!n1(s)?s:ea(s,(i,u)=>u>0?[t,i]:i);return e?[o,":{",c,"}"]:c},aa=({tableId:s,rowId:t,cellId:e,store:o,debugIds:c})=>ra(ie+(rn(s,t,e,o)??ie),void 0,c,e),O1=({valueId:s,store:t,debugIds:e})=>ra(ie+(Ue(s,t)??ie),void 0,e,s),B1=({queryId:s,rowId:t,cellId:e,queries:o,debugIds:c})=>ra(ie+(H1(s,t,e,o)??ie),void 0,c,e),le=s=>typeof s,qt="",Rc=le(qt),pi=le(!0),yc=le(0),G1=le(le),vo="type",nt="default",Q1="Listener",J1="add",Pe="Has",Ec="Ids",ke="Table",va=ke+"s",Y1=ke+Ec,Io="Row",q1=Io+"Count",K1=Io+Ec,uo="Cell",ma=uo+Ec,Ie="Value",Mr=Ie+"s",X1=Ie+Ec,Xe="currentTarget",_a="value",Ui="￼",$s=s=>qt+s,Z1=(s,t=qt,e)=>s.split(t,e),I1=globalThis,Fa=I1.window,zi=Math,s0=zi.min,Ma=zi.floor,t0=isFinite,e0=(s,t)=>s instanceof t,ss=s=>s==null,Ms=(s,t,e)=>ss(s)?e==null?void 0:e():t(s),Hi=s=>s==Rc||s==pi,n0=s=>le(s)==Rc,br=s=>le(s)==G1,Co=s=>Array.isArray(s),ka=(s,t,e)=>s.slice(t,e),Vt=s=>s.length,o0=(s,t)=>s.test(t),Wi=s=>{throw new Error(s)},c0=(s,t)=>s.includes(t),r0=(s,t)=>s.every(t),a0=(s,t)=>Vt(s)===Vt(t)&&r0(s,(e,o)=>t[o]===e),Oi=(s,t)=>s.sort(t),Lo=(s,t)=>s.forEach(t),i0=(s,t=qt)=>s.join(t),Ds=(s,t)=>s.map(t),yt=s=>Vt(s)==0,l0=(s,t,e)=>s.reduce(t,e),u0=(s,t)=>s.splice(0,t),ho=(s,...t)=>s.push(...t),Bi=s=>s.shift(),$e=Object,pa=s=>$e.getPrototypeOf(s),Gi=$e.entries,f0=$e.isFrozen,Qi=s=>!ss(s)&&Ms(pa(s),t=>t==$e.prototype||ss(pa(t)),()=>!0),d0=$e.keys,Ji=$e.freeze,fo=(s=[])=>$e.fromEntries(s),co=(s,t)=>t in s,Yi=(s,t)=>(delete s[t],s),$0=(s,t)=>Lo(Gi(s),([e,o])=>t(o,e)),sn=(s,t)=>Ds(Gi(s),([e,o])=>t(o,e)),Qt=(s,t)=>fo(sn(s,(e,o)=>[o,t(e,o)])),S0=s=>Vt(d0(s)),Ks=s=>Qi(s)&&S0(s)==0,It=(s,t,e,o=0)=>ss(s)||!Qi(s)||!o&&Ks(s)||f0(s)?(e==null||e(),!1):($0(s,(c,i)=>{t(c,i)||Yi(s,i)}),o?!0:!Ks(s)),qi=JSON.stringify,pe=JSON.parse,Jt=s=>qi(s,(t,e)=>e0(e,Map)?$e.fromEntries([...e]):e),T0=s=>qi(s,(t,e)=>e===void 0?Ui:e),C0=s=>pe(s,(t,e)=>e===Ui?void 0:e),ia=s=>t=>l0(L0(t),(e,o)=>e+s(o),0),la=s=>(s==null?void 0:s.size)??0,ua=ia(la),ro=ia(ua),wr=ia(ro),Js=(s,t)=>(s==null?void 0:s.has(t))??!1,Y=s=>ss(s)||la(s)==0,L0=s=>[...(s==null?void 0:s.values())??[]],Vr=s=>s.clear(),os=(s,t)=>s==null?void 0:s.forEach(t),sc=(s,t)=>s==null?void 0:s.delete(t),q=s=>new Map(s),so=s=>[...(s==null?void 0:s.keys())??[]],v=(s,t)=>s==null?void 0:s.get(t),ee=(s,t)=>os(s,(e,o)=>t(o,e)),h0=(s,t)=>Ds([...(s==null?void 0:s.entries())??[]],([e,o])=>t(o,e)),ls=(s,t,e)=>ss(e)?(sc(s,t),s):s==null?void 0:s.set(t,e),Fs=(s,t,e,o)=>(Js(s,t)?o==null||o(v(s,t)):ls(s,t,e()),v(s,t)),Ne=(s,t,e,o=ls)=>(Qt(t,(c,i)=>e(s,i,c)),ee(s,c=>co(t,c)?0:o(s,c)),s),Ys=(s,t,e,o)=>{const c={};return os(s,(i,u)=>{if(!(e!=null&&e(i,u))){const $=t?t(i,u):i;o!=null&&o($)||(c[u]=$)}}),c},kr=(s,t,e)=>Ys(s,o=>Ys(o,t,e),Y,Ks),mo=(s,t,e)=>Ys(s,o=>kr(o,t,e),Y,Ks),oe=(s,t)=>{const e=q();return os(s,(o,c)=>e.set(c,(t==null?void 0:t(o))??o)),e},pr=s=>oe(s,oe),jr=s=>oe(s,pr),Ur=(s,t,e,o,c=0)=>Ms((e?Fs:v)(s,t[c],c>Vt(t)-2?e:q),i=>{if(c>Vt(t)-2)return o!=null&&o(i)&&ls(s,t[c]),i;const u=Ur(i,t,e,o,c+1);return Y(i)&&ls(s,t[c]),u}),g0=/^\d+$/,Ki=()=>{const s=[];let t=0;return[e=>(e?Bi(s):null)??qt+t++,e=>{o0(g0,e)&&Vt(s)<1e3&&ho(s,e)}]},ao=s=>new Set(Co(s)||ss(s)?s:[s]),io=(s,t)=>s==null?void 0:s.add(t),R0=(s,t=[qt])=>{const e=[],o=(c,i)=>i==Vt(t)?ho(e,c):t[i]===null?os(c,u=>o(u,i+1)):Lo([t[i],null],u=>o(v(c,u),i+1));return o(s,0),e},Xi=s=>{let t;const[e,o]=Ki(),c=q();return[(d,S,h,R=[],E=()=>[])=>{t??(t=s());const b=e(1);return ls(c,b,[d,S,h,R,E]),io(Ur(S,h??[qt],ao),b),b},(d,S,...h)=>Lo(R0(d,S),R=>os(R,E=>v(c,E)[0](t,...S??[],...h))),d=>Ms(v(c,d),([,S,h])=>(Ur(S,h??[qt],void 0,R=>(sc(R,d),Y(R)?1:0)),ls(c,d),o(d),h)),d=>Ms(v(c,d),([S,,h=[],R,E])=>{const b=(...w)=>{var D;const N=Vt(w);N==Vt(h)?S(t,...w,...E(w)):ss(h[N])?Lo(((D=R[N])==null?void 0:D.call(R,...w))??[],V=>b(...w,V)):b(...w,h[N])};b()})]},_o=q(),Fo=q(),y0=(s=1,t,e)=>s!=1&&t.isMergeable()?[1,t.getMergeableContent,()=>t.getTransactionMergeableChanges(!e),([[o],[c]])=>!Ks(o)||!Ks(c),t.setDefaultContent]:s!=2?[0,t.getContent,t.getTransactionChanges,([o,c])=>!Ks(o)||!Ks(c),t.setContent]:Wi("Store type not supported by this Persister"),E0=(s,t,e,o,c,i,u,$={},L=0,d=[])=>{let S=0,h=0,R=0,E,b,w;Fs(_o,d,()=>0),Fs(Fo,d,()=>[]);const N=q(),[D,V,cs,Ls,is]=y0(u,s,L),[K,j,_]=Xi(()=>U),J=g=>{g!=S&&(S=g,j(N,void 0,S))},F=async()=>{if(!v(_o,d)){for(ls(_o,d,1);!ss(E=Bi(v(Fo,d)));)try{await E()}catch{}ls(_o,d,0)}},Z=g=>{(D&&Co(g==null?void 0:g[0])?(g==null?void 0:g[2])===1?s.applyMergeableChanges:s.setMergeableContent:(g==null?void 0:g[2])===1?s.applyChanges:s.setContent)(g)},rs=async g=>(S!=2&&(J(1),h++,await es(async()=>{try{const W=await t();Co(W)?Z(W):g?is(g):Wi(`Content is not an array: ${W}`)}catch{g&&is(g)}J(0)})),U),Ss=async g=>{m(),await rs(g);try{b=await o(async(W,Cs)=>{Cs||W?S!=2&&(J(1),h++,Z(Cs??W),J(0)):await rs()})}catch{}return U},m=()=>(b&&(c(b),b=void 0),U),I=()=>!ss(b),ts=async g=>(S!=1&&(J(2),R++,await es(async()=>{try{await e(V,g)}catch{}J(0)})),U),Ts=async()=>(us(),await ts(),w=s.addDidFinishTransactionListener(()=>{const g=cs();Ls(g)&&ts(g)}),U),us=()=>(w&&(s.delListener(w),w=void 0),U),Es=()=>!ss(w),Rs=()=>S,X=g=>K(g,N),fs=g=>(_(g),s),es=async(...g)=>(ho(v(Fo,d),...g),await F(),U),U={load:rs,startAutoLoad:Ss,stopAutoLoad:m,isAutoLoading:I,save:ts,startAutoSave:Ts,stopAutoSave:us,isAutoSaving:Es,getStatus:Rs,addStatusListener:X,delListener:fs,schedule:es,getStore:()=>s,destroy:()=>(u0(v(Fo,d)),m().stopAutoSave()),getStats:()=>({loads:h,saves:R}),...$};return Ji(U)},Ua="storage",b0=(s,t,e,o)=>E0(s,async()=>C0(e.getItem(t)),async L=>e.setItem(t,T0(L())),L=>{const d=S=>{if(S.storageArea===e&&S.key===t)try{L(pe(S.newValue))}catch{L()}};return Fa.addEventListener(Ua,d),d},L=>Fa.removeEventListener(Ua,L),o,3,{getStorageName:()=>t}),w0=(s,t,e)=>b0(s,t,sessionStorage,e),Ye=s=>{const t=le(s);return Hi(t)||t==yc&&t0(s)?t:void 0},za=(s,t,e,o,c)=>ss(c)?s.delCell(t,e,o,!0):s.setCell(t,e,o,c),Ha=(s,t,e)=>ss(e)?s.delValue(t):s.setValue(t,e),xr=(s,t,e,o)=>s==Rc?t:s==yc?e:o,V0=(s,t)=>(s??0)<(t??0)?-1:1,Mo=s=>[s,s],ws=(s,t=ua)=>t(s[0])+t(s[1]),Vs=()=>[q(),q()],Wa=s=>[...s],ko=([s,t])=>s===t,to=(s,t,e)=>ls(s,t,v(s,t)==-e?void 0:e),Zi=()=>{let s,t,e=!1,o=!1,c=0,i=[];const u=q(),$=q(),L=q(),d=q(),S=q(),h=q(),R=q(),E=q(),b=q(),w=q(),N=q(),D=q(),V=q(),cs=q(),Ls=ao(),is=q(),K=q(),j=q(),_=q(),J=Vs(),F=Vs(),Z=Vs(),rs=Vs(),Ss=Vs(),m=Vs(),I=Vs(),ts=Vs(),Ts=Vs(),us=Vs(),Es=Vs(),Rs=Vs(),X=Vs(),fs=Vs(),es=Vs(),ms=Vs(),Ns=Vs(),Ws=Vs(),U=Vs(),g=Vs(),W=Vs(),Cs=Vs(),bs=q(),ks=Vs(),[_s,z,Xt,Os]=Xi(()=>ns),Qe=n=>It(n,r=>It(r,un)),Hc=n=>It(n,un),un=n=>{if(!It(n,(a,l)=>c0([vo,nt],l)))return!1;const r=n[vo];return!Hi(r)&&r!=yc?!1:(Ye(n[nt])!=r&&Yi(n,nt),!0)},Wc=Co,Oc=n=>It(n,fn,zs),fn=(n,r)=>(!s||Js(N,r)||zs(r))&&It(n,(a,l)=>Nt(r,l,a),()=>zs(r)),Nt=(n,r,a,l)=>It(l?a:Tn(a,n,r),(f,T)=>Ms(dn(n,r,T,f),y=>(a[T]=y,!0),()=>!1),()=>zs(n,r)),dn=(n,r,a,l)=>s?Ms(v(v(N,n),a),f=>Ye(l)!=f[vo]?zs(n,r,a,l,f[nt]):l,()=>zs(n,r,a,l)):ss(Ye(l))?zs(n,r,a,l):l,$n=(n,r)=>It(r?n:Bc(n),(a,l)=>Ms(Sn(l,a),f=>(n[l]=f,!0),()=>!1),()=>it()),Sn=(n,r)=>t?Ms(v(V,n),a=>Ye(r)!=a[vo]?it(n,r,a[nt]):r,()=>it(n,r)):ss(Ye(r))?it(n,r):r,Tn=(n,r,a)=>(Ms(v(D,r),([l,f])=>{os(l,(T,y)=>{co(n,y)||(n[y]=T)}),os(f,T=>{co(n,T)||zs(r,a,T)})}),n),Bc=n=>(t&&(os(cs,(r,a)=>{co(n,a)||(n[a]=r)}),os(Ls,r=>{co(n,r)||it(r)})),n),Cn=n=>Ne(N,n,(r,a,l)=>{const f=q(),T=ao();Ne(Fs(N,a,q),l,(y,x,P)=>{ls(y,x,P),Ms(P[nt],ds=>ls(f,x,ds),()=>io(T,x))}),ls(D,a,[f,T])},(r,a)=>{ls(N,a),ls(D,a)}),Ln=n=>Ne(V,n,(r,a,l)=>{ls(V,a,l),Ms(l[nt],f=>ls(cs,a,f),()=>io(Ls,a))},(r,a)=>{ls(V,a),ls(cs,a),sc(Ls,a)}),hn=n=>Ks(n)?Wt():zt(n),Gc=([n,r])=>{(Ks(n)?Wt:zt)(n),(Ks(r)?Ot:Ht)(r)},gn=n=>Ne(j,n,(r,a,l)=>vt(a,l),(r,a)=>bn(a)),vt=(n,r)=>Ne(Fs(j,n,()=>(xn(n,1),ls(is,n,Ki()),ls(K,n,q()),q())),r,(a,l,f)=>at(n,a,l,f),(a,l)=>wn(n,a,l)),at=(n,r,a,l,f)=>Ne(Fs(r,a,()=>(An(n,a,1),q())),l,(T,y,x)=>Ee(n,a,T,y,x),(T,y)=>Vn(n,r,a,T,y,f)),Ee=(n,r,a,l,f)=>{Js(a,l)||Dn(n,r,l,1);const T=v(a,l);f!==T&&(Pn(n,r,l,T,f),ls(a,l,f))},Rn=(n,r,a,l,f)=>Ms(v(r,a),T=>Ee(n,a,T,l,f),()=>at(n,r,a,Tn({[l]:f},n,a))),yn=n=>Ks(n)?Ot():Ht(n),En=n=>Ne(_,n,(r,a,l)=>mt(a,l),(r,a)=>jn(a)),mt=(n,r)=>{Js(_,n)||Nn(n,1);const a=v(_,n);r!==a&&(vn(n,a,r),ls(_,n,r))},Qc=(n,r)=>{const[a]=v(is,n);let l;do l=a(r);while(Js(v(j,n),l));return l},_t=n=>v(j,n)??vt(n,{}),bn=n=>vt(n,{}),wn=(n,r,a)=>{const[,l]=v(is,n);l(a),at(n,r,a,{},!0)},Vn=(n,r,a,l,f,T)=>{var P;const y=v((P=v(D,n))==null?void 0:P[0],f);if(!ss(y)&&!T)return Ee(n,a,l,f,y);const x=ds=>{Pn(n,a,ds,v(l,ds)),Dn(n,a,ds,-1),ls(l,ds)};ss(y)?x(f):ee(l,x),Y(l)&&(An(n,a,-1),Y(ls(r,a))&&(xn(n,-1),ls(j,n),ls(is,n),ls(K,n)))},jn=n=>{const r=v(cs,n);if(!ss(r))return mt(n,r);vn(n,v(_,n)),Nn(n,-1),ls(_,n)},xn=(n,r)=>to(u,n,r),An=(n,r,a)=>to(Fs(d,n,q),r,a)&&ls(L,n,Fs(L,n,()=>0)+a),Dn=(n,r,a,l)=>{const f=v(K,n),T=v(f,a)??0;(T==0&&l==1||T==1&&l==-1)&&to(Fs($,n,q),a,l),ls(f,a,T!=-l?T+l:null),to(Fs(Fs(S,n,q),r,q),a,l)},Pn=(n,r,a,l,f)=>{var T;Fs(Fs(Fs(h,n,q),r,q),a,()=>[l,0])[1]=f,(T=i[3])==null||T.call(i,n,r,a,f)},Nn=(n,r)=>to(R,n,r),vn=(n,r,a)=>{var l;Fs(E,n,()=>[r,0])[1]=a,(l=i[4])==null||l.call(i,n,a)},zs=(n,r,a,l,f)=>(ho(Fs(Fs(Fs(b,n,q),r,q),a,()=>[]),l),f),it=(n,r,a)=>(ho(Fs(w,n,()=>[]),r),a),Ft=(n,r,a)=>Ms(v(v(v(h,n),r),a),([l,f])=>[!0,l,f],()=>[!1,...Mo(Mt(n,r,a))]),mn=n=>Ms(v(E,n),([r,a])=>[!0,r,a],()=>[!1,...Mo(kt(n))]),_n=n=>!Y(b)&&!Y(ms[n])?os(n?jr(b):b,(r,a)=>os(r,(l,f)=>os(l,(T,y)=>z(ms[n],[a,f,y],T)))):0,Fn=n=>!Y(w)&&!Y(Ns[n])?os(n?oe(w):w,(r,a)=>z(Ns[n],[a],r)):0,lt=(n,r,a,l)=>{if(!Y(n))return z(r,l,()=>Ys(n)),ee(n,(f,T)=>z(a,[...l??[],f],T==1)),1},Mn=n=>{const r=pt();r!=e&&z(J[n],void 0,r);const a=Y(us[n]),l=Y(X[n])&&Y(fs[n])&&Y(Ts[n])&&Y(Es[n])&&Y(m[n])&&Y(I[n])&&Y(ts[n])&&a&&Y(Z[n])&&Y(rs[n]),f=Y(es[n])&&Y(Rs[n])&&Y(Ss[n])&&Y(F[n]);if(!l||!f){const T=n?[oe(u),pr($),oe(L),pr(d),jr(S),jr(h)]:[u,$,L,d,S,h];if(!l){lt(T[0],Z[n],rs[n]),os(T[1],(x,P)=>lt(x,m[n],I[n],[P])),os(T[2],(x,P)=>{x!=0&&z(ts[n],[P],Un(P))});const y=ao();os(T[3],(x,P)=>{lt(x,Ts[n],Es[n],[P])&&!a&&(z(us[n],[P,null]),io(y,P))}),a||os(T[5],(x,P)=>{if(!Js(y,P)){const ds=ao();os(x,Hs=>os(Hs,([Bt,Gt],ut)=>Gt!==Bt?io(ds,ut):sc(Hs,ut))),os(ds,Hs=>z(us[n],[P,Hs]))}}),os(T[4],(x,P)=>os(x,(ds,Hs)=>lt(ds,X[n],fs[n],[P,Hs])))}if(!f){let y;os(T[5],(x,P)=>{let ds;os(x,(Hs,Bt)=>{let Gt;os(Hs,([ut,In],gr)=>{In!==ut&&(z(es[n],[P,Bt,gr],In,ut,Ft),y=ds=Gt=1)}),Gt&&z(Rs[n],[P,Bt],Ft)}),ds&&z(Ss[n],[P],Ft)}),y&&z(F[n],void 0,Ft)}}},kn=n=>{const r=Ut();r!=o&&z(Ws[n],void 0,r);const a=Y(g[n])&&Y(W[n]),l=Y(Cs[n])&&Y(U[n]);if(!a||!l){const f=n?[oe(R),oe(E)]:[R,E];if(a||lt(f[0],g[n],W[n]),!l){let T;os(f[1],([y,x],P)=>{x!==y&&(z(Cs[n],[P],x,y,mn),T=1)}),T&&z(U[n],void 0,mn)}}},k=(n,...r)=>(De(()=>n(...Ds(r,$s))),ns),Jc=()=>[be(),je()],be=()=>mo(j),hs=()=>so(j),Yc=n=>kr(v(j,$s(n))),pn=n=>so(v(K,$s(n))),Un=n=>la(v(j,$s(n))),Xs=n=>so(v(j,$s(n))),we=(n,r,a,l=0,f)=>Ds(ka(Oi(h0(v(j,$s(n)),(T,y)=>[ss(r)?y:v(T,$s(r)),y]),([T],[y])=>V0(T,y)*(a?-1:1)),l,ss(f)?f:l+f),([,T])=>T),qc=(n,r)=>Ys(v(v(j,$s(n)),$s(r))),Ve=(n,r)=>so(v(v(j,$s(n)),$s(r))),Mt=(n,r,a)=>v(v(v(j,$s(n)),$s(r)),$s(a)),je=()=>Ys(_),xe=()=>so(_),kt=n=>v(_,$s(n)),pt=()=>!Y(j),zn=n=>Js(j,$s(n)),Hn=(n,r)=>Js(v(K,$s(n)),$s(r)),Wn=(n,r)=>Js(v(j,$s(n)),$s(r)),On=(n,r,a)=>Js(v(v(j,$s(n)),$s(r)),$s(a)),Ut=()=>!Y(_),Bn=n=>Js(_,$s(n)),Kc=()=>Jt(j),Xc=()=>Jt(_),Zc=()=>Jt([j,_]),Ic=()=>Jt(N),sr=()=>Jt(V),tr=()=>Jt([N,V]),er=n=>k(()=>{const r=br(n)?n():n;Wc(r)&&Gc(r)}),zt=n=>k(()=>Oc(n)?gn(n):0),nr=(n,r)=>k(a=>fn(r,a)?vt(a,r):0,n),or=(n,r,a)=>k((l,f)=>Nt(l,f,a)?at(l,_t(l),f,a):0,n,r),cr=(n,r,a=!0)=>De(()=>{let l;return Nt(n,l,r)&&(n=$s(n),at(n,_t(n),l=Qc(n,a?1:0),r)),l}),rr=(n,r,a)=>k((l,f)=>{if(Nt(l,f,a,1)){const T=_t(l);Qt(a,(y,x)=>Rn(l,T,f,x,y))}},n,r),ar=(n,r,a,l)=>k((f,T,y)=>Ms(dn(f,T,y,br(l)?l(Mt(f,T,y)):l),x=>Rn(f,_t(f),T,y,x)),n,r,a),Ht=n=>k(()=>$n(n)?En(n):0),ir=n=>k(()=>$n(n,1)?Qt(n,(r,a)=>mt(a,r)):0),lr=(n,r)=>k(a=>Ms(Sn(a,br(r)?r(kt(a)):r),l=>mt(a,l)),n),ur=n=>k(()=>{Qt(n[0],(r,a)=>ss(r)?Yn(a):Qt(r,(l,f)=>ss(l)?qn(a,f):Qt(l,(T,y)=>za(ns,a,f,y,T)))),Qt(n[1],(r,a)=>Ha(ns,a,r))}),Gn=n=>{try{hn(pe(n))}catch{}return ns},fr=n=>{try{yn(pe(n))}catch{}return ns},dr=n=>k(()=>{try{const[r,a]=pe(n);hn(r),yn(a)}catch{Gn(n)}}),Qn=n=>k(()=>{if((s=Qe(n))&&(Cn(n),!Y(j))){const r=be();Wt(),zt(r)}}),Jn=n=>k(()=>{if(t=Hc(n)){const r=je();Ae(),Ot(),t=!0,Ln(n),Ht(r)}}),$r=(n,r)=>k(()=>{Qn(n),Jn(r)}),Wt=()=>k(()=>gn({})),Yn=n=>k(r=>Js(j,r)?bn(r):0,n),qn=(n,r)=>k((a,l)=>Ms(v(j,a),f=>Js(f,l)?wn(a,f,l):0),n,r),Sr=(n,r,a,l)=>k((f,T,y)=>Ms(v(j,f),x=>Ms(v(x,T),P=>Js(P,y)?Vn(f,x,T,P,y,l):0)),n,r,a),Ot=()=>k(()=>En({})),Tr=n=>k(r=>Js(_,r)?jn(r):0,n),Kn=()=>k(()=>{Cn({}),s=!1}),Ae=()=>k(()=>{Ln({}),t=!1}),Cr=()=>k(()=>{Kn(),Ae()}),De=(n,r)=>{if(c!=-1){Xn();const a=n();return Zn(r),a}},Xn=()=>{var n;return c!=-1&&c++,c==1&&((n=i[0])==null||n.call(i),z(bs)),ns},Lr=()=>[Ys(h,(n,r)=>v(u,r)===-1?void 0:Ys(n,(a,l)=>v(v(d,r),l)===-1?void 0:Ys(a,([,f])=>f,f=>ko(f)),Y,Ks),Y,Ks),Ys(E,([,n])=>n,n=>ko(n)),1],hr=()=>[!Y(h),!Y(E),mo(h,Wa,ko),mo(b),Ys(E,Wa,ko),Ys(w),Ys(u),kr(d),mo(S),Ys(R)],Zn=n=>{var r,a;return c>0&&(c--,c==0&&(c=1,_n(1),Y(h)||Mn(1),Fn(1),Y(E)||kn(1),n!=null&&n(ns)&&(os(h,(l,f)=>os(l,(T,y)=>os(T,([x],P)=>za(ns,f,y,P,x)))),Vr(h),os(E,([l],f)=>Ha(ns,f,l)),Vr(E)),z(ks[0],void 0),c=-1,_n(0),Y(h)||Mn(0),Fn(0),Y(E)||kn(0),(r=i[1])==null||r.call(i),z(ks[1],void 0),(a=i[2])==null||a.call(i),c=0,e=pt(),o=Ut(),Lo([u,$,L,d,S,h,b,R,E,w],Vr))),ns},ns={getContent:Jc,getTables:be,getTableIds:hs,getTable:Yc,getTableCellIds:pn,getRowCount:Un,getRowIds:Xs,getSortedRowIds:we,getRow:qc,getCellIds:Ve,getCell:Mt,getValues:je,getValueIds:xe,getValue:kt,hasTables:pt,hasTable:zn,hasTableCell:Hn,hasRow:Wn,hasCell:On,hasValues:Ut,hasValue:Bn,getTablesJson:Kc,getValuesJson:Xc,getJson:Zc,getTablesSchemaJson:Ic,getValuesSchemaJson:sr,getSchemaJson:tr,hasTablesSchema:()=>s,hasValuesSchema:()=>t,setContent:er,setTables:zt,setTable:nr,setRow:or,addRow:cr,setPartialRow:rr,setCell:ar,setValues:Ht,setPartialValues:ir,setValue:lr,applyChanges:ur,setTablesJson:Gn,setValuesJson:fr,setJson:dr,setTablesSchema:Qn,setValuesSchema:Jn,setSchema:$r,delTables:Wt,delTable:Yn,delRow:qn,delCell:Sr,delValues:Ot,delValue:Tr,delTablesSchema:Kn,delValuesSchema:Ae,delSchema:Cr,transaction:De,startTransaction:Xn,getTransactionChanges:Lr,getTransactionLog:hr,finishTransaction:Zn,forEachTable:n=>os(j,(r,a)=>n(a,l=>os(r,(f,T)=>l(T,y=>ee(f,y))))),forEachTableCell:(n,r)=>ee(v(K,$s(n)),r),forEachRow:(n,r)=>os(v(j,$s(n)),(a,l)=>r(l,f=>ee(a,f))),forEachCell:(n,r,a)=>ee(v(v(j,$s(n)),$s(r)),a),forEachValue:n=>ee(_,n),addSortedRowIdsListener:(n,r,a,l,f,T,y)=>{let x=we(n,r,a,l,f);return _s(()=>{const P=we(n,r,a,l,f);a0(P,x)||(x=P,T(ns,n,r,a,l,f,x))},us[y?1:0],[n,r],[hs])},addStartTransactionListener:n=>_s(n,bs),addWillFinishTransactionListener:n=>_s(n,ks[0]),addDidFinishTransactionListener:n=>_s(n,ks[1]),callListener:n=>(Os(n),ns),delListener:n=>(Xt(n),ns),getListenerStats:()=>({hasTables:ws(J),tables:ws(F),tableIds:ws(Z),hasTable:ws(rs),table:ws(Ss),tableCellIds:ws(m),hasTableCell:ws(I,ro),rowCount:ws(ts),rowIds:ws(Ts),sortedRowIds:ws(us),hasRow:ws(Es,ro),row:ws(Rs,ro),cellIds:ws(X,ro),hasCell:ws(fs,wr),cell:ws(es,wr),invalidCell:ws(ms,wr),hasValues:ws(Ws),values:ws(U),valueIds:ws(g),hasValue:ws(W),value:ws(Cs),invalidValue:ws(Ns),transaction:ua(bs)+ws(ks)}),isMergeable:()=>!1,createStore:Zi,addListener:_s,callListeners:z,setInternalListeners:(n,r,a,l,f)=>i=[n,r,a,l,f]};return Qt({[Pe+va]:[0,J,[],()=>[pt()]],[va]:[0,F],[Y1]:[0,Z],[Pe+ke]:[1,rs,[hs],n=>[zn(...n)]],[ke]:[1,Ss,[hs]],[ke+ma]:[1,m,[hs]],[Pe+ke+uo]:[2,I,[hs,pn],n=>[Hn(...n)]],[q1]:[1,ts,[hs]],[K1]:[1,Ts,[hs]],[Pe+Io]:[2,Es,[hs,Xs],n=>[Wn(...n)]],[Io]:[2,Rs,[hs,Xs]],[ma]:[2,X,[hs,Xs]],[Pe+uo]:[3,fs,[hs,Xs,Ve],n=>[On(...n)]],[uo]:[3,es,[hs,Xs,Ve],n=>Mo(Mt(...n))],InvalidCell:[3,ms],[Pe+Mr]:[0,Ws,[],()=>[Ut()]],[Mr]:[0,U],[X1]:[0,g],[Pe+Ie]:[1,W,[xe],n=>[Bn(...n)]],[Ie]:[1,Cs,[xe],n=>Mo(kt(n[0]))],InvalidValue:[1,Ns]},([n,r,a,l],f)=>{ns[J1+f+Q1]=(...T)=>_s(T[n],r[T[n+1]?1:0],n>0?ka(T,0,n):void 0,a,l)}),Ji(ns)},{PureComponent:j0,createContext:yT,useCallback:Et,useContext:ET,useEffect:bT,useLayoutEffect:x0,useMemo:jo,useRef:Oa,useState:Fe,useSyncExternalStore:wT}=sa,fa=(s,...t)=>ss(s)?{}:s(...t),A0=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getLocalTableId(t),s==null?void 0:s.getRemoteTableId(t)],D0=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getTableId(t)],tc="tinybaseInspector",zr="TinyBase Inspector",Ii=["left","top","bottom","right","full"],ue="state",ec="sort",Hr="open",nc="position",oc=Hr,Ba="editable",Tt=(...s)=>Jt(s),bc=(s,t)=>Ds(Oi([...s]),t),wc=(s,t)=>[!!rn(ue,s,Ba,t),Et(e=>{t.setCell(ue,s,Ba,o=>!o),e.preventDefault()},[t,s])],P0=({s})=>{const t=Ue(nc,s)??1,e=Zo(oc,()=>!0,[],s);return Ue(oc,s)?null:C.jsx("img",{onClick:e,title:zr,"data-position":t})},sl=".",tl="editable",N0="←",v0="↑",m0="→",_0="↓",Ga=(s,t)=>Ds(ca(s,t),e=>s+sl+e),cc=(s,t,e)=>{const o=Et(s,t);return e?o:void 0},Vc=(...s)=>jo(()=>s,s),el=(s,t)=>jo(()=>({store:s,tableId:t}),[s,t]),F0=(s,t)=>jo(()=>({queries:s,queryId:t}),[s,t]),nl=(s,t=!1,e,o=0,c,i,u,$)=>{const[[L,d,S],h]=Fe([s,t,o]),R=Et(N=>{h(N),$==null||$(N)},[$]),E=cc(N=>R([N,N==L?!d:!1,S]),[R,L,d,S],e),b=Et(N=>R([L,d,N]),[R,L,d]),w=u===!0?O0:u;return[[L,d,S],E,jo(()=>u===!1?null:C.jsx(w,{offset:S,limit:c,total:i,onChange:b}),[u,w,S,c,i,b])]},jc=(s,t,e)=>jo(()=>{const o=t??s;return Qt(Co(o)?fo(Ds(o,c=>[c,c])):o,(c,i)=>({label:i,component:e,...n0(c)?{label:c}:c}))},[t,e,s]),da=({className:s,headerRow:t,idColumn:e,params:[o,c,i,u,$,L]})=>C.jsxs("table",{className:s,children:[L?C.jsx("caption",{children:L}):null,t===!1?null:C.jsx("thead",{children:C.jsxs("tr",{children:[e===!1?null:C.jsx(Qa,{sort:u??[],label:"Id",onClick:$}),sn(o,({label:d},S)=>C.jsx(Qa,{cellId:S,label:d,sort:u??[],onClick:$},S))]})}),C.jsx("tbody",{children:Ds(i,d=>C.jsxs("tr",{children:[e===!1?null:C.jsx("th",{children:d}),sn(o,({component:S,getComponentProps:h},R)=>C.jsx("td",{children:C.jsx(S,{...fa(h,d,R),...c,rowId:d,cellId:R})},R))]},d))})]}),Qa=({cellId:s,sort:[t,e],label:o=s??qt,onClick:c})=>C.jsxs("th",{onClick:cc(()=>c==null?void 0:c(s),[c,s],c),className:ss(e)||t!=s?void 0:`sorted ${e?"de":"a"}scending`,children:[ss(e)||t!=s?null:(e?_0:v0)+" ",o]}),M0=({localRowId:s,params:[t,e,o,c,i,u,$]})=>{const L=M1(i,s,u);return C.jsxs("tr",{children:[t===!1?null:C.jsxs(C.Fragment,{children:[C.jsx("th",{children:s}),C.jsx("th",{children:L})]}),sn(e,({component:d,getComponentProps:S},h)=>{const[R,E]=Z1(h,sl,2),b=R===o?s:R===c?L:null;return ss(b)?null:C.jsx("td",{children:C.jsx(d,{...fa(S,b,E),store:$,tableId:R,rowId:b,cellId:E})},h)})]})},ol=({thing:s,onThingChange:t,className:e,hasSchema:o,showType:c=!0})=>{const[i,u]=Fe(),[$,L]=Fe(),[d,S]=Fe(),[h,R]=Fe(),[E,b]=Fe();$!==s&&(u(Ye(s)),L(s),S(String(s)),R(Number(s)||0),b(!!s));const w=Et((D,V)=>{V(D),L(D),t(D)},[t]),N=Et(()=>{if(!(o!=null&&o())){const D=xr(i,yc,pi,Rc),V=xr(D,d,h,E);u(D),L(V),t(V)}},[o,t,d,h,E,i]);return C.jsxs("div",{className:e,children:[c?C.jsx("button",{className:i,onClick:N,children:i}):null,xr(i,C.jsx("input",{value:d,onChange:Et(D=>w(String(D[Xe][_a]),S),[w])},i),C.jsx("input",{type:"number",value:h,onChange:Et(D=>w(Number(D[Xe][_a]||0),R),[w])},i),C.jsx("input",{type:"checkbox",checked:E,onChange:Et(D=>w(!!D[Xe].checked,b),[w])},i))]})},k0=({tableId:s,cellId:t,descending:e,offset:o,limit:c,store:i,editable:u,sortOnClick:$,paginator:L=!1,onChange:d,customCells:S,...h})=>{const[R,E,b]=nl(t,e,$,o,c,j1(s,i),L,d);return C.jsx(da,{...h,params:Vc(jc(ca(s,i),S,u?$a:aa),el(i,s),A1(s,...R,c,i),R,E,b)})},p0=({store:s,editable:t=!1,valueComponent:e=t?W0:O1,getValueComponentProps:o,className:c,headerRow:i,idColumn:u})=>C.jsxs("table",{className:c,children:[i===!1?null:C.jsx("thead",{children:C.jsxs("tr",{children:[u===!1?null:C.jsx("th",{children:"Id"}),C.jsx("th",{children:Ie})]})}),C.jsx("tbody",{children:Ds(ki(s),$=>C.jsxs("tr",{children:[u===!1?null:C.jsx("th",{children:$}),C.jsx("td",{children:C.jsx(e,{...fa(o,$),valueId:$,store:s})})]},$))})]}),U0=({indexId:s,sliceId:t,indexes:e,editable:o,customCells:c,...i})=>{const[u,$,L]=D0(hc(e),s);return C.jsx(da,{...i,params:Vc(jc(ca(L,$),c,o?$a:aa),el($,L),_1(s,t,u))})},z0=({relationshipId:s,relationships:t,editable:e,customCells:o,className:c,headerRow:i,idColumn:u=!0})=>{const[$,L,d,S]=A0(oa(t),s),h=jc([...Ga(d,L),...Ga(S,L)],o,e?$a:aa),R=Vc(u,h,d,S,s,$,L);return C.jsxs("table",{className:c,children:[i===!1?null:C.jsx("thead",{children:C.jsxs("tr",{children:[u===!1?null:C.jsxs(C.Fragment,{children:[C.jsxs("th",{children:[d,".Id"]}),C.jsxs("th",{children:[S,".Id"]})]}),sn(h,({label:E},b)=>C.jsx("th",{children:E},b))]})}),C.jsx("tbody",{children:Ds(x1(d,L),E=>C.jsx(M0,{localRowId:E,params:R},E))})]})},H0=({queryId:s,cellId:t,descending:e,offset:o,limit:c,queries:i,sortOnClick:u,paginator:$=!1,customCells:L,onChange:d,...S})=>{const[h,R,E]=nl(t,e,u,o,c,U1(s,i),$,d);return C.jsx(da,{...S,params:Vc(jc(p1(s,i),L,B1),F0(i,s),z1(s,...h,c,i),h,R,E)})},$a=({tableId:s,rowId:t,cellId:e,store:o,className:c,showType:i})=>{var u;return C.jsx(ol,{thing:rn(s,t,e,o),onThingChange:gc(s,t,e,$=>$,[],o),className:c??tl+uo,showType:i,hasSchema:(u=rt(o))==null?void 0:u.hasTablesSchema})},W0=({valueId:s,store:t,className:e,showType:o})=>{var c;return C.jsx(ol,{thing:Ue(s,t),onThingChange:Zo(s,i=>i,[],t),className:e??tl+Ie,showType:o,hasSchema:(c=rt(t))==null?void 0:c.hasValuesSchema})},O0=({onChange:s,total:t,offset:e=0,limit:o=t,singular:c="row",plural:i=c+"s"})=>{(e>t||e<0)&&(e=0,s(0));const u=cc(()=>s(e-o),[s,e,o],e>0),$=cc(()=>s(e+o),[s,e,o],e+o<t);return C.jsxs(C.Fragment,{children:[t>o&&C.jsxs(C.Fragment,{children:[C.jsx("button",{className:"previous",disabled:e==0,onClick:u,children:N0}),C.jsx("button",{className:"next",disabled:e+o>=t,onClick:$,children:m0}),e+1," to ",s0(t,e+o)," of "]}),t," ",t!=1?i:c]})},Ct=({uniqueId:s,summary:t,editable:e,handleEditable:o,children:c,s:i})=>{const u=!!rn(ue,s,Hr,i),$=gc(ue,s,Hr,L=>L[Xe].open,[],i);return C.jsxs("details",{open:u,onToggle:$,children:[C.jsxs("summary",{children:[t,o?C.jsx("img",{onClick:o,className:e?"done":"edit"}):null]}),c]})},B0=({indexes:s,indexesId:t,indexId:e,s:o})=>C.jsx(Ct,{uniqueId:Tt("i",t,e),summary:"Index: "+e,s:o,children:Ds(v1(e,s),c=>C.jsx(G0,{indexes:s,indexesId:t,indexId:e,sliceId:c,s:o},c))}),G0=({indexes:s,indexesId:t,indexId:e,sliceId:o,s:c})=>{const i=Tt("i",t,e,o),[u,$]=wc(i,c);return C.jsx(Ct,{uniqueId:i,summary:"Slice: "+o,editable:u,handleEditable:$,s:c,children:C.jsx(U0,{sliceId:o,indexId:e,indexes:s,editable:u})})},Ja=({indexesId:s,s:t})=>{const e=mi(s),o=m1(e);return ss(e)?null:C.jsx(Ct,{uniqueId:Tt("i",s),summary:"Indexes: "+(s??nt),s:t,children:yt(o)?"No indexes defined":bc(o,c=>C.jsx(B0,{indexes:e,indexesId:s,indexId:c,s:t},c))})},Q0=({metrics:s,metricId:t})=>C.jsxs("tr",{children:[C.jsx("th",{children:t}),C.jsx("td",{children:s==null?void 0:s.getTableId(t)}),C.jsx("td",{children:N1(t,s)})]}),Ya=({metricsId:s,s:t})=>{const e=Ni(s),o=P1(e);return ss(e)?null:C.jsx(Ct,{uniqueId:Tt("m",s),summary:"Metrics: "+(s??nt),s:t,children:yt(o)?"No metrics defined":C.jsxs("table",{children:[C.jsxs("thead",{children:[C.jsx("th",{children:"Metric Id"}),C.jsx("th",{children:"Table Id"}),C.jsx("th",{children:"Metric"})]}),C.jsx("tbody",{children:Ds(o,c=>C.jsx(Q0,{metrics:e,metricId:c},c))})]})})},J0=({queries:s,queriesId:t,queryId:e,s:o})=>{const c=Tt("q",t,e),[i,u,$]=pe(rn(ue,c,ec,o)??"[]"),L=gc(ue,c,ec,Jt,[],o);return C.jsx(Ct,{uniqueId:c,summary:"Query: "+e,s:o,children:C.jsx(H0,{queryId:e,queries:s,cellId:i,descending:u,offset:$,limit:10,paginator:!0,sortOnClick:!0,onChange:L})})},qa=({queriesId:s,s:t})=>{const e=Fi(s),o=k1(e);return ss(e)?null:C.jsx(Ct,{uniqueId:Tt("q",s),summary:"Queries: "+(s??nt),s:t,children:yt(o)?"No queries defined":bc(o,c=>C.jsx(J0,{queries:e,queriesId:s,queryId:c,s:t},c))})},Y0=({relationships:s,relationshipsId:t,relationshipId:e,s:o})=>{const c=Tt("r",t,e),[i,u]=wc(c,o);return C.jsx(Ct,{uniqueId:c,summary:"Relationship: "+e,editable:i,handleEditable:u,s:o,children:C.jsx(z0,{relationshipId:e,relationships:s,editable:i})})},Ka=({relationshipsId:s,s:t})=>{const e=_i(s),o=F1(e);return ss(e)?null:C.jsx(Ct,{uniqueId:Tt("r",s),summary:"Relationships: "+(s??nt),s:t,children:yt(o)?"No relationships defined":bc(o,c=>C.jsx(Y0,{relationships:e,relationshipsId:s,relationshipId:c,s:t},c))})},q0=({tableId:s,store:t,storeId:e,s:o})=>{const c=Tt("t",e,s),[i,u,$]=pe(rn(ue,c,ec,o)??"[]"),L=gc(ue,c,ec,Jt,[],o),[d,S]=wc(c,o);return C.jsx(Ct,{uniqueId:c,summary:ke+": "+s,editable:d,handleEditable:S,s:o,children:C.jsx(k0,{tableId:s,store:t,cellId:i,descending:u,offset:$,limit:10,paginator:!0,sortOnClick:!0,onChange:L,editable:d})})},K0=({store:s,storeId:t,s:e})=>{const o=Tt("v",t),[c,i]=wc(o,e);return yt(ki(s))?null:C.jsx(Ct,{uniqueId:o,summary:Mr,editable:c,handleEditable:i,s:e,children:C.jsx(p0,{store:s,editable:c})})},Xa=({storeId:s,s:t})=>{const e=Pi(s),o=V1(e);return ss(e)?null:C.jsxs(Ct,{uniqueId:Tt("s",s),summary:(e.isMergeable()?"Mergeable":"")+"Store: "+(s??nt),s:t,children:[C.jsx(K0,{storeId:s,store:e,s:t}),bc(o,c=>C.jsx(q0,{store:e,storeId:s,tableId:c,s:t},c))]})},X0=({s})=>{const t=Oa(null),e=Oa(0),[o,c]=Fe(!1),{scrollLeft:i,scrollTop:u}=D1(s);x0(()=>{const V=t.current;if(V&&!o){const cs=new MutationObserver(()=>{V.scrollWidth>=Ma(i)+V.clientWidth&&V.scrollHeight>=Ma(u)+V.clientHeight&&V.scrollTo(i,u)});return cs.observe(V,{childList:!0,subtree:!0}),()=>cs.disconnect()}},[o,i,u]);const $=Et(V=>{const{scrollLeft:cs,scrollTop:Ls}=V[Xe];cancelIdleCallback(e.current),e.current=requestIdleCallback(()=>{c(!0),s.setPartialValues({scrollLeft:cs,scrollTop:Ls})})},[s]),L=Pi(),d=S1(),S=Ni(),h=T1(),R=mi(),E=C1(),b=_i(),w=L1(),N=Fi(),D=h1();return ss(L)&&yt(d)&&ss(S)&&yt(h)&&ss(R)&&yt(E)&&ss(b)&&yt(w)&&ss(N)&&yt(D)?C.jsx("span",{className:"warn",children:"There are no Stores or other objects to inspect. Make sure you placed the Inspector inside a Provider component."}):C.jsxs("article",{ref:t,onScroll:$,children:[C.jsx(Xa,{s}),Ds(d,V=>C.jsx(Xa,{storeId:V,s},V)),C.jsx(Ya,{s}),Ds(h,V=>C.jsx(Ya,{metricsId:V,s},V)),C.jsx(Ja,{s}),Ds(E,V=>C.jsx(Ja,{indexesId:V,s},V)),C.jsx(Ka,{s}),Ds(w,V=>C.jsx(Ka,{relationshipsId:V,s},V)),C.jsx(qa,{s}),Ds(D,V=>C.jsx(qa,{queriesId:V,s},V))]})};class Z0 extends j0{constructor(e){super(e);ja(this,"componentDidCatch",(e,o)=>console.error(e,o.componentStack));this.state={e:0}}static getDerivedStateFromError(){return{e:1}}render(){return this.state.e?C.jsx("span",{className:"warn",children:"Inspector error: please see console for details."}):this.props.children}}const I0=({s})=>{const t=Ue(nc,s)??1,e=Zo(oc,()=>!1,[],s),o=Zo(nc,c=>Number(c[Xe].dataset.id),[],s);return C.jsxs("header",{children:[C.jsx("img",{title:zr}),C.jsx("span",{children:zr}),Ds(Ii,(c,i)=>i==t?null:C.jsx("img",{onClick:o,"data-id":i,title:"Dock to "+c},i)),C.jsx("img",{onClick:e,title:"Close"})]})},sf=({s})=>{const t=Ue(nc,s)??1;return Ue(oc,s)?C.jsxs("main",{"data-position":t,children:[C.jsx(I0,{s}),C.jsx(Z0,{children:C.jsx(X0,{s})})]}):null};var tf="data:image/svg+xml,%3csvg viewBox='0 0 680 680' xmlns='http://www.w3.org/2000/svg' style='width:680px%3bheight:680px'%3e %3cpath stroke='white' stroke-width='80' fill='none' d='M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z' /%3e %3cpath fill='%23d81b60' d='M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z' /%3e %3cpath d='M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z' /%3e%3c/svg%3e";const cl="M20 80l5-15l40-40l10 10l-40 40l-15 5m5-15l10 10",rl='content:url("',al='")',xc=rl+"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' stroke-width='4' stroke='white' fill='none'>",Ac="</svg>"+al,Za=rl+tf+al,ef=Ds([[20,20,20,60],[20,20,60,20],[20,60,60,20],[60,20,20,60],[30,30,40,40]],([s,t,e,o])=>xc+`<rect x='20' y='20' width='60' height='60' fill='grey'/><rect x='${s}' y='${t}' width='${e}' height='${o}' fill='white'/>`+Ac),nf=xc+"<path d='M20 20l60 60M20 80l60-60' />"+Ac,of=xc+`<path d='${cl}' />`+Ac,cf=xc+`<path d='${cl}M20 20l60 60' />`+Ac,eo="*::-webkit-scrollbar",rf=i0(sn({"":"all:initial;font-family:sans-serif;font-size:0.75rem;position:fixed;z-index:999999","*":"all:revert","*::before":"all:revert","*::after":"all:revert",[eo]:"width:0.5rem;height:0.5rem;",[eo+"-track"]:"background:#111",[eo+"-thumb"]:"background:#999;border:1px solid #111",[eo+"-thumb:hover"]:"background:#fff",[eo+"-corner"]:"background:#111",img:"width:1rem;height:1rem;background:#111;border:0;vertical-align:text-bottom",">img":"padding:0.25rem;bottom:0;right:0;position:fixed;"+Za,...fo(Ds(["bottom:0;left:0","top:0;right:0"],(s,t)=>[`>img[data-position='${t}']`,s])),main:"display:flex;flex-direction:column;background:#111d;color:#fff;position:fixed;",...fo(Ds(["bottom:0;left:0;width:35vw;height:100vh","top:0;right:0;width:100vw;height:30vh","bottom:0;left:0;width:100vw;height:30vh","top:0;right:0;width:35vw;height:100vh","top:0;right:0;width:100vw;height:100vh"],(s,t)=>[`main[data-position='${t}']`,s])),header:"display:flex;padding:0.25rem;background:#000;align-items:center","header>img:nth-of-type(1)":Za,"header>img:nth-of-type(6)":nf,...fo(Ds(ef,(s,t)=>[`header>img[data-id='${t}']`,s])),"header>span":"flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-left:0.25rem",article:"padding:0.25rem 0.25rem 0.25rem 0.5rem;overflow:auto;flex:1",details:"margin-left:0.75rem;width:fit-content;","details img":"display:none","details[open]>summary img":"display:unset;background:none;margin-left:0.25rem","details[open]>summary img.edit":of,"details[open]>summary img.done":cf,summary:"margin-left:-0.75rem;line-height:1.25rem;user-select:none;width:fit-content",table:"border-collapse:collapse;table-layout:fixed;margin-bottom:0.5rem","table input":"background:#111;color:unset;padding:0 0.25rem;border:0;font-size:unset;vertical-align:top;margin:0",'table input[type="number"]':"width:4rem","table tbody button":"font-size:0;background:#fff;border-radius:50%;margin:0 0.125rem 0 0;width:0.85rem;color:#111","table button:first-letter":"font-size:0.75rem",thead:"background:#222","th:nth-of-type(1)":"min-width:2rem;","th.sorted":"background:#000","table caption":"text-align:left;white-space:nowrap;line-height:1.25rem",button:"width:1.5rem;border:none;background:none;color:#fff;padding:0","button[disabled]":"color:#777","button.next":"margin-right:0.5rem",[`th,#${tc} td`]:"overflow:hidden;text-overflow:ellipsis;padding:0.25rem 0.5rem;max-width:12rem;white-space:nowrap;border-width:1px 0;border-style:solid;border-color:#777;text-align:left","span.warn":"margin:0.25rem;color:#d81b60"},(s,t)=>s?`#${tc} ${t}{${s}}`:"")),VT=({position:s="right",open:t=!1})=>{const e=w1(Zi),o=Ii.indexOf(s);return W1(e,c=>w0(c,tc),void 0,async c=>{await c.load([{},{position:o==-1?1:o,open:!!t}]),await c.startAutoSave()}),C.jsxs(C.Fragment,{children:[C.jsxs("aside",{id:tc,children:[C.jsx(P0,{s:e}),C.jsx(sf,{s:e})]}),C.jsx("style",{children:rf})]})},go=s=>typeof s,af="tinybase",ct="",lf=go(ct),uf=go(go),ff="Listener",Bs="Result",df="get",$f="set",Sf="add",Tf="del",Se="Has",Cf="has",st="Ids",Gs="Table",an=Gs+"s",il=Gs+st,tt="Row",Dc=tt+"Count",Dt=tt+st,Pc="Sorted"+tt+st,Lt="Cell",Te=Lt+st,Ce="Value",Be=Ce+"s",ll=Ce+st,Sa="Transaction",ul="Partial",fl="Finish",Nc="Status",Ta="Metric",Lf="Index",vc="Slice",hf="Relationship",dl="Remote"+tt+"Id",$l="Local",Sl="Linked",gf="Query",mc="Checkpoint",Ar=globalThis,$t=s=>s==null,St=(s,t,e)=>$t(s)?e==null?void 0:e():t(s),Tl=s=>go(s)==lf,Ca=s=>go(s)==uf,Rf=s=>Array.isArray(s),Ro=s=>s.length,tn=()=>{},yf=(s,t)=>et(new Array(s).fill(0),(e,o)=>t(o)),Cl=(s,t)=>s.every(t),Dr=(s,t)=>Ro(s)===Ro(t)&&Cl(s,(e,o)=>t[o]===e),et=(s,t)=>s.map(t),Ef=s=>Ro(s)==0,bf=(s,t)=>s.filter(t),Ia=(s,t,e)=>s.with(t,e),_c=Object,si=s=>_c.getPrototypeOf(s),wf=_c.entries,ti=s=>!$t(s)&&St(si(s),t=>t==_c.prototype||$t(si(t)),()=>!0),Ll=_c.keys,hl=(s,t)=>St(s,e=>e[t]),Vf=(s,t)=>t in s,jf=(s,t)=>(delete s[t],s),xf=s=>Ro(Ll(s)),gl=(s,t)=>{const e=wf(s);return Ro(e)===xf(t)&&Cl(e,([o,c])=>ti(c)?ti(t[o])?gl(t[o],c):!1:t[o]===c)},{PureComponent:jT,createContext:Af,useCallback:jt,useContext:xo,useEffect:en,useLayoutEffect:Df,useMemo:La,useRef:Pf,useState:nn,useSyncExternalStore:Nf}=sa,ht=(s,...t)=>$t(s)?{}:s(...t),Rl=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getLocalTableId(t),s==null?void 0:s.getRemoteTableId(t)],vf=(s,t)=>[s,s==null?void 0:s.getStore(),s==null?void 0:s.getTableId(t)],Pr=af+"_uirc",on=Ar[Pr]?Ar[Pr]:Ar[Pr]=Af([]),Kt=(s,t)=>{const e=xo(on);return $t(s)?e[t*2]:Tl(s)?hl(e[t*2+1],s):s},mf=s=>({...xo(on)[s*2+1]}),Le=(s,t)=>{const e=Kt(s,t);return $t(s)||Tl(s)?e:s},he=(s,t,e)=>{const{16:o,17:c}=xo(on);en(()=>(o==null||o(e,s,t),()=>c==null?void 0:c(e,s)),[o,s,t,e,c])},ge=s=>Ll(xo(on)[s*2+1]??{}),_f=()=>ge(0),Ff=s=>Kt(s,0),Mf=()=>mf(0),p=s=>Le(s,0),kf=(s,t)=>he(s,t,0),pf=()=>ge(1),Uf=s=>Kt(s,1),Fc=s=>Le(s,1),zf=(s,t)=>he(s,t,1),Hf=()=>ge(2),Wf=s=>Kt(s,2),Ge=s=>Le(s,2),Of=(s,t)=>he(s,t,2),Bf=()=>ge(3),Gf=s=>Kt(s,3),Pt=s=>Le(s,3),Qf=(s,t)=>he(s,t,3),Jf=()=>ge(4),Yf=s=>Kt(s,4),Us=s=>Le(s,4),qf=(s,t)=>he(s,t,4),Kf=()=>ge(5),Xf=s=>Kt(s,5),gt=s=>Le(s,5),Zf=(s,t)=>he(s,t,5),If=()=>ge(6),sd=s=>Kt(s,6),ha=s=>Le(s,6),td=(s,t)=>he(s,t,6),ed=()=>ge(7),nd=s=>Kt(s,7),ga=s=>Le(s,7),od=(s,t)=>he(s,t,7),gs=[],ei=[{},[],[gs,void 0,gs],void 0,!1,0],cd=[gl,Dr,([s,t,e],[o,c,i])=>t===c&&Dr(s,o)&&Dr(e,i)],rd=(s,t)=>s===t,Ao=(s,t,e=gs)=>{const[,o]=nn(),[c,i]=nn();return en(()=>{const u=s?t(s):void 0;return i(u),o([]),u==null?void 0:u.destroy},[s,...e]),c},yl=(s,t,...e)=>{var c;const o=(c=s==null?void 0:s[Sf+t+ff])==null?void 0:c.call(s,...e);return()=>{var i;return(i=s==null?void 0:s.delListener)==null?void 0:i.call(s,o)}},G=(s,t,e,o=gs)=>{const c=Pf(ei[e]),i=jt(()=>{var L;const $=((L=t==null?void 0:t[(e==4?Cf:df)+s])==null?void 0:L.call(t,...o))??ei[e];return(cd[e]??rd)($,c.current)?c.current:c.current=$},[t,e,s,...o]),u=jt($=>yl(t,(e==4?Se:ct)+s,...o,$),[t,e,s,...o]);return Nf(u,i,i)},Q=(s,t,e,o=gs,c=gs,...i)=>Df(()=>yl(t,s,...c,e,...i),[t,s,...c,...o,...i]),Re=(s,t,e,o=gs,c=tn,i=gs,...u)=>{const $=p(s);return jt(L=>St($,d=>St(e(L,d),S=>c(d[$f+t](...El(u,d,L),S),S))),[$,t,...o,...i,...bl(u)])},El=(s,t,e)=>et(s,o=>Ca(o)?o(e,t):o),bl=s=>bf(s,t=>!Ca(t)),ln=(s,t,e=tn,o=gs,...c)=>{const i=p(s);return jt(u=>e(i==null?void 0:i[Tf+t](...El(c,i,u))),[i,t,...o,...bl(c)])},wl=(s,t,e)=>{const o=gt(s);return jt(()=>o==null?void 0:o[t](e),[o,t,e])},ad=(s,t=gs)=>La(s,t),id=(s,t=gs)=>La(s,t),ld=s=>G(an,p(s),4,[]),ud=s=>G(an,p(s),0),Vl=s=>G(il,p(s),1),fd=(s,t)=>G(Gs,p(t),4,[s]),dd=(s,t)=>G(Gs,p(t),0,[s]),$d=(s,t)=>G(Gs+Te,p(t),1,[s]),Sd=(s,t,e)=>G(Gs+Lt,p(e),4,[s,t]),Td=(s,t)=>G(Dc,p(t),5,[s]),jl=(s,t)=>G(Dt,p(t),1,[s]),xl=(s,t,e,o=0,c,i)=>G(Pc,p(i),1,[s,t,e,o,c]),Cd=(s,t,e)=>G(tt,p(e),4,[s,t]),Ld=(s,t,e)=>G(tt,p(e),0,[s,t]),Al=(s,t,e)=>G(Te,p(e),1,[s,t]),hd=(s,t,e,o)=>G(Lt,p(o),4,[s,t,e]),Dl=(s,t,e,o)=>G(Lt,p(o),3,[s,t,e]),gd=s=>G(Be,p(s),4,[]),Rd=s=>G(Be,p(s),0),Pl=s=>G(ll,p(s),1),yd=(s,t)=>G(Ce,p(t),4,[s]),Nl=(s,t)=>G(Ce,p(t),3,[s]),Ed=(s,t,e,o,c)=>Re(e,an,s,t,o,c),bd=(s,t,e,o,c,i)=>Re(o,Gs,t,e,c,i,s),wd=(s,t,e,o,c,i,u)=>Re(c,tt,e,o,i,u,s,t),Vd=(s,t,e=gs,o,c=tn,i=gs,u=!0)=>{const $=p(o);return jt(L=>St($,d=>St(t(L,d),S=>c(d.addRow(Ca(s)?s(L,d):s,S,u),d,S))),[$,s,...e,...i,u])},jd=(s,t,e,o,c,i,u)=>Re(c,ul+tt,e,o,i,u,s,t),xd=(s,t,e,o,c,i,u,$)=>Re(i,Lt,o,c,u,$,s,t,e),Ad=(s,t,e,o,c)=>Re(e,Be,s,t,o,c),Dd=(s,t,e,o,c)=>Re(e,ul+Be,s,t,o,c),Pd=(s,t,e,o,c,i)=>Re(o,Ce,t,e,c,i,s),Nd=(s,t,e)=>ln(s,an,t,e),vd=(s,t,e,o)=>ln(t,Gs,e,o,s),md=(s,t,e,o,c)=>ln(e,tt,o,c,s,t),_d=(s,t,e,o,c,i,u)=>ln(c,Lt,i,u,s,t,e,o),Fd=(s,t,e)=>ln(s,Be,t,e),Md=(s,t,e,o)=>ln(t,Ce,e,o,s),kd=(s,t,e,o)=>Q(Se+an,p(o),s,t,[],e),pd=(s,t,e,o)=>Q(an,p(o),s,t,gs,e),Ud=(s,t,e,o)=>Q(il,p(o),s,t,gs,e),zd=(s,t,e,o,c)=>Q(Se+Gs,p(c),t,e,[s],o),Hd=(s,t,e,o,c)=>Q(Gs,p(c),t,e,[s],o),Wd=(s,t,e,o,c)=>Q(Gs+Te,p(c),t,e,[s],o),Od=(s,t,e,o,c,i)=>Q(Se+Gs+Lt,p(i),e,o,[s,t],c),Bd=(s,t,e,o,c)=>Q(Dc,p(c),t,e,[s],o),Gd=(s,t,e,o,c)=>Q(Dt,p(c),t,e,[s],o),Qd=(s,t,e,o,c,i,u,$,L)=>Q(Pc,p(L),i,u,[s,t,e,o,c],$),Jd=(s,t,e,o,c,i)=>Q(Se+tt,p(i),e,o,[s,t],c),Yd=(s,t,e,o,c,i)=>Q(tt,p(i),e,o,[s,t],c),qd=(s,t,e,o,c,i)=>Q(Te,p(i),e,o,[s,t],c),Kd=(s,t,e,o,c,i,u)=>Q(Se+Lt,p(u),o,c,[s,t,e],i),Xd=(s,t,e,o,c,i,u)=>Q(Lt,p(u),o,c,[s,t,e],i),Zd=(s,t,e,o)=>Q(Se+Be,p(o),s,t,[],e),Id=(s,t,e,o)=>Q(Be,p(o),s,t,gs,e),s$=(s,t,e,o)=>Q(ll,p(o),s,t,gs,e),t$=(s,t,e,o,c)=>Q(Se+Ce,p(c),t,e,[s],o),e$=(s,t,e,o,c)=>Q(Ce,p(c),t,e,[s],o),n$=(s,t,e)=>Q("Start"+Sa,p(e),s,t),o$=(s,t,e)=>Q("Will"+fl+Sa,p(e),s,t),c$=(s,t,e)=>Q("Did"+fl+Sa,p(e),s,t),r$=(s,t,e)=>Ao(s,t,e),a$=s=>G(Ta+st,Fc(s),1),vl=(s,t)=>G(Ta,Fc(t),3,[s]),i$=(s,t,e,o)=>Q(Ta,Fc(o),t,e,[s]),l$=(s,t,e)=>Ao(s,t,e),ml=(s,t)=>G(vc+st,Ge(t),1,[s]),u$=s=>G(Lf+st,Ge(s),1),_l=(s,t,e)=>G(vc+Dt,Ge(e),1,[s,t]),f$=(s,t,e,o)=>Q(vc+st,Ge(o),t,e,[s]),d$=(s,t,e,o,c)=>Q(vc+Dt,Ge(c),e,o,[s,t]),$$=(s,t,e)=>Ao(s,t,e),S$=s=>G(hf+st,Pt(s),1),Fl=(s,t,e)=>G(dl,Pt(e),3,[s,t]),Ml=(s,t,e)=>G($l+Dt,Pt(e),1,[s,t]),kl=(s,t,e)=>G(Sl+Dt,Pt(e),1,[s,t]),T$=(s,t,e,o,c)=>Q(dl,Pt(c),e,o,[s,t]),C$=(s,t,e,o,c)=>Q($l+Dt,Pt(c),e,o,[s,t]),L$=(s,t,e,o,c)=>Q(Sl+Dt,Pt(c),e,o,[s,t]),h$=(s,t,e)=>Ao(s,t,e),g$=s=>G(gf+st,Us(s),1),R$=(s,t)=>G(Bs+Gs,Us(t),0,[s]),y$=(s,t)=>G(Bs+Gs+Te,Us(t),1,[s]),E$=(s,t)=>G(Bs+Dc,Us(t),5,[s]),pl=(s,t)=>G(Bs+Dt,Us(t),1,[s]),Ul=(s,t,e,o=0,c,i)=>G(Bs+Pc,Us(i),1,[s,t,e,o,c]),b$=(s,t,e)=>G(Bs+tt,Us(e),0,[s,t]),zl=(s,t,e)=>G(Bs+Te,Us(e),1,[s,t]),Hl=(s,t,e,o)=>G(Bs+Lt,Us(o),3,[s,t,e]),w$=(s,t,e,o)=>Q(Bs+Gs,Us(o),t,e,[s]),V$=(s,t,e,o)=>Q(Bs+Gs+Te,Us(o),t,e,[s]),j$=(s,t,e,o)=>Q(Bs+Dc,Us(o),t,e,[s]),x$=(s,t,e,o)=>Q(Bs+Dt,Us(o),t,e,[s]),A$=(s,t,e,o,c,i,u,$)=>Q(Bs+Pc,Us($),i,u,[s,t,e,o,c]),D$=(s,t,e,o,c)=>Q(Bs+tt,Us(c),e,o,[s,t]),P$=(s,t,e,o,c)=>Q(Bs+Te,Us(c),e,o,[s,t]),N$=(s,t,e,o,c,i)=>Q(Bs+Lt,Us(i),o,c,[s,t,e]),v$=(s,t,e)=>Ao(s,t,e),Mc=s=>G(mc+st,gt(s),2),Wl=(s,t)=>G(mc,gt(t),3,[s]),m$=(s=tn,t=gs,e,o=tn,c=gs)=>{const i=gt(e);return jt(u=>St(i,$=>{const L=s(u);o($.addCheckpoint(L),$,L)}),[i,...t,...c])},Ol=s=>wl(s,"goBackward"),Bl=s=>wl(s,"goForward"),_$=(s,t=gs,e,o=tn,c=gs)=>{const i=gt(e);return jt(u=>St(i,$=>St(s(u),L=>o($.goTo(L),L))),[i,...t,...c])},F$=s=>{const t=gt(s),[e,o]=Mc(t);return[!Ef(e),Ol(t),o,St(o,c=>t==null?void 0:t.getCheckpoint(c))??ct]},M$=s=>{const t=gt(s),[,,[e]]=Mc(t);return[!$t(e),Bl(t),e,St(e,o=>t==null?void 0:t.getCheckpoint(o))??ct]},k$=(s,t,e)=>Q(mc+st,gt(e),s,t),p$=(s,t,e,o)=>Q(mc,gt(o),t,e,[s]),U$=(s,t,e=gs,o,c=gs,i,u=gs)=>{const[,$]=nn(),[L,d]=nn();return en(()=>{(async()=>{const S=s?await t(s):void 0;d(S),S&&o&&(async()=>(await o(S),$([])))()})()},[s,...e,...c]),en(()=>()=>{L&&(L.destroy(),i==null||i(L))},[L,...u]),L},z$=s=>G(Nc,ha(s),5,[]),H$=(s,t,e)=>Q(Nc,ha(e),s,t,[]),W$=(s,t,e=gs,o,c=gs)=>{const[i,u]=nn();return en(()=>{(async()=>{const $=s?await t(s):void 0;u($)})()},[s,...e]),en(()=>()=>{i&&(i.destroy(),o==null||o(i))},[i,...c]),i},O$=s=>G(Nc,ga(s),5,[]),B$=(s,t,e)=>Q(Nc,ga(e),s,t,[]),se=(s,t,e,o,c)=>[e??t[s*2],{...t[s*2+1],...o,...c[s]}],Gl=({tableId:s,store:t,rowComponent:e=Do,getRowComponentProps:o,customCellIds:c,separator:i,debugIds:u},$)=>Qs(et($,L=>C.jsx(e,{...ht(o,L),tableId:s,rowId:L,customCellIds:c,store:t,debugIds:u},L)),i,u,s),Ql=({queryId:s,queries:t,resultRowComponent:e=Il,getResultRowComponentProps:o,separator:c,debugIds:i},u)=>Qs(et(u,$=>C.jsx(e,{...ht(o,$),queryId:s,rowId:$,queries:t,debugIds:i},$)),c,i,s),Jl=({relationshipId:s,relationships:t,rowComponent:e=Do,getRowComponentProps:o,separator:c,debugIds:i},u,$)=>{const[L,d,S]=Rl(Pt(t),s),h=u(s,$,L);return Qs(et(h,R=>C.jsx(e,{...ht(o,R),tableId:S,rowId:R,store:d,debugIds:i},R)),c,i,$)},Ra=s=>({checkpoints:t,checkpointComponent:e=su,getCheckpointComponentProps:o,separator:c,debugIds:i})=>{const u=gt(t);return Qs(et(s(Mc(u)),$=>C.jsx(e,{...ht(o,$),checkpoints:u,checkpointId:$,debugIds:i},$)),c)},G$=({store:s,storesById:t,metrics:e,metricsById:o,indexes:c,indexesById:i,relationships:u,relationshipsById:$,queries:L,queriesById:d,checkpoints:S,checkpointsById:h,persister:R,persistersById:E,synchronizer:b,synchronizersById:w,children:N})=>{const D=xo(on),[V,cs]=nn(()=>yf(8,()=>({}))),Ls=jt((K,j,_)=>cs(J=>hl(J[K],j)==_?J:Ia(J,K,{...J[K],[j]:_})),[]),is=jt((K,j)=>cs(_=>Vf(_[K],j)?Ia(_,K,jf(_[K],j)):_),[]);return C.jsx(on.Provider,{value:La(()=>[...se(0,D,s,t,V),...se(1,D,e,o,V),...se(2,D,c,i,V),...se(3,D,u,$,V),...se(4,D,L,d,V),...se(5,D,S,h,V),...se(6,D,R,E,V),...se(7,D,b,w,V),Ls,is],[V,s,t,e,o,c,i,u,$,L,d,S,h,R,E,b,w,D,Ls,is]),children:N})},Qs=(s,t,e,o)=>{const c=$t(t)||!Rf(s)?s:et(s,(i,u)=>u>0?[t,i]:i);return e?[o,":{",c,"}"]:c},Q$=(s,t,e,o)=>{const c=Al(t,e,o);return s??c},Yl=({tableId:s,rowId:t,cellId:e,store:o,debugIds:c})=>Qs(ct+(Dl(s,t,e,o)??ct),void 0,c,e),Do=({tableId:s,rowId:t,store:e,cellComponent:o=Yl,getCellComponentProps:c,customCellIds:i,separator:u,debugIds:$})=>Qs(et(Q$(i,s,t,e),L=>C.jsx(o,{...ht(c,L),tableId:s,rowId:t,cellId:L,store:e,debugIds:$},L)),u,$,t),ql=s=>Gl(s,jl(s.tableId,s.store)),J$=({cellId:s,descending:t,offset:e,limit:o,...c})=>Gl(c,xl(c.tableId,s,t,e,o,c.store)),Y$=({store:s,tableComponent:t=ql,getTableComponentProps:e,separator:o,debugIds:c})=>Qs(et(Vl(s),i=>C.jsx(t,{...ht(e,i),tableId:i,store:s,debugIds:c},i)),o),Kl=({valueId:s,store:t,debugIds:e})=>Qs(ct+(Nl(s,t)??ct),void 0,e,s),q$=({store:s,valueComponent:t=Kl,getValueComponentProps:e,separator:o,debugIds:c})=>Qs(et(Pl(s),i=>C.jsx(t,{...ht(e,i),valueId:i,store:s,debugIds:c},i)),o),K$=({metricId:s,metrics:t,debugIds:e})=>Qs(vl(s,t)??ct,void 0,e,s),Xl=({indexId:s,sliceId:t,indexes:e,rowComponent:o=Do,getRowComponentProps:c,separator:i,debugIds:u})=>{const[$,L,d]=vf(Ge(e),s),S=_l(s,t,$);return Qs(et(S,h=>C.jsx(o,{...ht(c,h),tableId:d,rowId:h,store:L,debugIds:u},h)),i,u,t)},X$=({indexId:s,indexes:t,sliceComponent:e=Xl,getSliceComponentProps:o,separator:c,debugIds:i})=>Qs(et(ml(s,t),u=>C.jsx(e,{...ht(o,u),indexId:s,sliceId:u,indexes:t,debugIds:i},u)),c,i,s),Z$=({relationshipId:s,localRowId:t,relationships:e,rowComponent:o=Do,getRowComponentProps:c,debugIds:i})=>{const[u,$,,L]=Rl(Pt(e),s),d=Fl(s,t,u);return Qs($t(L)||$t(d)?null:C.jsx(o,{...ht(c,d),tableId:L,rowId:d,store:$,debugIds:i},d),void 0,i,t)},I$=s=>Jl(s,Ml,s.remoteRowId),sS=s=>Jl(s,kl,s.firstRowId),Zl=({queryId:s,rowId:t,cellId:e,queries:o,debugIds:c})=>Qs(ct+(Hl(s,t,e,o)??ct),void 0,c,e),Il=({queryId:s,rowId:t,queries:e,resultCellComponent:o=Zl,getResultCellComponentProps:c,separator:i,debugIds:u})=>Qs(et(zl(s,t,e),$=>C.jsx(o,{...ht(c,$),queryId:s,rowId:t,cellId:$,queries:e,debugIds:u},$)),i,u,t),tS=s=>Ql(s,pl(s.queryId,s.queries)),eS=({cellId:s,descending:t,offset:e,limit:o,...c})=>Ql(c,Ul(c.queryId,s,t,e,o,c.queries)),su=({checkpoints:s,checkpointId:t,debugIds:e})=>Qs(Wl(t,s)??ct,void 0,e,t),nS=Ra(s=>s[0]),oS=Ra(s=>$t(s[1])?[]:[s[1]]),cS=Ra(s=>s[2]),xT=Object.freeze(Object.defineProperty({__proto__:null,BackwardCheckpointsView:nS,CellView:Yl,CheckpointView:su,CurrentCheckpointView:oS,ForwardCheckpointsView:cS,IndexView:X$,LinkedRowsView:sS,LocalRowsView:I$,MetricView:K$,Provider:G$,RemoteRowView:Z$,ResultCellView:Zl,ResultRowView:Il,ResultSortedTableView:eS,ResultTableView:tS,RowView:Do,SliceView:Xl,SortedTableView:J$,TableView:ql,TablesView:Y$,ValueView:Kl,ValuesView:q$,useAddRowCallback:Vd,useCell:Dl,useCellIds:Al,useCellIdsListener:qd,useCellListener:Xd,useCheckpoint:Wl,useCheckpointIds:Mc,useCheckpointIdsListener:k$,useCheckpointListener:p$,useCheckpoints:Xf,useCheckpointsIds:Kf,useCheckpointsOrCheckpointsById:gt,useCreateCheckpoints:v$,useCreateIndexes:l$,useCreateMergeableStore:id,useCreateMetrics:r$,useCreatePersister:U$,useCreateQueries:h$,useCreateRelationships:$$,useCreateStore:ad,useCreateSynchronizer:W$,useDelCellCallback:_d,useDelRowCallback:md,useDelTableCallback:vd,useDelTablesCallback:Nd,useDelValueCallback:Md,useDelValuesCallback:Fd,useDidFinishTransactionListener:c$,useGoBackwardCallback:Ol,useGoForwardCallback:Bl,useGoToCallback:_$,useHasCell:hd,useHasCellListener:Kd,useHasRow:Cd,useHasRowListener:Jd,useHasTable:fd,useHasTableCell:Sd,useHasTableCellListener:Od,useHasTableListener:zd,useHasTables:ld,useHasTablesListener:kd,useHasValue:yd,useHasValueListener:t$,useHasValues:gd,useHasValuesListener:Zd,useIndexIds:u$,useIndexes:Wf,useIndexesIds:Hf,useIndexesOrIndexesById:Ge,useLinkedRowIds:kl,useLinkedRowIdsListener:L$,useLocalRowIds:Ml,useLocalRowIdsListener:C$,useMetric:vl,useMetricIds:a$,useMetricListener:i$,useMetrics:Uf,useMetricsIds:pf,useMetricsOrMetricsById:Fc,usePersister:sd,usePersisterIds:If,usePersisterOrPersisterById:ha,usePersisterStatus:z$,usePersisterStatusListener:H$,useProvideCheckpoints:Zf,useProvideIndexes:Of,useProvideMetrics:zf,useProvidePersister:td,useProvideQueries:qf,useProvideRelationships:Qf,useProvideStore:kf,useProvideSynchronizer:od,useQueries:Yf,useQueriesIds:Jf,useQueriesOrQueriesById:Us,useQueryIds:g$,useRedoInformation:M$,useRelationshipIds:S$,useRelationships:Gf,useRelationshipsIds:Bf,useRelationshipsOrRelationshipsById:Pt,useRemoteRowId:Fl,useRemoteRowIdListener:T$,useResultCell:Hl,useResultCellIds:zl,useResultCellIdsListener:P$,useResultCellListener:N$,useResultRow:b$,useResultRowCount:E$,useResultRowCountListener:j$,useResultRowIds:pl,useResultRowIdsListener:x$,useResultRowListener:D$,useResultSortedRowIds:Ul,useResultSortedRowIdsListener:A$,useResultTable:R$,useResultTableCellIds:y$,useResultTableCellIdsListener:V$,useResultTableListener:w$,useRow:Ld,useRowCount:Td,useRowCountListener:Bd,useRowIds:jl,useRowIdsListener:Gd,useRowListener:Yd,useSetCellCallback:xd,useSetCheckpointCallback:m$,useSetPartialRowCallback:jd,useSetPartialValuesCallback:Dd,useSetRowCallback:wd,useSetTableCallback:bd,useSetTablesCallback:Ed,useSetValueCallback:Pd,useSetValuesCallback:Ad,useSliceIds:ml,useSliceIdsListener:f$,useSliceRowIds:_l,useSliceRowIdsListener:d$,useSortedRowIds:xl,useSortedRowIdsListener:Qd,useStartTransactionListener:n$,useStore:Ff,useStoreIds:_f,useStoreOrStoreById:p,useStores:Mf,useSynchronizer:nd,useSynchronizerIds:ed,useSynchronizerOrSynchronizerById:ga,useSynchronizerStatus:O$,useSynchronizerStatusListener:B$,useTable:dd,useTableCellIds:$d,useTableCellIdsListener:Wd,useTableIds:Vl,useTableIdsListener:Ud,useTableListener:Hd,useTables:ud,useTablesListener:pd,useUndoInformation:F$,useValue:Nl,useValueIds:Pl,useValueIdsListener:s$,useValueListener:e$,useValues:Rd,useValuesListener:Id,useWillFinishTransactionListener:o$},Symbol.toStringTag,{value:"Module"})),rc="",tu="￼",rS=globalThis,ni=rS.window,bt=s=>s==null,ac=(s,t,e)=>bt(s)?e==null?void 0:e():t(s),Wr=s=>Array.isArray(s),ze=s=>s.length,aS=(s,t)=>s.test(t),eu=s=>{throw new Error(s)},Or=(s,t)=>s.forEach(t),iS=(s,t)=>s.splice(0,t),ya=(s,...t)=>s.push(...t),nu=s=>s.shift(),kc=Object,oi=s=>kc.getPrototypeOf(s),lS=s=>!bt(s)&&ac(oi(s),t=>t==kc.prototype||bt(oi(t)),()=>!0),uS=kc.keys,fS=kc.freeze,dS=s=>ze(uS(s)),po=s=>lS(s)&&dS(s)==0,$S=JSON.stringify,ou=JSON.parse,SS=s=>$S(s,(t,e)=>e===void 0?tu:e),TS=s=>ou(s,(t,e)=>e===tu?void 0:e),CS=s=>(s==null?void 0:s.size)??0,LS=(s,t)=>(s==null?void 0:s.has(t))??!1,cu=s=>bt(s)||CS(s)==0,ru=(s,t)=>s==null?void 0:s.forEach(t),au=(s,t)=>s==null?void 0:s.delete(t),Po=s=>new Map(s),ft=(s,t)=>s==null?void 0:s.get(t),He=(s,t,e)=>bt(e)?(au(s,t),s):s==null?void 0:s.set(t,e),Br=(s,t,e,o)=>(LS(s,t)?o==null||o(ft(s,t)):He(s,t,e()),ft(s,t)),Gr=(s,t,e,o,c=0)=>ac((e?Br:ft)(s,t[c],c>ze(t)-2?e:Po),i=>{if(c>ze(t)-2)return o!=null&&o(i)&&He(s,t[c]),i;const u=Gr(i,t,e,o,c+1);return cu(i)&&He(s,t[c]),u}),hS=/^\d+$/,gS=()=>{const s=[];let t=0;return[e=>(e?nu(s):null)??rc+t++,e=>{aS(hS,e)&&ze(s)<1e3&&ya(s,e)}]},RS=s=>new Set(Wr(s)||bt(s)?s:[s]),yS=(s,t)=>s==null?void 0:s.add(t),ES=(s,t=[rc])=>{const e=[],o=(c,i)=>i==ze(t)?ya(e,c):t[i]===null?ru(c,u=>o(u,i+1)):Or([t[i],null],u=>o(ft(c,u),i+1));return o(s,0),e},bS=s=>{let t;const[e,o]=gS(),c=Po();return[(d,S,h,R=[],E=()=>[])=>{t??(t=s());const b=e(1);return He(c,b,[d,S,h,R,E]),yS(Gr(S,h??[rc],RS),b),b},(d,S,...h)=>Or(ES(d,S),R=>ru(R,E=>ft(c,E)[0](t,...S??[],...h))),d=>ac(ft(c,d),([,S,h])=>(Gr(S,h??[rc],void 0,R=>(au(R,d),cu(R)?1:0)),He(c,d),o(d),h)),d=>ac(ft(c,d),([S,,h=[],R,E])=>{const b=(...w)=>{var D;const N=ze(w);N==ze(h)?S(t,...w,...E(w)):bt(h[N])?Or(((D=R[N])==null?void 0:D.call(R,...w))??[],V=>b(...w,V)):b(...w,h[N])};b()})]},Uo=Po(),zo=Po(),wS=(s=1,t,e)=>s!=1&&t.isMergeable()?[1,t.getMergeableContent,()=>t.getTransactionMergeableChanges(!e),([[o],[c]])=>!po(o)||!po(c),t.setDefaultContent]:s!=2?[0,t.getContent,t.getTransactionChanges,([o,c])=>!po(o)||!po(c),t.setContent]:eu("Store type not supported by this Persister"),VS=(s,t,e,o,c,i,u,$={},L=0,d=[])=>{let S=0,h=0,R=0,E,b,w;Br(Uo,d,()=>0),Br(zo,d,()=>[]);const N=Po(),[D,V,cs,Ls,is]=wS(u,s,L),[K,j,_]=bS(()=>U),J=g=>{g!=S&&(S=g,j(N,void 0,S))},F=async()=>{if(!ft(Uo,d)){for(He(Uo,d,1);!bt(E=nu(ft(zo,d)));)try{await E()}catch{}He(Uo,d,0)}},Z=g=>{(D&&Wr(g==null?void 0:g[0])?(g==null?void 0:g[2])===1?s.applyMergeableChanges:s.setMergeableContent:(g==null?void 0:g[2])===1?s.applyChanges:s.setContent)(g)},rs=async g=>(S!=2&&(J(1),h++,await es(async()=>{try{const W=await t();Wr(W)?Z(W):g?is(g):eu(`Content is not an array: ${W}`)}catch{g&&is(g)}J(0)})),U),Ss=async g=>{m(),await rs(g);try{b=await o(async(W,Cs)=>{Cs||W?S!=2&&(J(1),h++,Z(Cs??W),J(0)):await rs()})}catch{}return U},m=()=>(b&&(c(b),b=void 0),U),I=()=>!bt(b),ts=async g=>(S!=1&&(J(2),R++,await es(async()=>{try{await e(V,g)}catch{}J(0)})),U),Ts=async()=>(us(),await ts(),w=s.addDidFinishTransactionListener(()=>{const g=cs();Ls(g)&&ts(g)}),U),us=()=>(w&&(s.delListener(w),w=void 0),U),Es=()=>!bt(w),Rs=()=>S,X=g=>K(g,N),fs=g=>(_(g),s),es=async(...g)=>(ya(ft(zo,d),...g),await F(),U),U={load:rs,startAutoLoad:Ss,stopAutoLoad:m,isAutoLoading:I,save:ts,startAutoSave:Ts,stopAutoSave:us,isAutoSaving:Es,getStatus:Rs,addStatusListener:X,delListener:fs,schedule:es,getStore:()=>s,destroy:()=>(iS(ft(zo,d)),m().stopAutoSave()),getStats:()=>({loads:h,saves:R}),...$};return fS(U)},ci="storage",iu=(s,t,e,o)=>VS(s,async()=>TS(e.getItem(t)),async L=>e.setItem(t,SS(L())),L=>{const d=S=>{if(S.storageArea===e&&S.key===t)try{L(ou(S.newValue))}catch{L()}};return ni.addEventListener(ci,d),d},L=>ni.removeEventListener(ci,L),o,3,{getStorageName:()=>t}),AT=(s,t,e)=>iu(s,t,localStorage,e),DT=(s,t,e)=>iu(s,t,sessionStorage,e),fe=s=>typeof s,de="",lu=fe(de),jS=fe(!0),uu=fe(0),xS=fe(fe),Ho="type",ve="default",AS="Listener",DS="add",me="Has",pc="Ids",qe="Table",ri=qe+"s",PS=qe+pc,ic="Row",NS=ic+"Count",vS=ic+pc,Yo="Cell",ai=Yo+pc,lc="Value",ii=lc+"s",mS=lc+pc,as=s=>de+s,_S=isFinite,FS=(s,t)=>s instanceof t,ys=s=>s==null,As=(s,t,e)=>ys(s)?e==null?void 0:e():t(s),fu=s=>s==lu||s==jS,MS=s=>fe(s)==lu,Nr=s=>fe(s)==xS,yo=s=>Array.isArray(s),li=(s,t,e)=>s.slice(t,e),xt=s=>s.length,kS=(s,t)=>s.test(t),pS=(s,t)=>s.includes(t),du=(s,t)=>s.every(t),$u=(s,t)=>xt(s)===xt(t)&&du(s,(e,o)=>t[o]===e),ui=(s,t)=>du(s,(e,o)=>o==0||t(s[o-1],e)<=0),Qr=(s,t)=>s.sort(t),re=(s,t)=>s.forEach(t),Eo=(s,t)=>s.map(t),US=s=>xt(s)==0,zS=(s,t,e)=>s.reduce(t,e),uc=(s,...t)=>s.push(...t),HS=s=>s.shift(),no=s=>{const t=fe(s);return fu(t)||t==uu&&_S(s)?t:void 0},fi=(s,t,e,o,c)=>ys(c)?s.delCell(t,e,o,!0):s.setCell(t,e,o,c),di=(s,t,e)=>ys(e)?s.delValue(t):s.setValue(t,e),Ea=s=>t=>zS(wa(t),(e,o)=>e+s(o),0),ba=s=>(s==null?void 0:s.size)??0,Uc=Ea(ba),Ke=Ea(Uc),vr=Ea(Ke),vs=(s,t)=>(s==null?void 0:s.has(t))??!1,O=s=>ys(s)||ba(s)==0,wa=s=>[...(s==null?void 0:s.values())??[]],$o=s=>s.clear(),B=(s,t)=>s==null?void 0:s.forEach(t),ae=(s,t)=>s==null?void 0:s.delete(t),ye=Object,$i=s=>ye.getPrototypeOf(s),Su=ye.entries,WS=ye.isFrozen,Tu=s=>!ys(s)&&As($i(s),t=>t==ye.prototype||ys($i(t)),()=>!0),OS=ye.keys,Cu=ye.freeze,BS=(s=[])=>ye.fromEntries(s),lo=(s,t)=>t in s,Lu=(s,t)=>(delete s[t],s),GS=(s,t)=>re(Su(s),([e,o])=>t(o,e)),QS=(s,t)=>Eo(Su(s),([e,o])=>t(o,e)),ne=(s,t)=>BS(QS(s,(e,o)=>[o,t(e,o)])),JS=s=>xt(OS(s)),Rt=s=>Tu(s)&&JS(s)==0,te=(s,t,e,o=0)=>ys(s)||!Tu(s)||!o&&Rt(s)||WS(s)?(e==null||e(),!1):(GS(s,(c,i)=>{t(c,i)||Lu(s,i)}),o?!0:!Rt(s)),M=s=>new Map(s),Me=s=>[...(s==null?void 0:s.keys())??[]],A=(s,t)=>s==null?void 0:s.get(t),Zs=(s,t)=>B(s,(e,o)=>t(o,e)),YS=(s,t)=>Eo([...(s==null?void 0:s.entries())??[]],([e,o])=>t(o,e)),H=(s,t,e)=>ys(e)?(ae(s,t),s):s==null?void 0:s.set(t,e),ps=(s,t,e,o)=>(vs(s,t)?o==null||o(A(s,t)):H(s,t,e()),A(s,t)),_e=(s,t,e,o=H)=>(ne(t,(c,i)=>e(s,i,c)),Zs(s,c=>lo(t,c)?0:o(s,c)),s),qs=(s,t,e,o)=>{const c={};return B(s,(i,u)=>{if(!(e!=null&&e(i,u))){const $=t?t(i,u):i;o!=null&&o($)||(c[u]=$)}}),c},Jr=(s,t,e)=>qs(s,o=>qs(o,t,e),O,Rt),Wo=(s,t,e)=>qs(s,o=>Jr(o,t,e),O,Rt),ce=(s,t)=>{const e=M();return B(s,(o,c)=>e.set(c,(t==null?void 0:t(o))??o)),e},Yr=s=>ce(s,ce),mr=s=>ce(s,Yr),qr=(s,t,e,o,c=0)=>As((e?ps:A)(s,t[c],c>xt(t)-2?e:M),i=>{if(c>xt(t)-2)return o!=null&&o(i)&&H(s,t[c]),i;const u=qr(i,t,e,o,c+1);return O(i)&&H(s,t[c]),u}),ot=s=>new Set(yo(s)||ys(s)?s:[s]),Is=(s,t)=>s==null?void 0:s.add(t),qS=(s,t,e,o,c)=>{const i=s.hasRow,u=M(),$=M(),L=M(),d=M(),S=M(),h=M(),R=()=>s,E=()=>Me(u),b=F=>Zs($,F),w=F=>vs($,F),N=F=>A(u,F),D=F=>A($,F),V=(F,Z)=>H($,F,Z),cs=(F,Z,...rs)=>{const Ss=ps(h,F,ot);return re(rs,m=>Is(Ss,m)&&Z&&s.callListener(m)),rs},Ls=(F,...Z)=>As(A(h,F),rs=>{re(US(Z)?wa(rs):Z,Ss=>{s.delListener(Ss),ae(rs,Ss)}),O(rs)&&H(h,F)}),is=(F,Z)=>{H(u,F,Z),vs($,F)||(H($,F,t()),H(d,F,M()),H(S,F,M()),c(L))},K=(F,Z,rs,Ss,m)=>{is(F,Z);const I=M(),ts=M(),Ts=A(d,F),us=A(S,F),Es=X=>{const fs=Ns=>s.getCell(Z,X,Ns),es=A(Ts,X),ms=i(Z,X)?e(Ss(fs,X)):void 0;if(es===ms||yo(es)&&yo(ms)&&$u(es,ms)||H(I,X,[es,ms]),!ys(m)){const Ns=A(us,X),Ws=i(Z,X)?m(fs,X):void 0;Ns!=Ws&&H(ts,X,Ws)}},Rs=X=>{rs(()=>{B(I,([,fs],es)=>H(Ts,es,fs)),B(ts,(fs,es)=>H(us,es,fs))},I,ts,Ts,us,X),$o(I),$o(ts)};Zs(Ts,Es),s.hasTable(Z)&&re(s.getRowIds(Z),X=>{vs(Ts,X)||Es(X)}),Rs(!0),Ls(F),cs(F,0,s.addRowListener(Z,null,(X,fs,es)=>Es(es)),s.addTableListener(Z,()=>Rs()))},j=F=>{H(u,F),H($,F),H(d,F),H(S,F),Ls(F),c(L)};return[R,E,b,w,N,D,V,is,K,j,F=>o(F,L),()=>Zs(h,j),cs,Ls]},Si=(s,t)=>MS(s)?e=>e(s):s??(()=>t??de),KS=(s,t)=>{const e=new WeakMap;return o=>{e.has(o)||e.set(o,s(o));const c=e.get(o);return t==null||t(c),c}},XS=/^\d+$/,hu=()=>{const s=[];let t=0;return[e=>(e?HS(s):null)??de+t++,e=>{kS(XS,e)&&xt(s)<1e3&&uc(s,e)}]},ZS=(s,t=[de])=>{const e=[],o=(c,i)=>i==xt(t)?uc(e,c):t[i]===null?B(c,u=>o(u,i+1)):re([t[i],null],u=>o(A(c,u),i+1));return o(s,0),e},gu=s=>{let t;const[e,o]=hu(),c=M();return[(d,S,h,R=[],E=()=>[])=>{t??(t=s());const b=e(1);return H(c,b,[d,S,h,R,E]),Is(qr(S,h??[de],ot),b),b},(d,S,...h)=>re(ZS(d,S),R=>B(R,E=>A(c,E)[0](t,...S??[],...h))),d=>As(A(c,d),([,S,h])=>(qr(S,h??[de],void 0,R=>(ae(R,d),O(R)?1:0)),H(c,d),o(d),h)),d=>As(A(c,d),([S,,h=[],R,E])=>{const b=(...w)=>{var D;const N=xt(w);N==xt(h)?S(t,...w,...E(w)):ys(h[N])?re(((D=R[N])==null?void 0:D.call(R,...w))??[],V=>b(...w,V)):b(...w,h[N])};b()})]},Ru=(s,t)=>(s??0)<(t??0)?-1:1,PT=KS(s=>{const t=M(),e=M(),[o,c,i]=gu(()=>Ss),[u,$,L,d,S,h,R,,E,b,w,N]=qS(s,M,m=>ys(m)?de:yo(m)?Eo(m,as):as(m),o,c),D=(m,I)=>vs(h(m),I),V=(m,I,ts,Ts,us,Es=Ru)=>{const Rs=ys(us)?void 0:([X],[fs])=>us(X,fs);return E(m,I,(X,fs,es,ms,Ns,Ws)=>{let U=0;const g=ot(),W=ot(),Cs=h(m);if(B(fs,([bs,ks],_s)=>{const z=ot(bs),Xt=ot(ks);B(z,Os=>ae(Xt,Os)?ae(z,Os):0),B(z,Os=>{Is(g,Os),As(A(Cs,Os),Qe=>{ae(Qe,_s),O(Qe)&&(H(Cs,Os),U=1)})}),B(Xt,Os=>{Is(g,Os),vs(Cs,Os)||(H(Cs,Os,ot()),U=1),Is(A(Cs,Os),_s),ys(Ts)||Is(W,Os)})}),X(),O(Ns)||(Ws?Zs(Cs,bs=>Is(W,bs)):Zs(es,bs=>As(A(ms,bs),ks=>Is(W,ks))),B(W,bs=>{const ks=(z,Xt)=>Es(A(Ns,z),A(Ns,Xt),bs),_s=[...A(Cs,bs)];ui(_s,ks)||(H(Cs,bs,ot(Qr(_s,ks))),Is(g,bs))})),(U||Ws)&&!ys(Rs)){const bs=[...Cs];ui(bs,Rs)||(R(m,M(Qr(bs,Rs))),U=1)}U&&c(t,[m]),B(g,bs=>c(e,[m,bs]))},Si(ts),As(Ts,Si)),Ss},cs=m=>L((I,ts)=>m(I,Ts=>is(I,Ts,ts))),Ls=(m,I)=>is(m,I,h(m)),is=(m,I,ts)=>{const Ts=S(m);B(ts,(us,Es)=>I(Es,Rs=>B(us,X=>Rs(X,fs=>s.forEachCell(Ts,X,fs)))))},Ss={setIndexDefinition:V,delIndexDefinition:m=>(b(m),Ss),getStore:u,getIndexIds:$,forEachIndex:cs,forEachSlice:Ls,hasIndex:d,hasSlice:D,getTableId:S,getSliceIds:m=>Me(h(m)),getSliceRowIds:(m,I)=>wa(A(h(m),I)),addIndexIdsListener:w,addSliceIdsListener:(m,I)=>o(I,t,[m]),addSliceRowIdsListener:(m,I,ts)=>o(ts,e,[m,I]),delListener:m=>(i(m),Ss),destroy:N,getListenerStats:()=>({sliceIds:Uc(t),sliceRowIds:Ke(e)})};return Cu(Ss)}),IS=JSON.stringify,_r=JSON.parse,Je=s=>IS(s,(t,e)=>FS(e,Map)?ye.fromEntries([...e]):e),Oo=s=>[s,s],js=(s,t=Uc)=>t(s[0])+t(s[1]),xs=()=>[M(),M()],Ti=s=>[...s],Bo=([s,t])=>s===t,oo=(s,t,e)=>H(s,t,A(s,t)==-e?void 0:e),sT=()=>{let s,t,e=!1,o=!1,c=0,i=[];const u=M(),$=M(),L=M(),d=M(),S=M(),h=M(),R=M(),E=M(),b=M(),w=M(),N=M(),D=M(),V=M(),cs=M(),Ls=ot(),is=M(),K=M(),j=M(),_=M(),J=xs(),F=xs(),Z=xs(),rs=xs(),Ss=xs(),m=xs(),I=xs(),ts=xs(),Ts=xs(),us=xs(),Es=xs(),Rs=xs(),X=xs(),fs=xs(),es=xs(),ms=xs(),Ns=xs(),Ws=xs(),U=xs(),g=xs(),W=xs(),Cs=xs(),bs=M(),ks=xs(),[_s,z,Xt,Os]=gu(()=>ns),Qe=n=>te(n,r=>te(r,un)),Hc=n=>te(n,un),un=n=>{if(!te(n,(a,l)=>pS([Ho,ve],l)))return!1;const r=n[Ho];return!fu(r)&&r!=uu?!1:(no(n[ve])!=r&&Lu(n,ve),!0)},Wc=yo,Oc=n=>te(n,fn,zs),fn=(n,r)=>(!s||vs(N,r)||zs(r))&&te(n,(a,l)=>Nt(r,l,a),()=>zs(r)),Nt=(n,r,a,l)=>te(l?a:Tn(a,n,r),(f,T)=>As(dn(n,r,T,f),y=>(a[T]=y,!0),()=>!1),()=>zs(n,r)),dn=(n,r,a,l)=>s?As(A(A(N,n),a),f=>no(l)!=f[Ho]?zs(n,r,a,l,f[ve]):l,()=>zs(n,r,a,l)):ys(no(l))?zs(n,r,a,l):l,$n=(n,r)=>te(r?n:Bc(n),(a,l)=>As(Sn(l,a),f=>(n[l]=f,!0),()=>!1),()=>it()),Sn=(n,r)=>t?As(A(V,n),a=>no(r)!=a[Ho]?it(n,r,a[ve]):r,()=>it(n,r)):ys(no(r))?it(n,r):r,Tn=(n,r,a)=>(As(A(D,r),([l,f])=>{B(l,(T,y)=>{lo(n,y)||(n[y]=T)}),B(f,T=>{lo(n,T)||zs(r,a,T)})}),n),Bc=n=>(t&&(B(cs,(r,a)=>{lo(n,a)||(n[a]=r)}),B(Ls,r=>{lo(n,r)||it(r)})),n),Cn=n=>_e(N,n,(r,a,l)=>{const f=M(),T=ot();_e(ps(N,a,M),l,(y,x,P)=>{H(y,x,P),As(P[ve],ds=>H(f,x,ds),()=>Is(T,x))}),H(D,a,[f,T])},(r,a)=>{H(N,a),H(D,a)}),Ln=n=>_e(V,n,(r,a,l)=>{H(V,a,l),As(l[ve],f=>H(cs,a,f),()=>Is(Ls,a))},(r,a)=>{H(V,a),H(cs,a),ae(Ls,a)}),hn=n=>Rt(n)?Wt():zt(n),Gc=([n,r])=>{(Rt(n)?Wt:zt)(n),(Rt(r)?Ot:Ht)(r)},gn=n=>_e(j,n,(r,a,l)=>vt(a,l),(r,a)=>bn(a)),vt=(n,r)=>_e(ps(j,n,()=>(xn(n,1),H(is,n,hu()),H(K,n,M()),M())),r,(a,l,f)=>at(n,a,l,f),(a,l)=>wn(n,a,l)),at=(n,r,a,l,f)=>_e(ps(r,a,()=>(An(n,a,1),M())),l,(T,y,x)=>Ee(n,a,T,y,x),(T,y)=>Vn(n,r,a,T,y,f)),Ee=(n,r,a,l,f)=>{vs(a,l)||Dn(n,r,l,1);const T=A(a,l);f!==T&&(Pn(n,r,l,T,f),H(a,l,f))},Rn=(n,r,a,l,f)=>As(A(r,a),T=>Ee(n,a,T,l,f),()=>at(n,r,a,Tn({[l]:f},n,a))),yn=n=>Rt(n)?Ot():Ht(n),En=n=>_e(_,n,(r,a,l)=>mt(a,l),(r,a)=>jn(a)),mt=(n,r)=>{vs(_,n)||Nn(n,1);const a=A(_,n);r!==a&&(vn(n,a,r),H(_,n,r))},Qc=(n,r)=>{const[a]=A(is,n);let l;do l=a(r);while(vs(A(j,n),l));return l},_t=n=>A(j,n)??vt(n,{}),bn=n=>vt(n,{}),wn=(n,r,a)=>{const[,l]=A(is,n);l(a),at(n,r,a,{},!0)},Vn=(n,r,a,l,f,T)=>{var P;const y=A((P=A(D,n))==null?void 0:P[0],f);if(!ys(y)&&!T)return Ee(n,a,l,f,y);const x=ds=>{Pn(n,a,ds,A(l,ds)),Dn(n,a,ds,-1),H(l,ds)};ys(y)?x(f):Zs(l,x),O(l)&&(An(n,a,-1),O(H(r,a))&&(xn(n,-1),H(j,n),H(is,n),H(K,n)))},jn=n=>{const r=A(cs,n);if(!ys(r))return mt(n,r);vn(n,A(_,n)),Nn(n,-1),H(_,n)},xn=(n,r)=>oo(u,n,r),An=(n,r,a)=>oo(ps(d,n,M),r,a)&&H(L,n,ps(L,n,()=>0)+a),Dn=(n,r,a,l)=>{const f=A(K,n),T=A(f,a)??0;(T==0&&l==1||T==1&&l==-1)&&oo(ps($,n,M),a,l),H(f,a,T!=-l?T+l:null),oo(ps(ps(S,n,M),r,M),a,l)},Pn=(n,r,a,l,f)=>{var T;ps(ps(ps(h,n,M),r,M),a,()=>[l,0])[1]=f,(T=i[3])==null||T.call(i,n,r,a,f)},Nn=(n,r)=>oo(R,n,r),vn=(n,r,a)=>{var l;ps(E,n,()=>[r,0])[1]=a,(l=i[4])==null||l.call(i,n,a)},zs=(n,r,a,l,f)=>(uc(ps(ps(ps(b,n,M),r,M),a,()=>[]),l),f),it=(n,r,a)=>(uc(ps(w,n,()=>[]),r),a),Ft=(n,r,a)=>As(A(A(A(h,n),r),a),([l,f])=>[!0,l,f],()=>[!1,...Oo(Mt(n,r,a))]),mn=n=>As(A(E,n),([r,a])=>[!0,r,a],()=>[!1,...Oo(kt(n))]),_n=n=>!O(b)&&!O(ms[n])?B(n?mr(b):b,(r,a)=>B(r,(l,f)=>B(l,(T,y)=>z(ms[n],[a,f,y],T)))):0,Fn=n=>!O(w)&&!O(Ns[n])?B(n?ce(w):w,(r,a)=>z(Ns[n],[a],r)):0,lt=(n,r,a,l)=>{if(!O(n))return z(r,l,()=>qs(n)),Zs(n,(f,T)=>z(a,[...l??[],f],T==1)),1},Mn=n=>{const r=pt();r!=e&&z(J[n],void 0,r);const a=O(us[n]),l=O(X[n])&&O(fs[n])&&O(Ts[n])&&O(Es[n])&&O(m[n])&&O(I[n])&&O(ts[n])&&a&&O(Z[n])&&O(rs[n]),f=O(es[n])&&O(Rs[n])&&O(Ss[n])&&O(F[n]);if(!l||!f){const T=n?[ce(u),Yr($),ce(L),Yr(d),mr(S),mr(h)]:[u,$,L,d,S,h];if(!l){lt(T[0],Z[n],rs[n]),B(T[1],(x,P)=>lt(x,m[n],I[n],[P])),B(T[2],(x,P)=>{x!=0&&z(ts[n],[P],Un(P))});const y=ot();B(T[3],(x,P)=>{lt(x,Ts[n],Es[n],[P])&&!a&&(z(us[n],[P,null]),Is(y,P))}),a||B(T[5],(x,P)=>{if(!vs(y,P)){const ds=ot();B(x,Hs=>B(Hs,([Bt,Gt],ut)=>Gt!==Bt?Is(ds,ut):ae(Hs,ut))),B(ds,Hs=>z(us[n],[P,Hs]))}}),B(T[4],(x,P)=>B(x,(ds,Hs)=>lt(ds,X[n],fs[n],[P,Hs])))}if(!f){let y;B(T[5],(x,P)=>{let ds;B(x,(Hs,Bt)=>{let Gt;B(Hs,([ut,In],gr)=>{In!==ut&&(z(es[n],[P,Bt,gr],In,ut,Ft),y=ds=Gt=1)}),Gt&&z(Rs[n],[P,Bt],Ft)}),ds&&z(Ss[n],[P],Ft)}),y&&z(F[n],void 0,Ft)}}},kn=n=>{const r=Ut();r!=o&&z(Ws[n],void 0,r);const a=O(g[n])&&O(W[n]),l=O(Cs[n])&&O(U[n]);if(!a||!l){const f=n?[ce(R),ce(E)]:[R,E];if(a||lt(f[0],g[n],W[n]),!l){let T;B(f[1],([y,x],P)=>{x!==y&&(z(Cs[n],[P],x,y,mn),T=1)}),T&&z(U[n],void 0,mn)}}},k=(n,...r)=>(De(()=>n(...Eo(r,as))),ns),Jc=()=>[be(),je()],be=()=>Wo(j),hs=()=>Me(j),Yc=n=>Jr(A(j,as(n))),pn=n=>Me(A(K,as(n))),Un=n=>ba(A(j,as(n))),Xs=n=>Me(A(j,as(n))),we=(n,r,a,l=0,f)=>Eo(li(Qr(YS(A(j,as(n)),(T,y)=>[ys(r)?y:A(T,as(r)),y]),([T],[y])=>Ru(T,y)*(a?-1:1)),l,ys(f)?f:l+f),([,T])=>T),qc=(n,r)=>qs(A(A(j,as(n)),as(r))),Ve=(n,r)=>Me(A(A(j,as(n)),as(r))),Mt=(n,r,a)=>A(A(A(j,as(n)),as(r)),as(a)),je=()=>qs(_),xe=()=>Me(_),kt=n=>A(_,as(n)),pt=()=>!O(j),zn=n=>vs(j,as(n)),Hn=(n,r)=>vs(A(K,as(n)),as(r)),Wn=(n,r)=>vs(A(j,as(n)),as(r)),On=(n,r,a)=>vs(A(A(j,as(n)),as(r)),as(a)),Ut=()=>!O(_),Bn=n=>vs(_,as(n)),Kc=()=>Je(j),Xc=()=>Je(_),Zc=()=>Je([j,_]),Ic=()=>Je(N),sr=()=>Je(V),tr=()=>Je([N,V]),er=n=>k(()=>{const r=Nr(n)?n():n;Wc(r)&&Gc(r)}),zt=n=>k(()=>Oc(n)?gn(n):0),nr=(n,r)=>k(a=>fn(r,a)?vt(a,r):0,n),or=(n,r,a)=>k((l,f)=>Nt(l,f,a)?at(l,_t(l),f,a):0,n,r),cr=(n,r,a=!0)=>De(()=>{let l;return Nt(n,l,r)&&(n=as(n),at(n,_t(n),l=Qc(n,a?1:0),r)),l}),rr=(n,r,a)=>k((l,f)=>{if(Nt(l,f,a,1)){const T=_t(l);ne(a,(y,x)=>Rn(l,T,f,x,y))}},n,r),ar=(n,r,a,l)=>k((f,T,y)=>As(dn(f,T,y,Nr(l)?l(Mt(f,T,y)):l),x=>Rn(f,_t(f),T,y,x)),n,r,a),Ht=n=>k(()=>$n(n)?En(n):0),ir=n=>k(()=>$n(n,1)?ne(n,(r,a)=>mt(a,r)):0),lr=(n,r)=>k(a=>As(Sn(a,Nr(r)?r(kt(a)):r),l=>mt(a,l)),n),ur=n=>k(()=>{ne(n[0],(r,a)=>ys(r)?Yn(a):ne(r,(l,f)=>ys(l)?qn(a,f):ne(l,(T,y)=>fi(ns,a,f,y,T)))),ne(n[1],(r,a)=>di(ns,a,r))}),Gn=n=>{try{hn(_r(n))}catch{}return ns},fr=n=>{try{yn(_r(n))}catch{}return ns},dr=n=>k(()=>{try{const[r,a]=_r(n);hn(r),yn(a)}catch{Gn(n)}}),Qn=n=>k(()=>{if((s=Qe(n))&&(Cn(n),!O(j))){const r=be();Wt(),zt(r)}}),Jn=n=>k(()=>{if(t=Hc(n)){const r=je();Ae(),Ot(),t=!0,Ln(n),Ht(r)}}),$r=(n,r)=>k(()=>{Qn(n),Jn(r)}),Wt=()=>k(()=>gn({})),Yn=n=>k(r=>vs(j,r)?bn(r):0,n),qn=(n,r)=>k((a,l)=>As(A(j,a),f=>vs(f,l)?wn(a,f,l):0),n,r),Sr=(n,r,a,l)=>k((f,T,y)=>As(A(j,f),x=>As(A(x,T),P=>vs(P,y)?Vn(f,x,T,P,y,l):0)),n,r,a),Ot=()=>k(()=>En({})),Tr=n=>k(r=>vs(_,r)?jn(r):0,n),Kn=()=>k(()=>{Cn({}),s=!1}),Ae=()=>k(()=>{Ln({}),t=!1}),Cr=()=>k(()=>{Kn(),Ae()}),De=(n,r)=>{if(c!=-1){Xn();const a=n();return Zn(r),a}},Xn=()=>{var n;return c!=-1&&c++,c==1&&((n=i[0])==null||n.call(i),z(bs)),ns},Lr=()=>[qs(h,(n,r)=>A(u,r)===-1?void 0:qs(n,(a,l)=>A(A(d,r),l)===-1?void 0:qs(a,([,f])=>f,f=>Bo(f)),O,Rt),O,Rt),qs(E,([,n])=>n,n=>Bo(n)),1],hr=()=>[!O(h),!O(E),Wo(h,Ti,Bo),Wo(b),qs(E,Ti,Bo),qs(w),qs(u),Jr(d),Wo(S),qs(R)],Zn=n=>{var r,a;return c>0&&(c--,c==0&&(c=1,_n(1),O(h)||Mn(1),Fn(1),O(E)||kn(1),n!=null&&n(ns)&&(B(h,(l,f)=>B(l,(T,y)=>B(T,([x],P)=>fi(ns,f,y,P,x)))),$o(h),B(E,([l],f)=>di(ns,f,l)),$o(E)),z(ks[0],void 0),c=-1,_n(0),O(h)||Mn(0),Fn(0),O(E)||kn(0),(r=i[1])==null||r.call(i),z(ks[1],void 0),(a=i[2])==null||a.call(i),c=0,e=pt(),o=Ut(),re([u,$,L,d,S,h,b,R,E,w],$o))),ns},ns={getContent:Jc,getTables:be,getTableIds:hs,getTable:Yc,getTableCellIds:pn,getRowCount:Un,getRowIds:Xs,getSortedRowIds:we,getRow:qc,getCellIds:Ve,getCell:Mt,getValues:je,getValueIds:xe,getValue:kt,hasTables:pt,hasTable:zn,hasTableCell:Hn,hasRow:Wn,hasCell:On,hasValues:Ut,hasValue:Bn,getTablesJson:Kc,getValuesJson:Xc,getJson:Zc,getTablesSchemaJson:Ic,getValuesSchemaJson:sr,getSchemaJson:tr,hasTablesSchema:()=>s,hasValuesSchema:()=>t,setContent:er,setTables:zt,setTable:nr,setRow:or,addRow:cr,setPartialRow:rr,setCell:ar,setValues:Ht,setPartialValues:ir,setValue:lr,applyChanges:ur,setTablesJson:Gn,setValuesJson:fr,setJson:dr,setTablesSchema:Qn,setValuesSchema:Jn,setSchema:$r,delTables:Wt,delTable:Yn,delRow:qn,delCell:Sr,delValues:Ot,delValue:Tr,delTablesSchema:Kn,delValuesSchema:Ae,delSchema:Cr,transaction:De,startTransaction:Xn,getTransactionChanges:Lr,getTransactionLog:hr,finishTransaction:Zn,forEachTable:n=>B(j,(r,a)=>n(a,l=>B(r,(f,T)=>l(T,y=>Zs(f,y))))),forEachTableCell:(n,r)=>Zs(A(K,as(n)),r),forEachRow:(n,r)=>B(A(j,as(n)),(a,l)=>r(l,f=>Zs(a,f))),forEachCell:(n,r,a)=>Zs(A(A(j,as(n)),as(r)),a),forEachValue:n=>Zs(_,n),addSortedRowIdsListener:(n,r,a,l,f,T,y)=>{let x=we(n,r,a,l,f);return _s(()=>{const P=we(n,r,a,l,f);$u(P,x)||(x=P,T(ns,n,r,a,l,f,x))},us[y?1:0],[n,r],[hs])},addStartTransactionListener:n=>_s(n,bs),addWillFinishTransactionListener:n=>_s(n,ks[0]),addDidFinishTransactionListener:n=>_s(n,ks[1]),callListener:n=>(Os(n),ns),delListener:n=>(Xt(n),ns),getListenerStats:()=>({hasTables:js(J),tables:js(F),tableIds:js(Z),hasTable:js(rs),table:js(Ss),tableCellIds:js(m),hasTableCell:js(I,Ke),rowCount:js(ts),rowIds:js(Ts),sortedRowIds:js(us),hasRow:js(Es,Ke),row:js(Rs,Ke),cellIds:js(X,Ke),hasCell:js(fs,vr),cell:js(es,vr),invalidCell:js(ms,vr),hasValues:js(Ws),values:js(U),valueIds:js(g),hasValue:js(W),value:js(Cs),invalidValue:js(Ns),transaction:Uc(bs)+js(ks)}),isMergeable:()=>!1,createStore:sT,addListener:_s,callListeners:z,setInternalListeners:(n,r,a,l,f)=>i=[n,r,a,l,f]};return ne({[me+ri]:[0,J,[],()=>[pt()]],[ri]:[0,F],[PS]:[0,Z],[me+qe]:[1,rs,[hs],n=>[zn(...n)]],[qe]:[1,Ss,[hs]],[qe+ai]:[1,m,[hs]],[me+qe+Yo]:[2,I,[hs,pn],n=>[Hn(...n)]],[NS]:[1,ts,[hs]],[vS]:[1,Ts,[hs]],[me+ic]:[2,Es,[hs,Xs],n=>[Wn(...n)]],[ic]:[2,Rs,[hs,Xs]],[ai]:[2,X,[hs,Xs]],[me+Yo]:[3,fs,[hs,Xs,Ve],n=>[On(...n)]],[Yo]:[3,es,[hs,Xs,Ve],n=>Oo(Mt(...n))],InvalidCell:[3,ms],[me+ii]:[0,Ws,[],()=>[Ut()]],[ii]:[0,U],[mS]:[0,g],[me+lc]:[1,W,[xe],n=>[Bn(...n)]],[lc]:[1,Cs,[xe],n=>Oo(kt(n[0]))],InvalidValue:[1,Ns]},([n,r,a,l],f)=>{ns[DS+f+AS]=(...T)=>_s(T[n],r[T[n+1]?1:0],n>0?li(T,0,n):void 0,a,l)}),Cu(ns)},fc="",wt=s=>s==null,dc=(s,t,e)=>wt(s)?e==null?void 0:e():t(s),Kr=s=>Array.isArray(s),We=s=>s.length,tT=(s,t)=>s.test(t),yu=s=>{throw new Error(s)},Xr=(s,t)=>s.forEach(t),eT=(s,t)=>s.splice(0,t),Va=(s,...t)=>s.push(...t),Eu=s=>s.shift(),nT=s=>(s==null?void 0:s.size)??0,oT=(s,t)=>(s==null?void 0:s.has(t))??!1,bu=s=>wt(s)||nT(s)==0,wu=(s,t)=>s==null?void 0:s.forEach(t),Vu=(s,t)=>s==null?void 0:s.delete(t),zc=Object,Ci=s=>zc.getPrototypeOf(s),cT=s=>!wt(s)&&dc(Ci(s),t=>t==zc.prototype||wt(Ci(t)),()=>!0),rT=zc.keys,aT=zc.freeze,iT=s=>We(rT(s)),Go=s=>cT(s)&&iT(s)==0,No=s=>new Map(s),dt=(s,t)=>s==null?void 0:s.get(t),Oe=(s,t,e)=>wt(e)?(Vu(s,t),s):s==null?void 0:s.set(t,e),Zr=(s,t,e,o)=>(oT(s,t)?o==null||o(dt(s,t)):Oe(s,t,e()),dt(s,t)),Ir=(s,t,e,o,c=0)=>dc((e?Zr:dt)(s,t[c],c>We(t)-2?e:No),i=>{if(c>We(t)-2)return o!=null&&o(i)&&Oe(s,t[c]),i;const u=Ir(i,t,e,o,c+1);return bu(i)&&Oe(s,t[c]),u}),lT=/^\d+$/,uT=()=>{const s=[];let t=0;return[e=>(e?Eu(s):null)??fc+t++,e=>{tT(lT,e)&&We(s)<1e3&&Va(s,e)}]},fT=s=>new Set(Kr(s)||wt(s)?s:[s]),dT=(s,t)=>s==null?void 0:s.add(t),$T=(s,t=[fc])=>{const e=[],o=(c,i)=>i==We(t)?Va(e,c):t[i]===null?wu(c,u=>o(u,i+1)):Xr([t[i],null],u=>o(dt(c,u),i+1));return o(s,0),e},ST=s=>{let t;const[e,o]=uT(),c=No();return[(d,S,h,R=[],E=()=>[])=>{t??(t=s());const b=e(1);return Oe(c,b,[d,S,h,R,E]),dT(Ir(S,h??[fc],fT),b),b},(d,S,...h)=>Xr($T(d,S),R=>wu(R,E=>dt(c,E)[0](t,...S??[],...h))),d=>dc(dt(c,d),([,S,h])=>(Ir(S,h??[fc],void 0,R=>(Vu(R,d),bu(R)?1:0)),Oe(c,d),o(d),h)),d=>dc(dt(c,d),([S,,h=[],R,E])=>{const b=(...w)=>{var D;const N=We(w);N==We(h)?S(t,...w,...E(w)):wt(h[N])?Xr(((D=R[N])==null?void 0:D.call(R,...w))??[],V=>b(...w,V)):b(...w,h[N])};b()})]},Qo=No(),Jo=No(),TT=(s=1,t,e)=>s!=1&&t.isMergeable()?[1,t.getMergeableContent,()=>t.getTransactionMergeableChanges(!e),([[o],[c]])=>!Go(o)||!Go(c),t.setDefaultContent]:s!=2?[0,t.getContent,t.getTransactionChanges,([o,c])=>!Go(o)||!Go(c),t.setContent]:yu("Store type not supported by this Persister"),NT=(s,t,e,o,c,i,u,$={},L=0,d=[])=>{let S=0,h=0,R=0,E,b,w;Zr(Qo,d,()=>0),Zr(Jo,d,()=>[]);const N=No(),[D,V,cs,Ls,is]=TT(u,s,L),[K,j,_]=ST(()=>U),J=g=>{g!=S&&(S=g,j(N,void 0,S))},F=async()=>{if(!dt(Qo,d)){for(Oe(Qo,d,1);!wt(E=Eu(dt(Jo,d)));)try{await E()}catch{}Oe(Qo,d,0)}},Z=g=>{(D&&Kr(g==null?void 0:g[0])?(g==null?void 0:g[2])===1?s.applyMergeableChanges:s.setMergeableContent:(g==null?void 0:g[2])===1?s.applyChanges:s.setContent)(g)},rs=async g=>(S!=2&&(J(1),h++,await es(async()=>{try{const W=await t();Kr(W)?Z(W):g?is(g):yu(`Content is not an array: ${W}`)}catch{g&&is(g)}J(0)})),U),Ss=async g=>{m(),await rs(g);try{b=await o(async(W,Cs)=>{Cs||W?S!=2&&(J(1),h++,Z(Cs??W),J(0)):await rs()})}catch{}return U},m=()=>(b&&(c(b),b=void 0),U),I=()=>!wt(b),ts=async g=>(S!=1&&(J(2),R++,await es(async()=>{try{await e(V,g)}catch{}J(0)})),U),Ts=async()=>(us(),await ts(),w=s.addDidFinishTransactionListener(()=>{const g=cs();Ls(g)&&ts(g)}),U),us=()=>(w&&(s.delListener(w),w=void 0),U),Es=()=>!wt(w),Rs=()=>S,X=g=>K(g,N),fs=g=>(_(g),s),es=async(...g)=>(Va(dt(Jo,d),...g),await F(),U),U={load:rs,startAutoLoad:Ss,stopAutoLoad:m,isAutoLoading:I,save:ts,startAutoSave:Ts,stopAutoSave:us,isAutoSaving:Es,getStatus:Rs,addStatusListener:X,delListener:fs,schedule:es,getStore:()=>s,destroy:()=>(eT(dt(Jo,d)),m().stopAutoSave()),getStats:()=>({loads:h,saves:R}),...$};return aT(U)};export{VT as I,RT as P,xT as U,AT as a,NT as b,sT as c,DT as d,PT as e};
